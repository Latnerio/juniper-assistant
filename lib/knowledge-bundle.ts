// Auto-generated by scripts/bundle-knowledge.ts — do not edit
// 2026-02-27T07:10:08.093Z — 18 files, ~38664 tokens
export const KNOWLEDGE_BUNDLE = "--- SOURCE: elearning/JUNIPER_ELEARNING_KNOWLEDGE.md ---\n# Juniper eLearning Knowledge — Implementation Reference\n\n**Source:** Juniper eLearning Course JBE-C-PER-Imperatore Travel World (ID: 634)\n**Created:** 2026-02-24\n**Purpose:** Actionable technical/business knowledge extracted from eLearning, stripped of training fluff.\n\n---\n\n## 1. Module Architecture\n\n| Module | Purpose | Key Functions |\n|--------|---------|---------------|\n| **Accommodation** | Hotel/property product management | Rates, allotment, contracts, room types, stop sales, release days |\n| **Destination Services** | Excursions, tickets, transfers, car rental, insurance | Service config, rates, availability, supplier assignment |\n| **Packages (Predefined)** | Fixed tour packages (hotel+flight+services) | Departure dates, room combos, per-person pricing, supplements |\n| **Packages (Dynamic)** | Flexible multi-product bundles | Config per day/destination, mandatory/optional products, simulator |\n| **Flights** | Charter + GDS (Amadeus) flights | Routes, schedules, seat inventory, fare classes, PNR sync |\n| **Customers** | B2B agencies + B2C final customers | Commercial conditions, credit limits, payment terms, commissions |\n| **Bookings** | Booking lifecycle management | Status tracking, modifications, cancellations, communications |\n| **Call Center** | Help desk booking creation/management | Search → select → guest details → confirm → pay → voucher |\n| **Ground Handling** | Daily operations for transfers/excursions | Driver/guide assignment, vehicle management, route optimization |\n| **Accounting** | Invoicing and financial management | Invoice generation, fiscal years, tax management, VCC, POS |\n| **Reports** | Sales/cost/profit analytics | Standard reports, Excel export, scheduled reports, custom queries |\n| **Master Tables** | System configuration | Destinations, currencies, suppliers, languages, users, website config |\n| **Tools** | Marketing and analytics | Email campaigns, website statistics |\n| **Business Intelligence** | Advanced analytics | Dashboards, revenue analytics, hotel blocking on price changes |\n| **Web** | Public booking website management | Design, content, SEO, payment gateway, multi-language |\n\n---\n\n## 2. Configuration Prerequisites (Before Bookings Work)\n\n### Mandatory Setup Order\n1. **Master Tables → Destinations**: Create Zone → Country → Area hierarchy\n2. **Master Tables → Currencies**: Configure currencies + exchange rates\n3. **Master Tables → Suppliers**: Create supplier records with payment conditions\n4. **Master Tables → Users**: Create intranet users with permissions\n5. **Customers**: Create agency records (B2B) or customer records (B2C)\n6. **Products**: Configure at least one product type (accommodation/service/etc.)\n7. **Rates & Allotment**: Set pricing and availability for products\n8. **Website Configuration**: Set sales channels, payment methods, booking expiry rules\n9. **Accounting → Fiscal Year**: Open fiscal year before invoicing\n\n### Per-Product Configuration Checklist\n- **Hotels**: General data → Room types → Contracts → Rates (cost + sales) → Seasons → Allotment → Cancellation policy\n- **Services**: General data → Destination/area → Supplier → Rate structure → Availability → Booking conditions\n- **Transfers**: Origin/destination points → Vehicle types → Routes → Meeting points → Rates\n- **Packages**: General tab → Departure dates → Hotels → Rooms → Rates → Flights → Services → Supplements → Cancellation policy\n\n### Agency Commercial Configuration\n- Payment type: prepayment / credit / mixed\n- Markup/commission: percentage or fixed\n- Credit limit: max outstanding balance\n- Booking deadline: hours before expiry for prepayment agencies\n- Channel access: web / call center / XML\n\n---\n\n## 3. Booking Workflow\n\n### Search → PreBook → Book → Manage\n\n```\nSEARCH\n├── Select product type, dates, destination, occupancy\n├── View available options with prices\n└── Returns: available products with rates\n\nPREBOOK (Call Center / Web)\n├── Select specific product/room/service\n├── Enter guest/traveler details\n├── System checks: allotment, rates, cancellation policies\n└── Returns: confirmed price, cancellation terms\n\nBOOK (Confirmation)\n├── Review booking summary\n├── Process payment (if required by agency type)\n├── Generate voucher/confirmation\n├── Send confirmation email + pro-forma invoice (B2B)\n└── Booking enters status: CON (confirmed) or PRE (on request)\n\nMANAGE (Post-Booking)\n├── View in Bookings list with filters\n├── Modify: dates, occupancy, room upgrades, name changes, cost/price adjustments\n├── Cancel: apply cancellation policy, calculate charges, process refunds\n├── Change agency assignment\n└── Track: communications log, observations, payment status\n```\n\n### Booking Statuses\n| Code | Status | Meaning |\n|------|--------|---------|\n| INI | Initial | Draft/incomplete |\n| QUO | Quote | Price quoted, not committed |\n| PRE | Pre-booking | On request, awaiting supplier confirmation |\n| CON | Confirmed | Live confirmed booking |\n| CAN | Cancelled | Cancelled |\n| OK | Verified | Completed/verified |\n\n### Automatic Processes Affecting Bookings\n- **Booking expiry checking**: Reminder timing → auto-cancellation rules\n- **Pre/post stay emails**: Automated guest communication\n- **Supplier notification**: On booking adjustments\n- **Allotment threshold notifications**: When availability drops below minimum\n\n---\n\n## 4. Accounting / Invoicing Workflow\n\n### Invoice Flow\n```\nBooking reaches OK status (or 100% payment)\n  ↓\nAutomated or manual invoice generation\n  ↓\nInvoice assigned to series within fiscal year\n  ↓\nTax calculation (general tax, special tax)\n  ↓\nInvoice issued in agency's billing currency\n```\n\n### Configuration Requirements\n- **Fiscal Year**: Must be open before creating invoices. Only one open at a time.\n- **Invoice Series**: Each invoicing company has own series (Holding module)\n- **Invoice Rules**:\n  - Auto-invoice on OK status (optional)\n  - Auto-invoice on 100% payment (optional)\n  - Future date invoice restriction (optional)\n  - Negative profit rules per product type\n\n### Payment Methods\n| Method | Description |\n|--------|-------------|\n| Prepayment | Agency pays before travel |\n| Credit | Agency pays on terms (credit limit enforced) |\n| VCC | Virtual Credit Cards for supplier payments |\n| POS (Gateway JP) | Point-of-sale card processing |\n| Payment Gateway | Online payments with anti-fraud module |\n\n### Supplier Cost Management\n- Cost verification against supplier invoices\n- Payment tracking per supplier\n- Adjustment management for discrepancies\n\n---\n\n## 5. Reporting Capabilities\n\n| Report Type | Coverage |\n|-------------|----------|\n| Sales reports | Revenue by product/agency/date/destination |\n| Cost reports | Supplier costs, margin analysis |\n| Profit reports | Net profit by product/booking/agency |\n| Rate reports | Personalized rate views with print headers |\n| Availability reports | Allotment status and trends |\n| Booking statistics | Volume, status breakdown, channel analysis |\n| Customer analytics | Agency performance, booking patterns |\n| Supplier performance | Delivery metrics, cost trends |\n\n### Report Features\n- Filterable by date range, product type, agency, destination\n- Exportable to Excel\n- Schedulable for automated delivery\n- Custom query capability for ad-hoc analysis\n- BI module for advanced dashboards and hotel blocking based on detected changes\n\n---\n\n## 6. Key Terminology Mapping\n\n| Juniper Term | Industry Equivalent | Notes |\n|--------------|-------------------|-------|\n| Zone | Region/Continent | Top-level geography (e.g., Europe) |\n| Area | Destination/Resort | Specific locality within a country |\n| Destination Services | Activities/Excursions/Ancillaries | Umbrella for non-accommodation products |\n| Board type | Meal plan | RO, BB, HB, FB, AI |\n| Allotment | Inventory/Availability | Available units per date |\n| Stop sale | Close-out | Block availability for dates |\n| Release days | Cut-off period | Minimum advance booking requirement |\n| Intranet | Back-office/Admin portal | Juniper's admin interface |\n| Extranet | Supplier portal | External supplier self-service |\n| Call Center | Help desk / Reservation center | Manual booking module |\n| Ground Handling | Operations / Dispatch | Day-of service management |\n| Product Group | Rate category | For differentiated pricing/commissions |\n| Agency Category | Trade tier | For tiered access/pricing |\n| Unique Hotel | Deduplicated property | Single JP code across suppliers |\n| CON/OK/PRE/QUO/CAN | Confirmed/Verified/On-Request/Quote/Cancelled | Booking statuses |\n| Fiscal Year | Accounting period | Must be opened for invoicing |\n| Invoice Series | Invoice number sequence | Per invoicing company |\n| VCC | Virtual Credit Card | For supplier payments |\n| Gateway JP | POS terminal | Card payment processing |\n| Holding module | Multi-company structure | Multiple invoicing entities |\n| WSPush | Channel push | OTA/JP file generation notifications |\n| NRF | Non-refundable rate | Cannot be cancelled without full charge |\n\n---\n\n## 7. Dynamic vs Predefined Packages\n\n| Aspect | Predefined | Dynamic |\n|--------|-----------|---------|\n| Flexibility | Fixed combinations | Mix-and-match products |\n| Pricing | Per-person per room combo per departure | Calculated from component prices |\n| Departure dates | Pre-configured frequencies | Configurable daily/weekly/random |\n| Products available | Hotel, flight, services, transfers | All types incl. nested packages (excl. cruises) |\n| Supplier mix | Own products typically | Own + external suppliers |\n| Configuration complexity | Moderate (10 tabs) | High (13 tabs + simulator) |\n| Extranet support | Yes (supplier upload) | No extranet upload |\n\n---\n\n## 8. Unique Hotel System\n- Maps same physical property from multiple suppliers to single JP code\n- Juniper handles identification and maintenance\n- Priority order configurable per supplier per hotel\n- Can be configured per channel and client\n- Hotels/suppliers can be blocked/unblocked\n- Accommodation type classification available (Apartment, Beach, Luxury, etc.)\n\n---\n\n## 9. Security Features\n- Password strengthening for intranet/agency/agent\n- Double Authentication Factor (requires SSL)\n- Access warnings for suspected fraudulent login\n- Activity registry (user access log)\n- CDN configuration\n- Anti-fraud module on payment gateway\n\n---\n\n## 10. Channel Architecture\n| Channel | Type | Description |\n|---------|------|-------------|\n| B2B Web | Agency portal | Trade users with commercial conditions |\n| B2C Web | Consumer website | Direct customer bookings |\n| Call Center | Internal | Operator-assisted bookings |\n| XML/WebService | API | External system integration |\n| Extranet | Supplier | Product upload and management |\n\nEach channel can have independent:\n- Payment method configuration\n- Booking rules and expiry\n- Product group access\n- Currency settings\n- Display/search parameters\n\n---\n\n## 11. External Hotel Suppliers (Hotel Beds, Expedia, etc.)\n\n### Initial Setup Flow\n1. **Master Tables → Supply Access Rules**: First place to check. Select product type (hotel), then see which integrations are implemented (e.g., Expedia, Hotel Beds, Gecko, etc.)\n2. **Access Control**: For each integration, control which agencies can access which supplier via allow/deny rules. Use \"All Deny\" to block everything, then selectively allow test agencies.\n3. **Credential Configuration**: Each external connector has its own credentials section. Within credentials, each credential must be activated and agencies must be explicitly granted access.\n4. **Both access points must be configured**: Supply Access Rules AND per-connector credential access. Missing either = no results.\n\n### Testing External Suppliers\n- Always keep the \"Juniper Training Agency\" (credit agency) allowed — it's the guaranteed test agency for real external bookings\n- Start with a small test agency, block all others during testing phase\n- Use the **Shopping Center** to test searches: filter by \"external\" to see only external supplier results\n- If no results appear: check both access rules and credential access, then check if the supplier is responding (timeout issues)\n\n### Quick Deactivation\n- Each supplier can be rapidly deactivated from the Supply Access screen (toggle button) — useful for emergencies (supplier errors, technical problems)\n- Access rules can be viewed/exported to Excel from both the customer perspective and supplier perspective\n\n### Special Markup for External Suppliers\n- **Standard markup**: Applied at a general level to all products\n- **Special markup**: Optional, can replace or accumulate with the general markup. Configure per agency, per supplier integration.\n- Use the **Markup Simulator** to verify: fill in channel, agency, zone, product group → see which markups apply and at what percentage\n- To really verify: make a test booking and check the actual price\n\n### External Supplier Optimization (Advanced)\n- **Timeout settings**: Configure per supplier how long to wait for responses (critical for web service)\n- **Templates**: Load templates to control which hotels appear in results — essential for web service where you can't send all results\n- **Promoted Access / Parallel Search**: Advanced module for optimizing search results across multiple suppliers\n- **Recommended prices**: Decide per supplier whether to show recommended prices or not\n- **Business Intelligence**: Use BI module to understand how to optimize external supplier results (which hotels to show on web, which supplier, etc.)\n\n### Area Mapping for External Suppliers\n- **Hotels**: Use polygon-based mapping. Define your own area polygon → hotels with coordinates inside appear regardless of how the supplier classifies them\n- **Non-hotel products** (services, transfers): Go to Master Tables → External Suppliers → Provider Synchronization. Map your areas to supplier areas manually.\n- **Flights**: Use IATA/YATA codes. Can add additional airports to areas.\n- You control the mapping — prevents suppliers from showing unwanted results outside your intended area\n\n---\n\n## 12. Own Accommodation (Manual Hotel Load)\n\n### Hotel Creation Steps\n1. Create the hotel record with general information (name, address, classification, GPS coordinates)\n2. Define room types and their characteristics\n3. Create contracts with date ranges (purchase + sales)\n4. Load rates (cost and sales prices) per season, room type, board type\n5. Configure allotment (inventory per date)\n6. Set cancellation policies\n7. Optionally configure extranet access for the supplier\n\n### Contract Management\n- Contracts have validity date ranges — extend via the contract dates, not by creating duplicates\n- When combining contracts across date ranges: enable \"Combine with other contracts\" option, otherwise searches spanning two contract periods return no results\n- **Contract types** can be classified (FIT, RAC, PROMO, GARANCEA) — useful for filtering and applying different markup rules\n- **Multi-hotel markup**: Can create markup rules filtered by contract type (e.g., all RAC contracts get one markup, FIT gets another)\n\n### Commissionable vs Net Rates\n- For commissionable contracts (e.g., RAC with 20% commission): markup is applied on total price including commission\n- To apply markup on the net tariff instead: use the \"net\" option available at extranet/contract level\n- If mixing commissionable and net contracts: create separate multi-hotel markup rules per contract type\n\n### Room Management\n- To disable a room: first cancel all allotment associations, then disable\n- Disabled rooms can be eliminated, but must have no associations (allotment, contracts)\n- If a room has been used in bookings, it may need to be cancelled via database by the project manager\n\n### Non-Hotel Accommodations (Apartments, B&Bs, Private Structures)\n- Create a GP code classified as non-hotel accommodation type\n- In **Accommodation Data Catalog → Types of Accommodation**: set the GP code with proper description\n- When classification is \"non-hotel\", the system skips the standard hotel mapping\n- Must enable non-hotel visibility in the web: create rules under Unique Hotel configuration specifying which sales channels (B2B, B2C, all) can see non-hotel properties\n\n### Allotment Distribution\n- **Base allotment**: Generic allotment available to all agencies (e.g., 5 rooms)\n- **Distribution**: Carve out portions of base allotment for specific agencies\n- Two distribution modes:\n  - **Limited**: Agency gets X rooms from Y total, but if not sold, other agencies can still buy all Y\n  - **Reserved/Guaranteed**: Agency gets X rooms exclusively — other agencies can only buy (Y-X)\n- Configure via: Contract → Allotment → New Distribution → Name, dates, access list, quantity, mode\n\n---\n\n## 13. Charter Flights Module\n\n- Separate module from GDS flights (Amadeus)\n- Loading process similar to hotel/service product logic\n- Charter flights are own inventory — you control availability, pricing, seat counts\n- Passenger document data (passport) may be mandatory for quotation — if errors occur, check the document type configuration\n- **Workaround for passport errors**: Select DNI instead of passport for testing; if passport format causes errors, open a ticket to reconfigure the passport format\n- Charter bookings can be done from both call center and web\n\n---\n\n## 14. Transfers — Detailed Configuration\n\n### Basic Structure\n- **Origin → Destination**: Each transfer has origin area and destination area\n- **Options**: Each transfer can have multiple options (e.g., shared bus, private car, VIP)\n- **Meeting Points**: Critical for ground handling. Import via CSV file (quickest) or add manually\n- Area types affect the web booking experience:\n  - **Airport area**: System asks for flight information\n  - **Port area**: System asks for ship information  \n  - **Train station area**: System asks for train number\n  - **City/neighborhood**: System asks for hotel name/address\n\n### Multi-Segment Transfers (Complex Routes)\n- Example: Airport → Port (bus) → Island (ferry) → Hotel (bus) = 3 different suppliers\n- **Option 1 — Single transfer with cost breakdown**: Create one transfer product, use the Breakdown feature to split costs across multiple suppliers. Single sale price to customer, internal cost segmentation.\n- **Option 2 — Package approach**: Create 3 separate transfers and bundle as a dynamic package. Customer sees 3 transfer lines.\n- Recommendation: Use single transfer with cost breakdown for simpler customer experience\n\n### Trains as Transfers (Workaround)\n- When no train integration exists: load train routes as transfers\n- Create each origin-destination combination as an option within the transfer\n- For multi-stop routes: every possible combination (A→B, A→C, A→D, B→C, B→D, etc.) needs its own option with its own price\n- Create train station areas with proper area type classification\n- **Limitation**: Transfer module and train module use different search boxes — cannot combine in one tab. Talk to web team about workarounds.\n- For free-sale train products, allotment management is difficult — use free sale mode\n\n---\n\n## 15. Ground Handling Operations\n\n### Setup Requirements\n1. In each product (transfer/service): activate \"Show in Ground Handling\" AND \"Needs to be assigned in Ground Handling\" in the General tab\n2. Activate the same settings in the corresponding supplier record\n3. Import meeting points via CSV file (recommended) or manual entry\n\n### Assignment Screen\n- View all bookings that need operational assignment for a given date\n- Assign drivers, guides, vehicles to specific bookings\n- Can change supplier contract per booking (cost recalculated)\n- Can force a specific supplier cost instead of cheapest\n- Group comments can be added per assignment\n- Print vouchers (driver/guide recount sheets) from the assignment screen\n\n### Meeting Points\n- Two choices: import meeting point main areas, or import specific meeting points\n- Can also import meeting points from another transfer product\n- Meeting points in options determine which hotels/locations customers can select on the web\n- Hotels become meeting points in cities; terminals become meeting points at airports\n\n### Voucher/Assignment PDF\n- Not a real customer voucher — it's an internal document for driver/guide passenger reconciliation\n- Configurable in the product maintenance, also printable from assignment screen\n\n### Languages in Ground Handling\n- Additional languages for signs/documents require database-level creation by Juniper team\n- Not related to booking languages — purely operational display\n\n---\n\n## 16. Bookings — Advanced Operations\n\n### Booking from Web vs Call Center\n- **Call Center**: Internal module, you see cost prices, more control, can force certain options (e.g., override stop sales)\n- **Web (as admin)**: Use \"Quick Access\" from call center to enter web as agency. You see extra menus (Web Tools, Agent Area) that agents don't see.\n- **Web (as B2B agency)**: Standard agency experience. Test with credit agency to verify voucher visibility.\n\n### Price Change Management\n- **Accommodation**: Configure price change tolerance in Product → Accommodation → Price Changes. Set margin (% or fixed) — if price change exceeds margin, booking is blocked.\n- **Other products**: Currently price change management only fully works for hotels. For services/transfers, if price changes exceed tolerance, the system blocks the booking. Open ticket for other product types.\n- **Quote → Booking conversion**: When converting a saved quote to a real booking, price changes may occur. The system either accepts (within margin) or blocks (exceeds margin).\n\n### Booking Lists\n- **Generic list**: Shows complete booking with total sales, cost, profit — one line per booking\n- **Product-level list**: Shows each product within a booking on separate lines — has commission details, individual statuses, markup breakdown\n- **Always use both lists**: Generic for overview, product-level for detail\n\n### Booking Status Workflow: Confirmed → OK\n- **Confirmed (CON)**: Booking created and confirmed with supplier, but NOT yet paid (for prepayment agencies)\n- **OK**: Payment received and verified. This is the \"completed\" status.\n- For prepayment agencies: limited time to pay → system sends reminders → auto-cancels if not paid\n- For credit agencies: booking goes directly to OK (no expiration date, no auto-cancel)\n- Invoice generation typically triggered at OK status\n\n### Notifications Configuration\n- Configure email templates for key booking events\n- Notification timing: how many days before expiration to start sending\n- Frequency: typically every 12 hours for expiration reminders\n- Notifications work for prepayment bookings; credit bookings don't get payment reminders\n\n### Rooming List\n- Available for hotel bookings\n- Can send to supplier at massive level (select multiple bookings → send)\n- Template-based email sending\n- Cannot schedule automatic sending — manual trigger only\n\n---\n\n## 17. Commissions and Revenue\n\n### Commission Structure\n- **Agency commission**: Percentage of sale price recognized to the agency\n- **IVA on commission**: Optional tax percentage applied on top of commission amount\n- **Retention tax**: Advanced option — adds a tax on the commission that increases what the agency pays. Effectively reduces the commission payout. (Originally developed for South American tax requirements.)\n\n### Commission Visibility\n- Commission columns visible in product-level booking list (not in generic booking list)\n- Some columns restricted by user permissions — check \"Hide sales price from general bookings\" restriction\n- When creating new users: system auto-selects all permissions but leaves restrictions unchecked. Restrictions must be manually enabled.\n\n### User Permissions Gotcha\n- When creating a new user and clicking \"select all\": the system selects all **permissions** but not **restrictions**\n- Restrictions are things like \"Hide sales price\" — if someone doesn't see certain data, check their restrictions, not just their permissions\n\n---\n\n## 18. Discount Module (Promo Codes & Campaigns)\n\n### Three Discount Types\n1. **Early Booking**: Discount applied X days before travel. Primarily for hotels but applicable to any product via this module.\n2. **Promotion**: Standard percentage or fixed discount with date/product conditions\n3. **Campaign**: Promo code-based discounts (e.g., \"BLACKFRIDAY2026\"). Customer enters code on web to receive discount.\n\n### Configuration\n- Create discount with specific filters: product type, destination, date range, agency/channel\n- Discounts visible primarily on the web (agencies see discounted prices)\n- In call center: manually enter promo code to apply campaign discount\n- Web display customizable: show old price crossed out + new price + discount percentage\n\n### Hotel-Specific vs Generic Discounts\n- Hotels have a built-in early booking/offer system in their own product configuration (more options, template-based)\n- The Discount module is complementary — fewer options per product but works across ALL product types\n- Use hotel-built-in for hotel-specific offers; use Discount module for cross-product campaigns and promo codes\n\n---\n\n## 19. Payment Terms Module (Supplier Payments)\n\n### Structure\n1. **Payment Conditions**: Define HOW to pay (1-12 installments, percentage per installment, timing relative to booking date/check-in/check-out)\n2. **Payment Condition Rules**: Define WHO gets which condition (per supplier, contract, product type, area, rate type, channel)\n3. **Rules Simulator**: Test which rules apply to a given booking or hypothetical search\n4. **Payment Expired Report**: List of all payment due dates across bookings, exportable to Excel\n\n### Key Details\n- Installments: 1 to 12, each with a percentage and timing\n- Timing options: at booking time, X days before check-in, X days after check-out, specific day of month\n- Margin can be positive (after) or negative (before) relative to the reference date\n- **Priority**: When rules overlap, more detailed rules take priority. If equal detail, use the priority field.\n- **Room type limitation**: Cannot set different conditions per room type. Workaround: create separate contracts for rooms needing different payment terms.\n- Can apply to all product types (accommodation, transfers, services)\n- Supports ERP code mapping for accounting export\n- Due dates visible in booking detail view (supplier pay due date field)\n\n### Agency Payment Methods\n- **POS (Payment Gateway)**: Activate only with a connected payment gateway. Default shows credit card option when agency is POS or when product is non-refundable.\n- **Prepayment**: Booking gets an expiration date. Auto-cancel if not paid. System sends reminder notifications.\n- **Credit**: No expiration date. Booking guaranteed. Payment due date comes from invoice creation, not booking.\n- Can configure: auto-invoice on OK status, auto-invoice on 100% payment, or manual invoice creation\n\n### Invoice vs Pro Forma\n- Invoice cannot be deleted once created (only credit notes possible)\n- Some clients use \"pro forma\" instead of \"invoice\" — can request name change via ticket\n- **Caution**: If generating invoices in Juniper AND in external accounting system, may cause legal/audit issues with duplicate invoice numbers\n- Due dates only appear on invoices, not on pro formas (unless specifically developed)\n\n---\n\n## 20. Web Content Management\n\n### Quick Access Method (Recommended)\n1. From Call Center → select any agency → \"Quick Access\" to website\n2. On website, click **Web Tools** → activate **Content Management**\n3. Yellow boxes appear showing exactly which content element each section uses\n4. Click any yellow box → goes directly to the correct content record in the intranet\n5. Much faster than navigating content folders manually\n\n### Content Structure\n- Organized in folders per sales channel → per page section\n- Each section has a main content (NEVER DELETE the main content — very hard to recover)\n- Sub-contents can be added/deleted freely (e.g., banner slides, offer cards)\n- **Order field**: Controls display sequence of sub-contents\n- **Active checkbox**: Show/hide content without deleting\n\n### What You Can Change\n- Text, images, links within existing sections\n- Add/remove sub-content items (banners, offers, etc.)\n- Show/hide entire sections\n- **Cannot change**: Page layout/structure, section positions, section design format\n\n### Content Fields\n- **Name**: Mandatory for identification, but not always displayed on website (depends on section design)\n- **Description**: Available for text content\n- **Photo/Image**: Always functional\n- **Link**: Always functional — create links to product searches (destination, product type)\n- **Date, product type, search-related fields**: Only work if specifically developed for that section\n\n### Burner/Banner Management\n- Auto-rotation timing: cannot change from intranet — requires project manager/web team\n- Maximum banners per section: test to verify (usually no hard limit but keep it reasonable)\n- Each banner can link to a product search or destination page\n\n---\n\n## 21. Destination/Area Management\n\n### Area Hierarchy\n- **Area → Sub-area** (also called \"father → son\")\n- Structure varies by country — don't worry about matching state/province/region exactly\n- Booking engine works with area and sub-area levels\n\n### Booking Engine Areas vs Custom Areas\n- Booking engine areas: Shared across all Juniper clients, cannot modify name or classification\n- Custom areas: Create your own (e.g., \"Costa Smeralda\") for marketing/operational purposes\n- For packages/tours: Create entirely custom zones (e.g., \"Puglia Circuit\") not tied to geography\n\n### Area Properties\n- **Active**: Area usable in system (create products, visible internally)\n- **Public**: Area visible on website to customers\n- Area only appears in web search if products exist in that area\n- **Polygon**: Define geographic boundary. Hotels with coordinates inside polygon appear in search.\n- Can create custom polygon to replace default (Juniper default polygons shared across clients, cannot modify)\n- **Linked areas**: Link two areas together → searching for one also returns results from the other (works for accommodation and flights)\n\n### Area Types and Their Effect on Transfers\n- **Airport**: Web asks for flight information during transfer booking\n- **Port**: Web asks for ship information\n- **Train Station**: Web asks for train number\n- **City/Neighborhood**: Web asks for hotel name or address\n\n### Blocking Destinations\n- To block sales for certain countries/destinations: use **Master Tables → Supply Access Rules**\n- Create rules per integration blocking specific destinations for specific agencies/channels\n- More efficient than deactivating each area individually\n- For external suppliers: block at supply access level; for own products, less necessary (you control what you load)\n\n---\n\n## 22. Extranet (Supplier Portal)\n\n### Three Extranet Types\n1. **Hotel/Accommodation Extranet**: Supplier loads/manages hotel data, rates, allotment\n2. **Services Extranet**: Supplier loads/manages transfers and services\n3. **Predefined Packages Extranet**: Supplier loads closed/circuit packages (optional, may not be active)\n\n### Extranet Setup\n1. Create extranet user: Master Tables → Extranet Users\n2. Assign login credentials for the extranet URL\n3. Associate with a supplier record (must exist in Master Tables → Suppliers)\n4. Set language, associated areas\n5. Configure what the supplier can see (sales data visibility is optional and restricted)\n\n### Extranet vs Intranet\n- Extranet is a restricted view of the intranet — supplier cannot see:\n  - Product group classifications\n  - Customer information\n  - Other suppliers' data\n  - Certain configuration options\n- **Review Status**: Extranet has a review/approval workflow. Supplier changes show as \"not reviewed\" until you approve them from the intranet.\n\n### Web Modifications\n- Most visual/functional changes on the web require the front-end team\n- Extranet/intranet configuration covers data and business logic\n- Web changes (layout, new features, custom behavior) require tickets and development hours\n- Always prioritize web change requests — some are simple (2 hours), some are complex\n\n---\n\n## 23. Services (Excursions, Activities) Configuration\n\n### Service Structure\n- Similar to transfer but without origin/destination routing\n- General data → Destination/Area → Supplier → Options → Rates → Availability\n- Each option can have its own pricing, capacity, schedule\n\n### Loading via Extranet\n- Same flow as intranet loading but restricted view\n- Supplier creates the service, you review and approve\n- Associated areas determine where the service appears in web searches\n\n---\n\n## 24. Quotation System (Advanced Shopping Cart)\n\n### How It Works\n- When \"Advanced Shopping Cart\" is active: products show \"Add to Cart\" button instead of direct booking\n- Cart allows combining multiple products before checkout\n- **Save Quotation**: Saves the shopping cart as a special booking code (visible in client's area on web)\n- **Important**: This is NOT a traditional quotation/pre-booking — it's a saved search/cart. No supplier reservation is made.\n- **Book Now**: Proceeds to actual booking with payment\n\n### Current Limitations\n- Map visualization in cart may not show products in correct area (content/label configuration needed)\n- Commission details not always visible in cart summary (requires activation)\n- Budget/PDF generation from cart may need additional development\n- Quote-to-booking conversion may encounter price changes (handled by price change tolerance settings)\n\n### Center vs Web Quotations\n- Web: More developed, has advanced shopping cart features\n- Center: Simpler, doesn't show cost information from web perspective\n- **Key gap**: Center doesn't show cost prices when accessed via web quick-access. This is a known limitation — open ticket if center-based cost visibility is needed for quotation workflow.\n\n---\n\n## 25. Practical Tips and Gotchas\n\n### Common Issues\n1. **No search results**: Check BOTH supply access rules AND per-connector credential access\n2. **User can't see certain data**: Check restrictions (not just permissions) in user configuration\n3. **Contract date gaps**: Enable \"Combine with other contracts\" or searches spanning two contracts return nothing\n4. **Passport errors in bookings**: Usually a document format configuration issue — try DNI as workaround, open ticket for permanent fix\n5. **TripPlanner codes**: TripPlanner module may not be fully configured — bookings created via TripPlanner have different/longer codes and may show differently in booking lists\n6. **Pre-production URL**: When production has bugs, use the pre-production URL (juniper.s domain) which often has fixes deployed earlier\n\n### Configuration Best Practices\n- **Always test with a dedicated test agency** before opening to production agencies\n- **Use the Markup Simulator** before going live with markup rules\n- **Export access rules to Excel** periodically to audit who has access to what\n- **Keep \"Juniper Training Agency\" always accessible** — it's your safety net for testing real external bookings\n- **When copying products** (e.g., transfers): the copy may not carry all extranet review statuses — check review status on the copy\n- **Fiscal year**: Must be opened before any invoicing. Only one fiscal year open at a time.\n\n### Performance Tips\n- **Web service searches**: Limit results using templates — don't send all hotels from all suppliers\n- **Timeout configuration**: Set appropriate timeouts per external supplier based on their response speed\n- **Parallel search**: Use Promoted Access module for optimized multi-supplier searches\n- **Unique Hotel + Room Mapping**: Use these to deduplicate results from multiple suppliers and show only the best price per property\n\n### Workarounds Mentioned in Training\n- **Insurance cross-selling**: Currently works per product line, not on total booking. Development may be needed for total-booking-based insurance.\n- **Rooming list auto-send**: Not available. Must send manually (but can do bulk/massive send).\n- **Extranet for transfers/services**: No auto-import from supplier → extranet load is the workaround\n- **Train tickets without integration**: Use transfer module as workaround (each route combination = one transfer option)\n- **Reject button on bookings**: May be configurable via an advanced parameter, but trainer needs to test before confirming availability\n- **Massive email to suppliers (tour information)**: Not possible at massive level with custom templates. Can only send standard templates in bulk.\n\n---\n\n## 26. Channel Manager / Extranet Integration\n\n### Two Proposals for Supplier Data Entry\n1. **Manual Extranet**: Supplier logs in with username/password, manually enters rates, allotment, offers, supplements, restrictions, stop sales\n2. **Channel Manager**: Software (e.g., OctoRate, ErikaSoft) connects to Juniper's Extranet API and pushes data automatically\n\n### Channel Manager Setup Flow\n1. Create hotel record in intranet with basic data (general info, room types)\n2. Create an Extranet user for the channel manager\n3. Associate the Extranet user with the supplier and the specific hotel\n4. Channel manager connects to the Extranet URL with those credentials\n5. Channel manager pushes rates, allotment, restrictions directly into the Extranet\n6. **Review status**: All data pushed by channel manager appears as \"not reviewed\" — must be approved from the intranet\n\n### Key Configuration Elements for Hotels\n- **Supplier (Fornitore)**: Must exist in Master Tables before hotel creation\n- **Product Group**: Classification for markup/commission rules (e.g., \"Hotel Direct\", \"Hotel Manual\")\n- **Board Types**: Meal plan options (must be pre-configured in Master Tables)\n- **Room Occupancy**: Adult/child/baby combinations per room type\n- **Seasons**: Date-based pricing periods\n- **Hotel Services**: Amenities and features (pool, spa, etc.)\n\n### Quick Hotel Load for Testing\n1. Use the \"Accommodation Quick Guide\" from eLearning for step-by-step\n2. Create hotel → add room types → create contract → load rates → set allotment\n3. For channel manager testing: create the hotel with basic data, then let the channel manager push rates/allotment\n4. Always test with \"Juniper Training Agency\" first\n\n---\n\n## 27. Extranet Detailed Operations\n\n### Extranet User Types\n- **Hotel Extranet user**: Can manage accommodation data, rates, allotment, offers\n- **Services Extranet user**: Can manage transfers and destination services\n- **Packages Extranet user**: Can manage predefined packages (optional module)\n\n### What Suppliers Can Do via Extranet\n- Load/modify rates (cost prices) per season, room, board type\n- Manage allotment (availability) per date\n- Create offers and supplements\n- Set restrictions (minimum stay, close to arrival/departure)\n- Apply stop sales\n- **Cannot do**: See product groups, view customer data, modify sale prices, access markup configuration\n\n### Review Workflow\n- All Extranet changes show as \"not reviewed\" in the intranet\n- Filter by review status to see pending supplier changes\n- Must explicitly approve/review changes before they take effect in live searches\n- When copying products: review status may not carry over — always re-check\n\n---\n\n## 28. Receipt Rules (Agency Payment Installments)\n\n### Purpose\nControls how agencies pay in installments on the web (for POS and prepayment agencies only — NOT for credit agencies).\n\n### Configuration (Customers → Receipt Rules)\n- **Priority**: Lowest number = highest priority\n- **Sales channel & date**: Booking creation date (not travel date)\n- **Product filters**: Product type, module, supplier, specific product\n- **Minimum payment**: Fixed amount (total or per person) or percentage of net price\n- **Maximum installments**: How many payments the customer can split into (or unlimited)\n- **Final payment deadline**: Margin in days relative to check-in date or first cancellation charge date\n\n### How It Works on the Web\n1. Customer selects product, proceeds to booking\n2. System shows minimum required deposit (e.g., 5% of net)\n3. Customer pays minimum at booking time\n4. Customer can return and make additional payments at any time\n5. Customer chooses how much to pay each time (no fixed schedule)\n6. All payments must be completed before the final deadline\n7. If deadline passes without full payment: booking auto-cancels\n\n### Current Bug (as of Feb 2026)\n- Final payment deadline margin is calculated from today's date instead of from check-in/cancellation charge date\n- Workaround: Manually adjust or open ticket for fix\n\n### Key Distinction from Payment Terms Module\n- **Payment Terms** = how YOU pay YOUR SUPPLIERS\n- **Receipt Rules** = how YOUR AGENCIES pay YOU\n\n---\n\n## 29. Accounting Module — Operational Details\n\n### Invoice Creation Flow\n1. Booking reaches target status (OK, or 100% paid, or manual trigger)\n2. Go to booking → click \"Invoice\" button (or use Accounting module for bulk)\n3. System creates invoice with number from configured series\n4. Invoice gets a due date (from agency configuration or manual entry)\n5. Invoice can be sent immediately or later\n6. **Once created, invoices CANNOT be deleted** — only credit notes possible\n\n### Pro Forma vs Invoice\n- **Pro Forma**: Informational document, no official number, no fiscal implications. Always available for any booking.\n- **Invoice**: Official fiscal document with sequential number. Created manually or via auto-invoice rules.\n- If using external accounting system (e.g., Avis): consider only using pro forma in Juniper to avoid duplicate invoice legal issues\n\n### Auto-Invoice Options (Accounting → General Configuration)\n1. Auto-invoice when booking reaches OK status\n2. Auto-invoice when booking reaches 100% payment\n3. Auto-invoice with extra module (scheduled/rule-based)\n\n### Invoice Due Dates for Credit Agencies\n- Configured per agency: fixed day of month (e.g., every 1st or 15th)\n- Overrides any manually entered date when creating the invoice\n- Due date only appears on the invoice document, not on pro forma\n- No automatic payment reminders for credit agencies — only for prepayment agencies\n\n### Key Accounting Gotchas\n- Fiscal year must be open before any invoice creation\n- Only one fiscal year open at a time\n- Invoice series are per invoicing company (Holding module)\n- When exporting to external accounting: verify the correct export notes/parameters with Juniper support (Lili)\n- Payment Terms module due dates are visible in booking detail AND in the Payment Expired report, exportable to Excel\n\n---\n\n## 30. Payment Term Recalculation Rules\n\n### When Booking Changes\n- **Cost modification** (adding nights, changing rooms, price adjustments): Payment terms are NOT auto-recalculated\n- Must manually click **\"Calculate Payment Rule\"** button to recalculate, OR manually edit amounts\n- If already paid partial amount: easier to manually adjust remaining installment than to recalculate\n- Recalculation uses current cost, ignoring what was already paid — it's a simple percentage calculation\n\n### When Booking is Cancelled\n- Original payment term lines are automatically eliminated\n- Cancellation cost (if any) is calculated\n- Must click \"Calculate Payment Rule\" to create new terms for the cancellation cost\n\n### Manual Override\n- Can modify any payment term line manually (date, amount, payment method)\n- Modified lines show a green checkmark to indicate manual changes\n- Modifications affect only that booking, never the rule itself\n- Can filter Payment Expired report to show only manually modified entries\n\n---\n\n## 31. External Flights Module\n\n### Flight Types in Juniper\n1. **Charter flights**: Own inventory, loaded like hotel/service products\n2. **External flights (GDS)**: Via integrations (Amadeus, etc.)\n3. **Negotiated fares**: Special airline deals pushed to your GDS\n\n### Flight-Only Configuration (Flights → Only Flight)\n- Control which flight types appear in web search:\n  - Charter flights: show/hide\n  - Negotiated commissionable fares: show/hide\n  - Negotiated net fares: show/hide\n  - Public fares: show/hide\n- Can show all or selectively enable per fare type\n\n### Flight Markup — Different from Other Products\n- Flight markup is NOT configured in the standard product group markup screen\n- Flights have their own specific markup menu (under Transports)\n- This is because flight pricing depends on route, rate type (negotiated vs public), and other factors\n- Markup options: percentage markup or service fee (booking fee)\n- Project manager typically helps configure initial flight markup rules\n\n### External Supplier Configuration for Flights\n- Each integration (Amadeus, DC, etc.) has its own credentials under Transports → External Supply Configuration\n- Access control: per integration, per agency (same pattern as hotel external suppliers)\n- Check timeout settings per integration to avoid slow searches\n- Can configure maximum results to return (prevents long wait times)\n\n### Route Blocking\n- External integrations send ALL possible routes\n- To block flights to certain countries/areas: Transports → Route Blocking\n- Blocking is per country — useful for war zones, restricted destinations, or commercial decisions\n\n### Ticketing\n- Some integrations support automatic ticket issuance\n- PNR synchronization available for some integrations\n- Ticket issuance permissions: separate permission in user configuration (\"issue ticket\" button on booking)\n\n### Mandatory Fields for Flight Bookings\n- Each integration has default mandatory fields (passenger name, document, etc.)\n- Additional mandatory fields can be configured: Transports → Additional Fields\n- Common addition: passport/document details, frequent flyer number\n\n---\n\n## 32. Own Accommodation — Advanced Rate Management\n\n### Contract Types and Their Purpose\n- **BAR (Best Available Rate)**: Standard rate, most common for channel manager connections\n- **FIT**: Group/trade rate\n- **RAC**: Rack rate (commissionable)\n- **Promotional**: Special offer contracts\n- Classification is primarily for filtering and reporting — does not directly affect system behavior\n- **Important**: Cost-level classification (per rate/season) is MORE important than contract-level classification for reporting\n\n### Contract Date Management\n- Contracts have a validity period — rates can only be loaded within this period\n- To extend: either modify the contract end date and reload rates, OR create a new contract\n- **Cannot have gaps** between contract periods if you want continuous availability\n- Enable \"Combine with other contracts\" to allow searches spanning two contract periods\n\n### Rate Loading Methods\n1. **Manual (Intranet)**: Load per season, room type, board type, occupancy\n2. **Extranet (Manual)**: Supplier logs in and enters rates\n3. **Channel Manager**: Automated push from software (OctoRate, ErikaSoft, etc.)\n\n### Allotment Advanced\n- **Free sale**: Unlimited availability (no allotment control)\n- **On request**: Availability checked manually with supplier before confirming\n- **Allotment-based**: Fixed inventory per date, auto-decremented on booking\n- **Stop sale**: Blocks availability for specific dates — takes priority over allotment\n- **Release days**: Auto-release allotment X days before check-in (reverts to on-request or closes)\n\n### Offers and Supplements\n- **Early booking offers**: Discount for booking X days in advance (hotel-specific, more options than generic Discount module)\n- **Long stay offers**: Discount for staying X+ nights (e.g., \"stay 7 pay 6\")\n- **Supplements**: Extra charges per night, per person, per stay (e.g., sea view supplement, peak season supplement)\n- **Restrictions**: Minimum stay, maximum stay, close to arrival, close to departure\n- All configurable per date range and room/board type\n\n---\n\n## 33. Services Configuration — Detailed\n\n### Service Types\n- **Excursions**: Day trips, guided tours\n- **Activities**: Spa, sports, entertainment\n- **Tickets**: Museum, theme park, event tickets\n- **Insurance**: Travel insurance products (special cross-selling behavior)\n- **Car rental**: Vehicle rental services\n\n### Service Options Structure\n- Each service can have multiple options (e.g., morning tour, afternoon tour, VIP tour)\n- Each option has its own: pricing, capacity, schedule (days of week), duration\n- Options can be per-person or per-unit pricing\n- Options can have min/max participant requirements\n\n### Insurance Cross-Selling\n- Currently works per product line, not on total booking value\n- If insurance should be calculated on total booking: requires development\n- Insurance can appear as optional add-on during web booking flow\n\n### Service in Ground Handling\n- Must activate \"Show in Ground Handling\" in service general tab\n- Must also activate in the supplier record\n- Services then appear in the Ground Handling assignment screen for operational dispatch\n\n---\n\n## 34. Predefined Packages — Detailed\n\n### Package Structure (10+ Configuration Tabs)\n1. **General**: Package name, description, classification\n2. **Departure dates**: Calendar-based (daily, weekly, specific dates)\n3. **Hotels**: Which accommodations are included\n4. **Rooms**: Room types and combinations available\n5. **Rates**: Per-person pricing per room combo per departure date\n6. **Flights**: Charter or external flights included\n7. **Services**: Excursions, transfers, activities included\n8. **Supplements**: Optional add-ons (room upgrade, meal upgrade, etc.)\n9. **Cancellation Policy**: Package-level cancellation terms\n10. **Itinerary**: Day-by-day program description\n\n### Pricing Model\n- Per-person pricing is standard for packages\n- Price varies by: departure date, room type, occupancy (single/double/triple)\n- Child prices can be different from adult prices\n- Supplements can be mandatory or optional\n\n### Package vs Dynamic Package\n- **Predefined**: Fixed itinerary, pre-set pricing, can be loaded via Extranet by suppliers\n- **Dynamic**: Customer mixes and matches products, price calculated from components\n- Dynamic packages are more complex to configure (13 tabs + simulator) but more flexible\n\n---\n\n## 35. Q&A Insights and Recurring Issues\n\n### Pre-Production Environment\n- Juniper has a pre-production URL (juniper.s domain) that often has bug fixes deployed before production\n- When encountering bugs: test the same scenario on pre-production first\n- If it works on pre-production: the fix will come to production in the next release\n\n### Cost Visibility in Center vs Web\n- When accessing web via \"Quick Access\" from Call Center: you see agent-facing view, not cost prices\n- To see cost prices: use the Call Center module directly, or check booking detail in the intranet\n- Web Tools menu (visible to admin users) gives extra functionality when browsing as an agency\n\n### Area Management — Practical Tips\n- Don't worry about matching exact geopolitical hierarchy — use areas and sub-areas pragmatically\n- Create custom areas for marketing purposes (e.g., \"Costa Smeralda\" as an area)\n- **Always add both the custom area AND individual municipalities** as options so customers can search by either name\n- Polygon-based area mapping: define your own polygon → all hotels with coordinates inside appear in search\n- Area must be both **Active** (usable internally) and **Public** (visible on web) — and must have products to appear in web search\n\n### Booking Expiration Logic\n- Prepayment agencies: booking gets expiration date → reminders sent → auto-cancel if unpaid\n- Credit agencies: NO expiration date, booking is guaranteed\n- If ANY product in the booking is already incurring cancellation charges (e.g., non-refundable), expiration date is removed automatically\n- Manual addition of expiration date to an OK booking: appears on web but does NOT trigger auto-cancellation\n\n### User Permission Patterns\n- New users: \"Select All\" enables all permissions but NOT restrictions\n- Restrictions must be manually checked (e.g., \"Hide sales price from general bookings\")\n- Permission for invoice creation and ticket issuance are separate from booking permissions\n- Extranet permissions are separate from intranet permissions — different user types\n\n### GP Code and Non-Hotel Accommodations\n- Non-hotel properties (apartments, B&Bs) need a GP code classified as non-hotel accommodation type\n- Must configure in Accommodation Data Catalog → Types of Accommodation\n- Must enable visibility rules under Unique Hotel configuration for non-hotel types\n- If GP code mapping issues occur: open a ticket, some require database-level fixes\n\n### Multi-Contract Display in Center\n- Configuration option: \"Show all supplier contracts\" vs \"Show best contract only\"\n- When enabled: call center users see all available rate types (refundable + non-refundable) from all contracts\n- When disabled: system shows only the best price from the highest-priority contract\n- Client decides which option to use based on business needs\n\n### Newsletter and System Updates\n- Juniper publishes newsletters with new features and changes\n- Newsletters arrive by email to registered users\n- Also available in the e-docs section of the intranet\n- The system is continuously developed — features requested today may become available in future releases\n\n--- SOURCE: ACCOMMODATION_OFFERS_AND_CONTRACTS.md ---\n# Accommodation Special Offers and Contract Configuration in Juniper Booking Engine\n\n## How to Load Special Offers in an Accommodation Contract\n\nThere are two ways to configure special offers for accommodation products in JBE:\n\n### Option A: Hotel-Level Offers (Offers and Supplements Section)\n\nThis is the recommended approach for hotel-specific promotions. Navigate to your hotel product configuration, then go to the **Offers and Supplements** section.\n\n#### Available Offer Types:\n\n1. **Early Booking Offers**: Configure a discount percentage for bookings made X days in advance of check-in date. This is template-based and provides more granular options than the generic Discount module. You define the advance booking window and the discount applied.\n\n2. **Long Stay Offers**: Configure \"stay X, pay Y\" rules. For example, \"stay 7 nights, pay 6\" gives one free night for weekly bookings. You set the minimum stay threshold and the number of nights charged.\n\n3. **Supplements**: Extra charges that can be applied per night, per person, or per stay. Examples include sea view supplement, peak season supplement, or holiday supplement.\n\n4. **Restrictions**: Control availability with minimum stay, maximum stay, close to arrival, and close to departure rules.\n\n#### Important Configuration Details:\n- All offers can be scoped to specific **date ranges**, **room types**, and **board types**\n- Offers are configured per contract within the hotel product\n- The hotel-built-in offer system has MORE options and is template-based compared to the generic Discount module\n- Use this method for hotel-specific promotions and seasonal offers\n\n### Option B: Discount Module (Cross-Product Campaigns)\n\nThe Discount Module is a separate JBE module that works across ALL product types (not just hotels). Navigate to the **Discount Module** section.\n\n#### Three Discount Types:\n\n1. **Early Booking**: Discount applied when booking is made X days before the travel date. Works for hotels and all other product types.\n\n2. **Promotion**: Standard percentage or fixed amount discount. Configure with date ranges, product type filters, destination filters, and agency/channel filters.\n\n3. **Campaign (Promo Codes)**: Code-based discounts where customers enter a promo code (e.g., \"BLACKFRIDAY2026\") on the web to receive a discount. In call center mode, agents manually enter the promo code.\n\n#### Discount Module Configuration:\n- Create discount with specific filters: product type, destination, date range, agency/channel\n- Discounts are visible primarily on the web (agencies see discounted prices)\n- Web display customizable: show old price crossed out + new price + discount percentage\n- In call center: manually enter promo code to apply campaign discount\n\n### Which Method to Use?\n\n| Criteria | Hotel-Level Offers | Discount Module |\n|----------|-------------------|-----------------|\n| Scope | Single hotel/contract | Cross-product |\n| Options | More granular, template-based | Fewer per-product options |\n| Promo codes | No | Yes (Campaign type) |\n| Product types | Hotels only | All products |\n| Best for | Hotel-specific seasonal offers | Company-wide campaigns |\n\n**Recommendation**: Use hotel-built-in offers for hotel-specific promotions (early booking, long stay). Use the Discount module for cross-product campaigns and promo code promotions.\n\n## Accommodation Contract Types\n\nContracts in JBE can be classified by type:\n- **FIT**: Group/trade rate contracts\n- **RAC**: Rack rate contracts (commissionable)\n- **Promotional/PROMO**: Special offer contracts\n- **GARANCEA**: Guaranteed rate contracts\n\nClassification is primarily for filtering, reporting, and applying different markup rules. It does not directly affect system behavior. Cost-level classification (per rate/season) is MORE important than contract-level classification for reporting.\n\n## Contract Date Management\n\n- Contracts have a validity period — rates can only be loaded within this period\n- To extend: either modify the contract end date and reload rates, OR create a new contract\n- Cannot have gaps between contract periods if you want continuous availability\n- Enable \"Combine with other contracts\" to allow searches spanning two contract periods\n\n## Rate Loading Methods\n\n1. **Manual (Intranet)**: Load rates per season, room type, board type, and occupancy through the JBE intranet\n2. **Extranet (Manual)**: Supplier logs into the extranet portal and enters their own rates\n3. **Channel Manager**: Automated rate push from channel management software (e.g., OctoRate, ErikaSoft)\n\n## Allotment Management\n\n- **Free sale**: Unlimited availability (no allotment control needed)\n- **On request**: Availability checked manually with supplier before confirming booking\n- **Allotment-based**: Fixed inventory per date, automatically decremented on booking\n- **Stop sale**: Blocks availability for specific dates — takes priority over allotment\n- **Release days**: Auto-release allotment X days before check-in (reverts to on-request or closes availability)\n\n## Special Markup vs Special Offers\n\n**Important distinction**: Special Markup and Special Offers are different concepts in JBE:\n\n- **Special Offers** (this document): Discounts and promotions for customers (early booking, long stay, promo codes)\n- **Special Markup**: Additional margin applied on top of base markup for pricing purposes. Special markups are cumulative with base markup and are a pricing/margin concept, not a customer-facing promotion.\n\nDo not confuse the two. When a user asks about \"special offers,\" they mean customer-facing promotions and discounts, not markup configuration.\n\n--- SOURCE: BOOKING_FLOWS.md ---\n# Juniper Booking Flow Notes (implementation-oriented)\n\n## Universal flow pattern\nMost product APIs express this sequence:\n\n1. **Static hydrate** (`ZoneList`, `...CatalogueData`, portfolios/content)\n2. **Availability search** (`...Avail*`, `FlightAvail`, `PackageSearcher`)\n3. **Validation / pricing lock** (`...BookingRules`, optional `...CheckAvail`)\n4. **Book** (`...Booking`) with required fields and pricing/holder continuity\n5. **Read/confirm** (`ReadBooking`) and/or **Cancel** (`CancelBooking`)\n6. **Optional modify** (`...Modify` / `...ConfirmModify`)\n\n## Product-specific concrete flow notes\n\n### Ticket / Service\n- Static path: `ServiceCatalogueData` → `ServicePortfolio` (paged) → `ServiceContent`.\n- Availability: `ServiceAvail` requires at least destination or service code + dates + ages.\n- Rules: `ServiceBookingRules` is **mandatory** before booking (returns `BookingCode`).\n- Optional precheck: `ServiceCheckAvail` for some suppliers.\n- Book/Read/Cancel using the locator returned from booking.\n\n### Transfer\n- `TransferAvail` + `TransferBookingRules` + `TransferBooking`.\n- Optional `TransferCheckAvail` to revalidate selected option before booking.\n- Modify/cancel after booking as available.\n\n### Hotel / Car / Flight / Cruise / Insurance / Visa\n- Same pattern; docs consistently describe:\n  - mandatory search object → rules step (`*Rules`) → booking\n  - ticketing for flights (`FlightTicketing`) as explicit step\n  - read/check locator status after booking creation\n- Hotel/cars explicitly show modify flows with confirm step.\n\n### Package\n- `PackageSearcher` / `PackageCalendarPrice` may precede `PackageAvail`.\n- Composition can shift by `PackageChangeProduct` before final booking.\n\n## Runtime behaviors to enforce\n- Booking response `Status` is meaningful: do not treat every booked-looking payload as confirmed without it.\n- Session is stateless; allotment is not held between avail and book.\n- Check supplier/business timing:\n  - race windows between avail and confirmation are possible;\n  - if booking fails after success-like response, re-read booking state.\n- Refresh rules when:\n  - `warnPriceChanged`, `warnStatusChanged`, `warnFlightInfoChanged`, `warnFlightClassChanged`\n  - `warnReqPractices` / `warnOverwriteParameter` appears.\n\n## Hard errors that break the flow fast\n- `COMPRESSION_REQUIRED`, `JP_BOOK_EXPIRATION_DATE`, `JP_SEARCH_*`, `JP_BOOK_*`, `INVALID_*` classes should stop current attempt and force a clean re-issue path.\n- `TOO_MANY_REQUEST`, `IP_NOT_REGISTERED`, authentication/permission errors are retry-safe only after operator remediation.\n\n## 60-min execution-ready flow template\n- Availability + rules + book + read + cancel paths should be implemented as explicit state machine states with idempotent request builders and immutable request snapshots.\n\n\n### Transport\n- Static/catalog: `TransportRoutePortfolio`.\n- `TransportAvail` / `TransportCheckAvail` to select route/seat/option.\n- `TransportBookingRules` before booking when required.\n- `TransportBooking`, optional/required `TransportTicketing` depending on supplier/channel.\n- Read/cancel with shared `ReadBooking` / `CancelBooking` semantics.\n\n### Hotel PUSH (exposure model)\n- Not a customer booking UI flow; it is system-to-system data sync:\n  - availability/rate notifications for inventories and constraints.\n- Operational pattern: normalize incoming delta messages, update local cache, then allow synchronous booking flows to use fresh pricing/constraints.\n- Recommended behavior: dedupe by message identifiers and accept partial updates idempotently.\n\n---\n\n## Extended product-specific flows (added 2026-02-22)\n\n### Cruise — iterative BookingRules pattern\nCruise is unique: `CruiseBookingRules` must be called **multiple times in sequence** to iteratively select nested components:\n\n```\nPhase 1: Component selection\n  CruisePreAvail → CruiseAvail (adjust pax distribution) → \n  CruiseBookingRules (1st call) → returns component categories with RatePlanCodes\n  → Select category RatePlanCode → CruiseBookingRules (2nd call)\n\nPhase 2: Cabin selection\n  → Returns available cabins with RatePlanCodes\n  → Select cabin RatePlanCode → CruiseBookingRules (3rd call)\n\nPhase 3: Optional supplements\n  → Returns optional meal upgrades etc. with RatePlanCodes\n  → Select or skip → CruiseBookingRules (4th call)\n\nTermination: BookingCode appears in response → proceed to CruiseBook\n```\n\n**Rules:**\n- No BookingCode = mandatory component not yet selected (check Warnings for next required step)\n- Components are interdependent: category must be selected before cabin, cabin before supplements\n- If components not mandatory: skip straight to cabin step\n- If category guaranteed: skip directly to supplements step\n- Static data max update frequency: **2 weeks** (mandatory)\n\n### Insurance API flow\n```\nZoneList(ProductType=INS) → InsuranceAvail → \n[InsuranceCheckAvail (optional)] → \nInsuranceBookingRules (mandatory, returns InsuranceRequiredFields + BookingCode) →\nInsuranceBooking (returns @Locator) →\nReadBooking / CancelBooking\n```\n\n### Flight ticketing (additional step)\nFlight has an extra step after booking:\n```\nFlightAvail → FlightCheckAvail (optional) → FlightBookingRules → FlightBooking → \nFlightTicketing (issue/ticket the flight) → ReadBooking / CancelBooking\n```\n\n### Payment flow (point-of-sale accounts only)\nWhen the booking returns `Status=QUO` (quote), payment is required before confirmation:\n```\n[After HotelBooking/ServiceBooking/etc. returns QUO status]\n  ↓\nCheckPaymentRequiredFields (discover required anti-fraud fields)\n  ↓\nCheckPayment (anti-fraud validation with those fields, using @Locator)\n  → Returns Token (if @Status=VALID, @IsFraud=False)\n  ↓\nPaymentBooking (use Token + credit card details)\n  → Booking status changes: QUO → PAG (confirmed)\n```\n\n**Notes:**\n- Only for point-of-sale account type\n- Credit/pre-payment accounts skip payment entirely — booking confirms directly\n- BookingCode has an expiry time (ExpirationDate in BookingRules response)\n- If BookingCode expires before PaymentBooking, must re-run BookingRules\n\n### Disney hotel+ticket booking quirks\n- Standard Hotel API flow with Disney-specific supplements\n- Two separate age range systems (Hotel vs Tickets) apply simultaneously\n- Ticket selection happens at BookingRules step via supplemental RatePlanCodes\n- Multiple BookingRules calls may be needed if ticket options need to be changed\n- ShowBreakdownPrice=true and ShowOnlyBestPriceCombination=true are recommended AdvancedOptions\n\n### Generic API booking (multi-product bookings)\n- Multiple products can be included in a single booking if the supplier supports it\n- Each product adds its BookingCode as an element in a combined booking request\n- ReadBooking returns element-level status (can differ from booking-level status)\n  - E.g., booking=Pending, element[0]=Confirmed, element[1]=Pending\n\n## RatePlanCode vs BookingCode — critical distinction\n\n| Code | When issued | Expires? | Use |\n|---|---|---|---|\n| `RatePlanCode` | Availability/CheckAvail | Yes (implicitly after time or on price change) | Input to CheckAvail, BookingRules |\n| `BookingCode` | BookingRules response | Yes — see `ExpirationDate` attribute | Only valid input to Booking request |\n\n**Crucial:** A new `warnPriceChanged` / `warnStatusChanged` always means the old RatePlanCode is invalid — use the new one returned in the warning response.\n\n## Booking status codes\n\n| Status | Meaning |\n|---|---|\n| `OK` | Confirmed |\n| `PAG` | Paid/confirmed (point-of-sale) |\n| `QUO` | Quote — awaiting payment |\n| `RQ` | On request — awaiting supplier confirmation |\n| `CAN` | Cancelled |\n| `Pending` | Pending confirmation |\n\n---\n\n## 10) Visa API Booking Flow\n\n**Standard booking flow (mirrors Insurance/Transfer pattern):**\n\n```\nZoneList (ProductType=VIS)\n    ↓\n[VisaCatalogueData]   ← optional static classification data\n    ↓\n[VisaPortfolio]       ← paginated visa catalog (Page 1..TotalPages)\n    ↓\nVisaAvail             ← search by destination + dates + paxes (age mandatory)\n    ↓\n[VisaCheckAvail]      ← optional re-validate price/availability\n    ↓\nVisaBookingRules      ← MANDATORY — returns BookingCode + VisaRequiredFields + cancellation policy\n    ↓\nVisaBook              ← use BookingCode from BookingRules → returns @Locator\n    ↓\nReadBooking / CancelBooking\n```\n\nKey constraints:\n- Only `BookingCode` from `VisaBookingRules` is valid for booking\n- Pax `Age` is mandatory in `VisaAvail`\n- Static data max refresh: **2 weeks**\n- `VisaRequiredFields` from BookingRules dictates what must be sent in `VisaBook`\n\n---\n\n## 11) Hotel Extranet API Workflow (JPDM — Channel Manager)\n\n**ARI Update (rate sync):**\n```\n[ExtranetHotelRates] ← optional: retrieve existing rates for mapping\n    ↓\nRate update transactions (ARI: Rates/Allotment/StopSale/Release/Restriction/Supplements/Offers)\n    ↓\n[ExtranetHotelRates] ← optional: verify updated rates\n```\n\n**Booking Management (periodic sync):**\n```\nPoll ExtranetReadBooking (periodic) → retrieve new/modified/cancelled bookings since last call\n    ↓\n[ExtranetUpdateBooking] ← update Hotel Confirmation Number if permitted\n```\n\n**Hotel Import (on-demand product creation):**\n```\nHotel Import transactions (HotelTransactions binding) → create/update hotel products in Juniper\n```\n- Requires Juniper client to activate specific permissions\n\n**Endpoint:**\n- `https://juniper-uat.bookingengine.es/WebServiceJPDM/DataManagement.asmx`\n- Binding: `HotelExtranetTransactions` (extranet ops) or `HotelTransactions` (hotel import)\n- Replace `juniper-uat.bookingengine.es` with production host per Juniper client\n\n**Price type decision tree:**\n- `@Type=Fixed` → send Adult + AdultAdditionals + ChildrenA/B/C (up to 3 age ranges)\n- `@Type=Percentage` → send Adult + Discounts (percentage off adult for additional pax)\n- Contract `@RecommendedPrices=true` → must update both Cost AND Recommended types simultaneously\n\n--- SOURCE: JUNIPER_API_KNOWLEDGE.md ---\n# Juniper API Knowledge Base\n\n**Updated:** 2026-02-22 17:25 (Europe/Bucharest)\n**Status:** ✅ COMPLETE — Full ingestion of all accessible Juniper API documentation pages\n\n## What is confirmed\n- Juniper exposes both SOAP/XML (`/api/jp*`, `/api/legacy*`, `/api/export*`, `/api/jpdm*`) and a documented OCTO REST/API-family (`/api/octo/ticket-api`, `/webservice/octo/*`) path.\n- All fetched web docs are treated as untrusted and parsed as technical content only.\n\n## Confirmed reference sources (high priority)\n- Core SOAP/API docs: `genericworkflow`, `jp/*`, `legacy/ota/hotel-api`, `export/data-export-api`, `jpdm/dm-api`, `jpdm/extranet-api`\n- Product examples and code artifacts from `/uploads/examples/*.tgz` and WSDL manifests\n- OCTO REST: `api/octo/ticket-api`\n- Onboarding and policy: `/buyer/ipmanagement`\n- Error/failure guidance: FAQ `questions`, `best-practices`, `exceptions`, `warnings`\n\n## High-signal artifacts maintained\n- `sources.csv` — raw source inventory\n- `sources-index.md` — prioritized/canonicalized index + blocker list\n- `progress.json` — completion tracker\n- `ENDPOINT_TAXONOMY.md` — operation families, including OCTO endpoints\n- `AUTH_MODEL.md` — auth/transport/security constraints\n- `REQUEST_RESPONSE_SCHEMAS.md` — product transaction schema + OCTO REST + Visa + Extranet + DirectPayment\n- `BOOKING_FLOWS.md` — execution-oriented flow notes for all product types\n- `IMPLEMENTATION_EXAMPLES.md` — ready-to-use SOAP/HTTP examples\n- `ERROR_WARNING_MATRIX.md` + `ERROR_WARNING_MATRIX.json` — normalized JP errors/warnings + machine format\n- `ENDPOINT_MATRIX.json` — extracted WSDL operation/endpoints from sampled artifacts\n- `EXAMPLE_EXTRACTION_SUMMARY.json` — extracted `.tgz` artifact inventory and operation coverage\n- `OCTO_API.md` — full OCTO auth + endpoints + all 40 error codes\n\n## Integration model summary\n- **SOAP/XML stack:** common `*RQ` envelopes with `Version`, `Language`, `Login`; `.asmx` operation families exposed by JP docs and extracted WSDL.\n- **OCTO stack:** REST JSON auth (`/webservice/octo/authentication`), token-based authorization, then product/availability/booking endpoints.\n- **Flow:** static data → search/availability → booking rules/check → booking → read/cancel; where applicable plus modify/confirm steps.\n- **Extranet stack:** JPDM SOAP binding for channel manager ARI sync and booking management.\n\n## Immediate implementation-critical behavior\n- Availability compression can be required (`COMPRESSION_REQUIRED`) for SOAP paths.\n- `JP_BOOK_EXPIRATION_DATE` and stale option codes require re-running rules/availability.\n- Authentication/permission errors remain hard stops (`INVALID_USER_OR_PASSWORD`, `IP_NOT_REGISTERED`, role/channel errors).\n- Direct payment supplements (`@DirectPayment=true`) must be surfaced to end-users as not included in total price.\n- OCTO token expires in 3600 seconds (60 min); re-authenticate on `UNAUTHORIZED`.\n\n## Final knowledge coverage (updated 2026-02-22 17:25)\n- Total sources discovered: 86\n- Sources covered: 84+ (confirmed accessible)\n- Known permanent 404s: `/api/jp/transportbooking`, `/api/jp/transportticketing`, `/api/jp/activities-api`, `/api/jp-webservice/faq` (do not retry)\n- Known permanent 403s: `/api/jp/hotel-inventory-api`, `/juniper/octo` (internal use only)\n\n## Permanent reference facts (do not change)\n- WSDL URL pattern: `https://xml-uat.bookingengine.es/WebService/JP/WebServiceJP.asmx?WSDL`\n- JPDM URL: `https://juniper-uat.bookingengine.es/WebServiceJPDM/DataManagement.asmx`\n- Export API base: `https://juniper-uat.bookingengine.es/wsExportacion/`\n  - `wsCustomers.asmx`, `wsSuppliers.asmx`, `wsInvoices.asmx`, `wsBookings.asmx`, `wsProductGroups.asmx`, `wsGeneric.asmx`\n- OCTO auth endpoint: `https://xml-uat.bookingengine.es/webservice/octo/authentication`\n- OCTO products: `https://xml-uat.bookingengine.es/webservice/octo/products`\n- OCTO availability: `https://xml-uat.bookingengine.es/webservice/octo/availability`\n- OCTO bookings: `https://xml-uat.bookingengine.es/webservice/octo/bookings`\n- Total WSDL operations confirmed in extracted WSDLs: 89\n\n## Knowledge coverage (final)\n\n| Domain | Status | Notes |\n|--------|--------|-------|\n| Authentication & transport | ✅ COMPLETE | Login, IP allowlist, account types, OCTO OAuth, compression |\n| Hotel API | ✅ COMPLETE | All transactions, modify flow, Disney specifics, inventory hints |\n| Transfer API | ✅ COMPLETE | All transactions, HotelService schema, optional elements |\n| Car/Rentacar API | ✅ COMPLETE | All transactions, CarSupplements/CarFees schema |\n| Flight API | ✅ COMPLETE | All transactions including FlightTicketing, SeatingMap schema |\n| Ticket/Service API | ✅ COMPLETE | All transactions, OCTO integration path |\n| Cruise API | ✅ COMPLETE | Iterative BookingRules flow, CruiseItinerary schema |\n| Insurance API | ✅ COMPLETE | Flow overview, code samples referenced |\n| Visa API | ✅ COMPLETE | Full flow + VisaCatalogueData/Portfolio/Avail/BookingRules/Book schemas |\n| Package API | ✅ COMPLETE | Transaction list, Stays schema, nested product types, PackageChangeProduct flow |\n| Payment API | ✅ COMPLETE | Full anti-fraud + payment flow with XML examples |\n| Transport API | ✅ COMPLETE | All transactions including ticketing + booking rules |\n| Hotel PUSH API | ✅ COMPLETE | Hotel PUSH notification operation set |\n| Export API | ✅ COMPLETE | 6 endpoint groups, ERP integration flow |\n| JPDM API | ✅ COMPLETE | 12 binding groups, endpoint, generic types |\n| Hotel Extranet API | ✅ COMPLETE | ARI Update, Booking Mgmt, Hotel Import; Rate schema with Fixed/Percentage types |\n| OCTO API | ✅ COMPLETE | Full auth + all 8 endpoints + 40 error codes + product/avail/booking JSON schemas |\n| Direct Payment Taxes | ✅ COMPLETE | California law compliance guidance for JP Hotel API and OTA Hotel API |\n| Error/warning matrix | ✅ COMPLETE | All codes from exceptions + warnings pages |\n| Best practices | ✅ COMPLETE | All 4 practices with implementation examples |\n| Booking flows | ✅ COMPLETE | All product flows including payment, cruise iterative, flight ticketing, visa, extranet |\n| Change log | ✅ COMPLETE | Recent changes captured in CHANGELOG_NOTES.md |\n\n--- SOURCE: REQUEST_RESPONSE_SCHEMAS.md ---\n# Juniper Request/Response Schemas (operational summary)\n\n## 1) Canonical request envelope pattern (SOAP XML)\nAcross JP docs and examples, request bodies follow this pattern:\n\n```xml\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <soapenv:Header/>\n  <soapenv:Body>\n    <OperationName>\n      <OperationNameRQ Version=\"x.y\" Language=\"en\">\n        <Login Email=\"...\" Password=\"...\"/>\n        <!-- operation payload -->\n      </OperationNameRQ>\n    </OperationName>\n  </soapenv:Body>\n</soapenv:Envelope>\n```\n\nNotes:\n- Wrapper names vary (`HotelAvailRQ`, `FlightBookingRQ`, etc.) but all requests are envelope + RQ.\n- `Version` and `Language` are highly consistent across JP operations.\n- `Accept-Encoding: gzip,deflate` is explicitly required on availability requests in some integrations (`COMPRESSION_REQUIRED` otherwise).\n\n## 2) Canonical response wrapper pattern\nResponses commonly use:\n\n```xml\n<OperationNameRS>\n  <TransactionID>...</TransactionID>\n  <TransactionStatus>...</TransactionStatus>\n  <ErrorList>\n    <Error Type=\"...\"><Code>...</Code><Description>...</Description></ErrorList>\n  </ErrorList>\n  <Warnings>\n    <Warning Code=\"warnPriceChanged\">...</Warning>\n  </Warnings>\n  <...operation payload.../>\n</OperationNameRS>\n```\n\nObserved common sections:\n- `ResultCode` and/or `Status` on rule/booking paths.\n- `SearchCode`, `RatePlanCode`, `OptionCode`, and booking `Locator`-style references.\n- `TimeStamp`, `Url`, `IntCode` metadata on catalog/content responses.\n\n## 3) Product schema fingerprints (now mapped from high-signal pages)\n\n### Ticket / Service (`Service*`)\n- **Static data:** `ServiceCatalogueDataRQ` (`Login`) → `CatalogueDataRS` with `ServiceStaticData` including `ServiceCategoryList`, `ServiceTypeList`.\n- **Portfolio:** `ServicePortfolioRQ` (supports `Page`, `RecordsPerPage`) → `ServicePortfolioRS` with `Service` entries and paging attrs.\n- **Content:** `ServiceContentRQ` with `ServiceContentList` of `Service Code` -> `ContentRS`.\n- **Availability:** `ServiceAvailRQ` has mandatory search nodes:\n  - `Paxes` (IdPax + Age)\n  - `ServiceRequest/SearchSegmentsServices` with `Start`, `End`, `DestinationZone` OR service `Code`\n  - optional `Type`, `Class`, `Suppliers`, `AdditionalRequiredFields`\n- **Booking:** `ServiceBookingRulesRQ` must be called before `ServiceBookingRQ` and yields `BookingCode` + required fields.\n- **Read/Cancel:** `ReadBookingRQ` and `CancelBookingRQ` use locator + optional element references.\n\n### Transfer (`Transfer*`)\n- **Availability:** `TransferAvailRQ` with search/segment + pax + paxes distribution, usually supports by hotel (`TransferAvailByHotel`).\n- **Rules:** `TransferBookingRulesRQ` before booking, returns booking constraints + required fields.\n- **Booking:** `TransferBookingRQ` requires `SearchCode`, `OptionCode`, required fields, holder/pax.\n- **Lifecycle:** read/cancel/modify endpoints mirror hotel style.\n\n### Hotel (`Hotel*`)\n- **Availability:** `HotelAvailRQ` includes `Paxes`, `SearchSegmentsHotels`, filters (`HotelCodes` / zone) and distribution.\n- **Rules:** `HotelBookingRulesRQ` produces `BookingCode` and `RatePlanCode` used in `HotelBookingRQ`.\n- **Reservation:** `ReadBooking`, `CancelBooking`, `HotelModify`, `HotelConfirmModify`.\n\n### Flight (`Flight*`)\n- **Availability:** `FlightAvailRQ` route/date/fare oriented request object.\n- **Rules/booking:** `FlightBookingRulesRQ` then `FlightBookingRQ`, separate `FlightTicketing` step.\n\n### Car (`Rentacar*`) and Package (`Package*`)\n- Same pattern: `RentacarAvail` + `RentacarBookingRules` + `RentacarBooking`;\n- Package commonly uses `PackageSearcher`/`PackageAvail` and explicit composition changes via `PackageChangeProduct`.\n\n## 4) Cross-cutting field map\n- **Auth envelope:** `Login@Email`, `Login@Password`\n- **Flow tokens:** `SearchCode`, `RatePlanCode`, `OptionCode`, `BookingCode`\n- **Reference fields:** `Locator`, `ReservationId`, `ElementId`, `AccommodationId`, holder/reference IDs as supplied by rules/response.\n- **Pricing/validation:** `ExpectedPrice` / prepaid flags, sometimes mandatory.\n- **Booking details:** holder info, `RelPaxesDist`, `Paxes`, and product-specific add-ons (supplements/offers/meeting points etc.).\n\n## 5) Error-response behavior to normalize\n- Validate and branch on `ErrorList` first; examples show many strict schema checks (`*_NOT_FOUND`, `*_EXPECTED`, `JP_*` validation failures).\n- Warnings are non-fatal signals you should preserve and act on:\n  - `warnPriceChanged`, `warnFlightInfoChanged`, `warnModify*`, `warnRequestDate`, `warnReqPractices`, `warnOverwriteParameter`.\n- If `JP_BOOK_EXPIRATION_DATE` / stale code appears, refresh availability+rules before retrying booking.\n\n\n## 6) OCTO REST pattern (ticket API)\n\nOAuth + JSON flow:\n\n```text\n1) POST /webservice/octo/authentication\n   {\n  \"client_id\": \"...\",\n  \"client_secret\": \"...\",\n  \"grant_type\": \"client_credentials\"\n }\n\n2) GET /webservice/octo/products?destinationID={id}\n3) GET /webservice/octo/products/{productId}\n4) POST /webservice/octo/availability/calendar\n5) POST /webservice/octo/availability\n6) POST /webservice/octo/bookings\n7) GET /webservice/octo/bookings/{bookingId}\n8) POST /webservice/octo/bookings/{bookingId}/cancel\n```\n\nCommon transport details:\n- `Content-Type: application/json`\n- `Authorization: Bearer {access_token}`\n- `Host: xml-uat.bookingengine.es` (docs example)\n\nCross-field note:\n- OCTO uses `resellerReference`, `bookingId`, `units[]`, and passenger/contact arrays in payload examples.\n\n\n### Transport (`Transport*`)\n- **Availability:** `TransportAvailRQ` with `SearchSegmentsTransport`-style route details and passenger/cabin context.\n- **Revalidation:** `TransportCheckAvailRQ` optionally rechecks selected option before final booking.\n- **Rules:** `TransportBookingRulesRQ` for required fields/price lock.\n- **Booking:** `TransportBookingRQ` -> locator lifecycle + optional post-booking ticketing step `TransportTicketingRQ` in sequence.\n- **Lifecycle:** `ReadBookingRQ` + `CancelBookingRQ`.\n\n### Hotel PUSH API notifications (`JP_Hotel*NotifRQ`)\n- Push family is not classic request/response search/book flow; it's outbound data synchronization to Juniper:\n  - `JP_HotelInvNotifRQ`\n  - `JP_HotelAvailNotifRQ`\n  - `JP_HotelRatePlanNotifRQ`\n- Typical message envelopes carry inventory/availability/plan deltas with nested objects:\n  - rates/taxes/penalties/supplements/offers/restrictions\n  - contract IDs and identifiers for contract-to-offer linkage\n- Treat as asynchronous ingestion pipeline; schema validation should be strict and idempotent (same locator/version may repeat).\n\n### Direct payment taxes / destination-fee classification\n- Payment/tax classification appears across Hotel + OTA docs (`Direct Payment Fees and Taxes` page).\n- Keep explicit policy mapping for \"paid at destination\" vs \"prepaid\" to route cost logic.\n\n---\n\n## NEW SCHEMAS (added 2026-02-22)\n\n### Flight Segment Schema `{Routes}`\n\n```\nRoutes\n└── Route[@Origin, @Destination]\n    └── Segments\n        └── Segment[@Order, @Stops, @DepartureAirport, @ArrivalAirport]\n                    [@DepartureDate, @ArrivalDate]\n                    [@OperatingAirline, @MarketingAirline, @FlightNumber]\n                    [@JourneyDuration (P0DT7H50M0S), @GroundDuration]\n                    [@Class, @Cabin (F/C/B/Y/P/J/S), @AirplaneType, @FareBasis]\n                    [@VendorLocator]\n            ├── Equipments / Equipment[@Type]\n            ├── TechnicalStops / TechnicalStop[@AirportCode, @ArrivalDate, @DepartureDate]\n            └── SeatingMap (only in FlightBookingRules response)\n                ├── SeatEquipments   ← available seats with characteristics\n                └── SeatGroups       ← seat groups with pricing\n```\n\n**Cabin codes (GDS):** F=First, C/B=Business, Y=Economy, P=PremiumFirst, J=PremiumBusiness, S=PremiumEconomy. Non-standard codes possible.\n\n### Car Supplement Schema `{AdditionalElements}`\n\n```\nAdditionalElements\n├── CarSupplements\n│   └── CarSupplement\n│       @Code, @PriceType (1=PerDay|3=PerBooking)\n│       @Units, @UntMin, @UntMax\n│       @PaymentOffice (yes=pay at destination)\n│       @Status (OK|RQ)\n│       @Amount, @Currency\n│       @RatePlanCode (for optional supplements → use in RentacarBookingRules)\n│       Name, Description\n└── CarFees\n    └── (similar structure to supplements)\n```\n\n### Transfer `{HotelService}` Object (optional transfer hotel info)\n\n```\nHotelService\n  @Code           ← hotel code (numerical; directly contracted only)\n  @Name           ← hotel name (auto-set if Code provided)\n  @Block          ← hotel address number\n  @Board          ← board code\n  @CheckoutDate\n  └── Room\n      @Code, @Name, @Number\n```\n\n### Transfer `{OptionalElements}` Object\n\n```\nOptionalElements\n└── Comments\n    └── Comment[@Type]\n        ← Type=\"TRF\" = comments from provider\n        ← May contain critical info (service unavailability, additional taxes)\n```\n\n### Payment API Schemas\n\n#### CheckPaymentRequiredFieldsRS\n\n```\nCheckPaymentRequiredFieldsRS[@Url, @TimeStamp, @IntCode]\n  └── RequiredFieldsResponse\n      └── Fields\n          └── Field[@Type (String|Integer|Decimal|Datetime|Boolean|Enum), @Mandatory]\n              ├── Name\n              └── Values (if Enum)\n                  └── Value[@Code]\n```\n\n#### CheckPaymentRQ\n\n```\nCheckPaymentRQ[@Version, @Language]\n  ├── Login[@Email, @Password]\n  └── Request[@ReservationLocator]\n      └── Fields\n          └── Field\n              ├── Name\n              └── Value\n```\n\n#### CheckPaymentRS\n\n```\nCheckPaymentRS[@Url, @TimeStamp, @IntCode]\n  └── Response[@Score, @IsFraud, @Status]\n      └── Token   ← use in PaymentBooking request\n```\n\n**Status values:** `VALID` = proceed. Scores near 100 = high fraud risk.\n\n### CruiseItineraryRQ\n\n```\nCruiseItineraryRQ[@Version, @Language]\n  └── CruiseItineraryRequest\n      └── SearchSegmentsItinerary\n          └── SearchSegmentItinerary\n              @ShipCode, @Zone, @CruiseCode, @ItineraryCode\n              @Start (yyyy-MM-dd), @End (yyyy-MM-dd)\n              @Duration (LessThan7Days|Between7And8Days|Between9And12Days|MoreThan12Days)\n              └── CountryOfResidence\n```\n\n### Generic Data Types Reference\n\n| Format | Type | Description |\n|---|---|---|\n| `[Text]` | String | Any char/number (NVarchar) |\n| `n[0..9]` | Integer | 1..N digits |\n| `n[0..9],2[0..9]` | Double | Decimal with dot separator, 2 decimal places |\n| `true/false` | Boolean | Boolean |\n| `yyyy-MM-ddThh:mm:ss` | DateTime | ISO 8601 datetime |\n| `hh:mm:ss` | Time | Time only |\n| `yyyy-MM-dd` | Date | Date only |\n| `PnYnMnDTnHnMnS` | Duration | ISO 8601 duration (e.g. `P0DT7H50M0S`) |\n\n### DM API Paxes Schema\n\n```\nPaxes\n└── Pax[@IdPax]\n    ├── Title (Mr|Mrs)\n    ├── Name, Surname\n    ├── Age (null=adult=30yrs default; >18=adult)\n    ├── Email\n    ├── Document[@Type (PAS|NIF|NIE|DNI|CIF)]\n    ├── PhoneNumbers / PhoneNumber\n    ├── BornDate (yyyy-MM-dd)\n    ├── Address, City, Country, PostalCode\n    └── Nationality\n```\n\n### JPDM API Endpoint\n\n```\nBase (UAT): https://juniper-uat.bookingengine.es/WebServiceJPDM/DataManagement.asmx\nWSDL:       https://juniper-uat.bookingengine.es/WebServiceJPDM/DataManagement.asmx?WSDL\n\nBinding groups:\n- AccountingTransactions  ← accounting module required\n- BookTransactions\n- CustomerTransactions\n- GenericTransactions\n- HotelTransactions       ← accommodation module required\n- HotelExtranetTransactions ← accommodation + extranet modules required\n- ServiceTransactions\n- TransferTransactions\n- TemplateTransactions\n- ProductTransactions\n- UserTransactions\n- GroundHandlingTransactions\n```\n\n\n---\n\n### Package API `{Stays}` Schema\n\nThe Package `Stays` object is the key package composition structure:\n\n```\nStays\n└── Stay[@Code, @DestinationZone, @Start (yyyy-MM-dd), @End (yyyy-MM-dd)]\n    ├── {Hotels}\n    │   └── Hotel[@Code, @JPCode, @Start, @End, @ICode (encrypted)]\n    ├── {Flights}\n    ├── {Transfers}\n    ├── {Services}  ← tickets\n    ├── {Packages}  ← can nest packages within packages (dynamic packages)\n    ├── {Insurances}\n    └── {Rentacars}\n```\n\n**Key note:** Dynamic packages can contain enclosed packages within their configuration. This allows bundling of multiple product types.\n\n### Package code samples\n- `/uploads/examples/dyn-nodejs.tgz` — dynamic package Node.js\n- `/uploads/examples/dyn-java.tgz` — dynamic package Java\n- `/uploads/examples/pkg-csharp.tgz` — package C#\n- `/uploads/examples/dyn-ruby.tgz` — dynamic package Ruby\n- Postman collection: `19143470-95002150-0819-4dae-9f4f-6033c5c97e55`\n\n### OTA Hotel API — key operations\n\n| OTA Operation | JP Equivalent | Purpose |\n|---|---|---|\n| `OTA_HotelAvail` | `HotelAvail` | Availability search |\n| `OTA_HotelBookingRule` | `HotelBookingRules` | Pre-booking validation |\n| `OTA_HotelRes` | `HotelBooking` | Create booking |\n| `OTA_Read` | `ReadBooking` | Read booking |\n| `OTA_Cancel` | `CancelBooking` | Cancel booking |\n| `OTA_HotelResModify` | `HotelModify` | Modify booking |\n| `OTA_HotelDescriptiveInfo` | `HotelContent` | Hotel static info |\n| `JP_CatalogueData` | `HotelCatalogueData` | General static data |\n| `JP_RoomTypeList` | `RoomList` | Room types |\n| `JP_ZoneList` | `ZoneList` | Destinations |\n| `JP_HotelList` | `HotelList` | Hotel list |\n\n**OTA TimeOut best practice:**\n```xml\n<TPA_Extensions>\n  <SearchTimeOut>8000</SearchTimeOut>\n</TPA_Extensions>\n```\nWithin `HotelSearchCriteria/Criterion` (equivalent to AdvancedOptions/TimeOut in JP API).\n\n---\n\n## 9) Visa API Schemas\n\n### VisaCatalogueData (static data retrieval)\n\n**Request:**\n```xml\n<VisaCatalogueData>\n  <VisaCatalogueDataRQ Version=\"1.1\" Language=\"en\">\n    <Login Email=\"user@mydomain.com\" Password=\"pass\"/>\n  </VisaCatalogueDataRQ>\n</VisaCatalogueData>\n```\n\n**Response:**\n```xml\n<CatalogueDataRS Url=\"http://xml-uat.bookingengine.es\" TimeStamp=\"...\" IntCode=\"...\">\n  <VisaStaticData>\n    <VisaTypeList>\n      <ServiceType Code=\"38\"><Name>Visados</Name></ServiceType>\n      <ServiceType Code=\"44\" ParentCode=\"38\"><Name>Visados hijo2</Name></ServiceType>\n    </VisaTypeList>\n  </VisaStaticData>\n</CatalogueDataRS>\n```\n\nKey attributes: `ServiceType/@Code`, `ServiceType/@ParentCode`, `ServiceType/Name`\n\n### VisaPortfolio (paginated portfolio)\n\n**Request:**\n```xml\n<VisaPortfolioRQ Version=\"1.1\" Language=\"en\" Page=\"1\" RecordsPerPage=\"100\">\n  <Login Password=\"Password\" Email=\"username@mydomain.com\"/>\n</VisaPortfolioRQ>\n```\n- Paginate: increment `@Page` until `Page == TotalPages`\n\n**Response key fields:**\n- `ServicePortfolio/@Page`, `@RecordsPerPage`, `@TotalPages`, `@TotalRecords`\n- `Service/@Code` (base64), `@IntCode`, `@ServiceTypeCode`, `@ProductGroup`, `@ProductType`\n- `Options/ServiceOption/@Code`, `@Order`, `@NumberOfDays`, `Name`\n- `Zones/Zone/@Code`, `Origins/Origin/@Code`, `Destinations/Destination/@Code`\n- `Contracts/Contract/@Type` (C=Cost/S=Sales), `@Code`, `@AllowZeroCost`\n\n### VisaAvail (availability search)\n\n**Request:**\n```xml\n<VisaAvailRQ Version=\"1.1\" Language=\"es\">\n  <Login Password=\"pass\" Email=\"user@mydomain.com\"/>\n  <Paxes>\n    <Pax IdPax=\"1\"><Age>30</Age></Pax>\n  </Paxes>\n  <VisaRequest>\n    <SearchSegmentsVisa>\n      <SearchSegmenVisa Start=\"2019-09-19\" End=\"2019-09-19\" DestinationZone=\"17852\"/>\n    </SearchSegmentsVisa>\n    <RelPaxesDist>\n      <RelPaxDist>\n        <RelPaxes><RelPax IdPax=\"1\"/></RelPaxes>\n      </RelPaxDist>\n    </RelPaxesDist>\n  </VisaRequest>\n</VisaAvailRQ>\n```\n- `DestinationZone` from `ZoneList` (ProductType=VIS)\n- Pax `Age` is mandatory\n\n### Visa flow sequence\n1. `ZoneList` (ProductType=VIS) → destination codes\n2. `VisaCatalogueData` → visa type classification\n3. `VisaPortfolio` → paginated visa catalog (paginate @Page until TotalPages)\n4. `VisaAvail` → search results for date+destination+paxes\n5. `VisaCheckAvail` (optional) → re-validate price/availability\n6. `VisaBookingRules` (mandatory) → get `BookingCode`, cancellation policies, `VisaRequiredFields`\n7. `VisaBook` → confirm booking → get `@Locator`\n8. `ReadBooking` / `CancelBooking` → post-booking lifecycle\n\nStatic data max download frequency: **2 weeks** (mandatory constraint for data freshness).\n\n---\n\n## 10) Hotel Extranet API Schemas (JPDM)\n\n### Endpoint\n- WSDL: `https://juniper-uat.bookingengine.es/WebServiceJPDM/DataManagement.asmx?WSDL`\n- Binding for Hotel Extranet: **HotelExtranetTransactions**\n- Binding for Hotel Import: **HotelTransactions**\n\n### Three main processes\n1. **ARI Update** — sync rate/allotment/restriction data to Juniper system\n   - Optional: `ExtranetHotelRates` (retrieve rates for mapping/verification)\n   - Core: rate update transactions (see Rate schema below)\n2. **Booking Management** — periodic polling for booking changes\n   - `ExtranetReadBooking` — retrieve all bookings created/modified/cancelled since last call\n   - `ExtranetUpdateBooking` — update Hotel Confirmation Number (if permitted)\n3. **Hotel Import** — import hotel products into Juniper client system\n   - Requires specific Juniper client permissions\n\n### Rate complex type `{Rate}` (JP_HotelRate)\n\n| Node/Attribute | Opt | Type | Description |\n|----------------|-----|------|-------------|\n| @Type | N | String | Fixed or Percentage |\n| Dates/Date/@From | N | Date | Rate start date |\n| Dates/Date/@To | N | Date | Rate end date |\n| Prices/Price/@RoomTypeCode | N | Integer | Room type code |\n| Prices/Price/@BoardCode | N | Integer | Board code |\n| Prices/Price/@Type | N | String | Cost or Recommended |\n| Price/Room/@Amount | N | Double | Room total (price-per-room only) |\n| Price/Adult/@Amount | N | Double | Per-adult price |\n| Price/AdultAdditionals/AdultAdditional/@Amount | N | Double | Additional adult price |\n| Price/AdultAdditional/@Order | N | Integer | 1=first, 2=second+ additional |\n| Price/ChildrenA-C/Child*/@Amount | N | Double | Child price by age range A/B/C |\n| Discounts (Percentage rates only) | Y | - | Percentage discounts for additional pax |\n\n**To delete prices:** send empty `Price` node with @RoomTypeCode, @BoardCode, @Type.\n**Note:** Rate supplements must be sent alongside rate prices; omitting them deletes existing supplements.\n\n### Extranet generic complex types\n- `{Rate}` — rate prices\n- `{Allotment}` — room allotment\n- `{StopSale}` — stop sale flag\n- `{Release}` — release period\n- `{Restriction}` — booking restrictions\n- `{Supplement}` — supplements (e.g. BoardSupplement)\n- `{Offer}` — offers/promotions\n- `{SpecialNotes}` — special notes\n- `{AccessConditions}` — access conditions\n\n### Price type guidance\n- **Fixed** rates: Adult/AdditionalAdults/ChildrenA/B/C prices\n- **Percentage** rates: Adult price + Discounts node for additional pax\n- Send both Cost AND Recommended when contract has `@RecommendedPrices=true`\n\n### Code samples\n- `/uploads/examples/xtra-csharp.tgz` — C# extranet example\n- SoapUI welcome pack: `/uploads/welcome-pack/juniper-webservice-hotels-jpdm-extranet-welcome-pack.zip`\n\n---\n\n## 11) Direct Payment Taxes/Fees (California Law Compliance)\n\n> Source: `/api/jp/directpaymenttaxes` — Implementation guidance for California Resort Fee Bill (AB 537) and Consumer Legal Remedies Act (SB 478).\n\n### JP Hotel API (HotelAvail response)\nDirect payment supplements appear in `AdditionalElements/HotelSupplements`:\n\n```xml\n<HotelSupplement Code=\"1\" DirectPayment=\"true\" Amount=\"4.73\" Currency=\"EUR\">\n  <Name>Mandatory Tax</Name>\n  <Description>Payment at destination</Description>\n</HotelSupplement>\n```\n\n- `@DirectPayment=\"true\"` → must be paid at destination, NOT included in total price\n- Always display `@Amount`, `@Currency`, `Name`, `Description` to end user\n\n### OTA Hotel API (HotelAvail response)\n\n**With `ShowCatalogueData` TPA_Extension:**\n```xml\n<Elements>\n  <Element Class=\"DIRECT_PAYMENT\" Price=\"4.73\" PriceWithTax=\"\" Currency=\"EUR\">\n    <Name>Mandatory Tax</Name>\n    <Description>Payment at destination</Description>\n  </Element>\n</Elements>\n```\nFound within `TPA_Extensions` of `RoomRate`.\n\n**Without `ShowCatalogueData` (legacy format):**\n```xml\n<Features>\n  <Feature RoomViewCode=\"DIRECT_PAYMENT\">\n    <Description Name=\"VALUE\"><Text>Mandatory Tax</Text></Description>\n    <Description Name=\"DESC\"><Text>Payment at destination</Text></Description>\n    <Description Name=\"PRICE\"><Text>4.73</Text></Description>\n    <Description Name=\"CURRENCY\"><Text>EUR</Text></Description>\n  </Feature>\n</Features>\n```\n\n**Implementation rule:** `ShowCatalogueData` TPA_Extension is strongly recommended for OTA API to get structured `Elements` format.\n\n--- SOURCE: IMPLEMENTATION_EXAMPLES.md ---\n# Juniper Implementation-Ready Examples\n\n## 1) Shared SOAP request envelope\n\n```xml\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <soapenv:Header/>\n  <soapenv:Body>\n    <OperationName>\n      <OperationNameRQ Version=\"1.1\" Language=\"en\">\n        <Login Email=\"user@acme.example\" Password=\"${JUNIPER_PASSWORD}\"/>\n        <!-- operation payload -->\n      </OperationNameRQ>\n    </OperationName>\n  </soapenv:Body>\n</soapenv:Envelope>\n```\n\n## 2) HTTP headers and endpoint pattern\n\n- Base endpoint style (docs): `https://xml-uat.bookingengine.es/WebService/JP/WebServiceJP.asmx`\n- WSDL: `.../WebServiceJP.asmx?WSDL`\n- Required/requested headers:\n  - `Content-Type: text/xml; charset=utf-8`\n  - `SOAPAction: \"http://www.juniper.es/webservice/2007/OperationName\"`\n  - `Accept-Encoding: gzip,deflate` (for availability calls in some setups)\n\n## 3) Hotel availability request skeleton\n\n```xml\n<HotelAvail xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <HotelAvailRQ Version=\"1.1\" Language=\"en\">\n    <Login Email=\"${EMAIL}\" Password=\"${PASS}\"/>\n    <Paxes>\n      <Pax IdPax=\"1\"><Age>30</Age></Pax>\n    </Paxes>\n    <HotelRequest>\n      <SearchSegmentsHotels>\n        <SearchSegmentHotels Start=\"2026-03-01\" End=\"2026-03-03\"/>\n      </SearchSegmentsHotels>\n      <RelPaxesDist>\n        <PaxesDistribution IdPax=\"1\" Distribution=\"1\"/>\n      </RelPaxesDist>\n    </HotelRequest>\n  </HotelAvailRQ>\n</HotelAvail>\n```\n\n## 4) Service availability + rules + booking skeleton (from ticket docs)\n\n```xml\n<ServiceAvail xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <ServiceAvailRQ Version=\"1.1\" Language=\"en\">\n    <Login Email=\"${EMAIL}\" Password=\"${PASS}\"/>\n    <Paxes>\n      <Pax IdPax=\"1\"><Age>35</Age></Pax>\n    </Paxes>\n    <ServiceRequest>\n      <SearchSegmentsServices Start=\"2026-03-10\" End=\"2026-03-11\" DestinationZone=\"070033\" Type=\"3\" Class=\"5\"/>\n    </ServiceRequest>\n  </ServiceAvailRQ>\n</ServiceAvail>\n\n<ServiceBookingRules>\n  <ServiceBookingRulesRQ Version=\"1.1\" Language=\"en\">\n    <Login Email=\"${EMAIL}\" Password=\"${PASS}\"/>\n    <ServiceBookingRule>\n      <!-- booking code + selected option context from prior response -->\n      <SearchCode>...</SearchCode>\n    </ServiceBookingRule>\n  </ServiceBookingRulesRQ>\n</ServiceBookingRules>\n\n<ServiceBooking>\n  <ServiceBookingRQ Version=\"1.1\" Language=\"en\">\n    <Login Email=\"${EMAIL}\" Password=\"${PASS}\"/>\n    <SearchCode>...</SearchCode>\n    <RatePlanCode>...</RatePlanCode>\n    <OptionCode>...</OptionCode>\n    <!-- Holder, RelPaxesDist, optional supplements/offers -->\n  </ServiceBookingRQ>\n</ServiceBooking>\n```\n\n## 5) Node.js example (axios + gzip + XML parse)\n\n```js\nimport axios from 'axios';\nimport zlib from 'zlib';\n\nconst endpoint = process.env.JP_ENDPOINT || 'https://xml-uat.bookingengine.es/WebService/JP/WebServiceJP.asmx';\nconst soapAction = '\"http://www.juniper.es/webservice/2007/HotelAvail\"';\n\nconst xml = fs.readFileSync('./payload.xml', 'utf8');\n\nconst res = await axios.post(endpoint, xml, {\n  headers: {\n    'Content-Type': 'text/xml; charset=utf-8',\n    'SOAPAction': soapAction,\n    'Accept-Encoding': 'gzip,deflate',\n  },\n  decompress: true,\n  timeout: 30000,\n});\n\nconst xmlOut = res.data; // axios decodes gzip when supported\n// parse xmlOut to capture ErrorList/Warnings/locator fields\n```\n\n## 6) Python snippet\n\n```python\nimport requests\nurl = \"https://xml-uat.bookingengine.es/WebService/JP/WebServiceJP.asmx\"\nxml = open('payload.xml','rb').read()\nheaders = {\n    'Content-Type': 'text/xml; charset=utf-8',\n    'SOAPAction': '\"http://www.juniper.es/webservice/2007/HotelAvail\"',\n    'Accept-Encoding': 'gzip,deflate'\n}\nr = requests.post(url, data=xml, headers=headers, timeout=30)\nr.raise_for_status()\n# parse XML: TransactionID, ErrorList, Warnings, BookingCode, Locator\n```\n\n## 7) Error/ warning control template\n\n```pseudo\nif response contains ErrorList:\n  classify by code prefix JP_*/REQ_*/NO_*\n  if hard_error: abort transaction and return normalized failure\n  if retryable_transport_or_quota: apply bounded backoff\nif response contains warning:\n  persist warning code + payload\n  if warning in [warnPriceChanged,warnFlightInfoChanged,warnFlightClassChanged]: refresh availability/rules before booking\ncontinue with state transition only when Booking status indicates confirmed\n```\n\n## 8) Security & implementation hygiene\n- Never log raw credentials.\n- Keep secrets in env/secret manager.\n- Use immutable request builders for replay-safe retry logic.\n- Track `TimeStamp`/`IntCode` from response metadata for support handoff.\n\n\n## 9) Transport + Hotel PUSH ingestion tips\n\n### Transport availability + booking sequence\n```text\n1) TransportAvailRQ (search)\n2) TransportCheckAvailRQ (optional)\n3) TransportBookingRulesRQ (required by many suppliers)\n4) TransportBookingRQ\n5) TransportTicketingRQ (when workflow requires explicit ticketing)\n6) ReadBookingRQ / CancelBookingRQ\n```\n\n### Hotel PUSH receiver checklist\n- Use idempotency key for message dedupe (`HotelInvNotif`/`HotelAvailNotif`/`RatePlanNotif`).\n- Validate operation family and nested entity IDs before mutating cache.\n- Keep schema version and payload hash in logs for audit/reconciliation.\n- Surface partial deltas safely and reconcile missing fields before synchronous reads.\n\n---\n\n## 10) Best Practice: TimeOut on HotelAvail\n\nAlways specify a timeout to prevent hangs on large searches:\n\n```xml\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <soapenv:Header/>\n  <soapenv:Body>\n    <HotelAvail>\n      <HotelAvailRQ Language=\"en\" Version=\"1.1\">\n        <Login Email=\"${JUNIPER_EMAIL}\" Password=\"${JUNIPER_PASSWORD}\"/>\n        <Paxes>\n          <Pax IdPax=\"1\" Age=\"30\"/>\n          <Pax IdPax=\"2\" Age=\"30\"/>\n        </Paxes>\n        <HotelRequest>\n          <SearchSegmentsHotels>\n            <SearchSegmentHotels Start=\"2026-04-15\" End=\"2026-04-18\"/>\n            <CountryOfResidence>ES</CountryOfResidence>\n            <HotelCodes>\n              <HotelCode>JP046300</HotelCode>\n              <HotelCode>JP547825</HotelCode>\n            </HotelCodes>\n          </SearchSegmentsHotels>\n          <RelPaxesDist>\n            <RelPaxDist NºUnits=\"1\">\n              <RelPaxes>\n                <RelPax IdPax=\"1\"/>\n                <RelPax IdPax=\"2\"/>\n              </RelPaxes>\n            </RelPaxDist>\n          </RelPaxesDist>\n        </HotelRequest>\n        <AdvancedOptions>\n          <TimeOut>8000</TimeOut>   <!-- milliseconds; mandatory best practice -->\n        </AdvancedOptions>\n      </HotelAvailRQ>\n    </HotelAvail>\n  </soapenv:Body>\n</soapenv:Envelope>\n```\n\n**Key best practices encoded:**\n1. `TimeOut` in `AdvancedOptions` — required for new integrators\n2. `CountryOfResidence` — `PaxCountry` best practice; affects rate availability \n3. Explicit `HotelCodes` list — `HotelCodes` best practice (not destination-based)\n4. Max 500 hotel codes per request\n\n---\n\n## 11) Payment API flow (point-of-sale accounts only)\n\n### Step A: CheckPaymentRequiredFields (discover required anti-fraud fields)\n\n```xml\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <soap:Header/>\n  <soap:Body>\n    <CheckPaymentRequiredField>\n      <CheckPaymentRequiredFieldsRQ Version=\"1.1\" Language=\"en\">\n        <Login Email=\"${JUNIPER_EMAIL}\" Password=\"${JUNIPER_PASSWORD}\"/>\n      </CheckPaymentRequiredFieldsRQ>\n    </CheckPaymentRequiredField>\n  </soap:Body>\n</soap:Envelope>\n```\n\n### Step B: CheckPayment (anti-fraud validation → returns Token)\n\n```xml\n<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns=\"http://www.juniper.es/webservice/2007/\">\n  <soap:Header/>\n  <soap:Body>\n    <CheckPayment>\n      <CheckPaymentRQ Version=\"1.1\" Language=\"en\">\n        <Login Password=\"${JUNIPER_PASSWORD}\" Email=\"${JUNIPER_EMAIL}\"/>\n        <Request ReservationLocator=\"LOCATOR_FROM_BOOKING\">\n          <Fields>\n            <Field><Name>AnalysisLocation</Name><Value>SPA</Value></Field>\n            <Field><Name>Reservation.Date</Name><Value>22/02/2026</Value></Field>\n            <Field><Name>Reservation.TotalValue</Name><Value>504.50</Value></Field>\n            <Field><Name>BillingData.ID</Name><Value>2</Value></Field>\n            <Field><Name>BillingData.Type</Name><Value>1</Value></Field>\n          </Fields>\n        </Request>\n      </CheckPaymentRQ>\n    </CheckPayment>\n  </soap:Body>\n</soap:Envelope>\n```\n\n**Response key fields:**\n- `Response/@Score` — anti-fraud score\n- `Response/@IsFraud` — boolean\n- `Response/@Status` — `VALID` = proceed to payment\n- `Response/Token` — token to include in PaymentBooking request\n\n### Step C: PaymentBooking (actual credit card payment)\n- Provide booking locator + anti-fraud token + card details\n- Successful payment changes booking status from `QUO` (quote) → `PAG` (paid/confirmed)\n\n**Note:** Only required for point-of-sale agency accounts. Credit/pre-payment accounts skip payment entirely.\n\n---\n\n## 12) Cruise API flow skeleton\n\nCruise has a unique multi-step BookingRules cycle for iterative component selection:\n\n```\n1. CruisePreAvail (offline; broad search; 2-adult assumption; returns SelectionCode/RatePlanCode)\n2. CruiseAvail (online; pass SelectionCode from step 1; adjust distribution)\n3. CruiseBookingRules (loop until BookingCode returned):\n   a. First call → returns required components (categories, cabins) with RatePlanCodes\n   b. Pass RatePlanCode of selected component → BookingRules again\n   c. Next layer returned (cabins if category selected, optional supplements if cabin selected)\n   d. Repeat until all mandatory elements selected → BookingCode with ExpirationDate returned\n4. CruiseBook (use BookingCode)\n5. ReadBooking / CancelBooking\n```\n\n### CruiseItinerary request example\n\n```xml\n<CruiseItinerary>\n  <CruiseItineraryRQ Version=\"1.1\" Language=\"es\">\n    <Login Password=\"${JUNIPER_PASSWORD}\" Email=\"${JUNIPER_EMAIL}\"/>\n    <CruiseItineraryRequest>\n      <SearchSegmentsItinerary>\n        <SearchSegmentItinerary \n          ShipCode=\"ZEPT0722\" \n          Zone=\"12345\" \n          CruiseCode=\"ZEPT072205/08/2013PUL\" \n          Start=\"2026-08-01\" \n          End=\"2026-08-10\" \n          Duration=\"Between7And8Days\"\n          ItineraryCode=\"ITT/08/2013PUL\">\n          <CountryOfResidence>ES</CountryOfResidence>\n        </SearchSegmentItinerary>\n      </SearchSegmentsItinerary>\n    </CruiseItineraryRequest>\n  </CruiseItineraryRQ>\n</CruiseItinerary>\n```\n\n**Duration values:** `LessThan7Days`, `Between7And8Days`, `Between9And12Days`, `MoreThan12Days`\n\n---\n\n## 13) Insurance API flow skeleton\n\n```\n1. ZoneList (ProductType=INS) → destination codes\n2. InsuranceAvail → returns available insurance products + RatePlanCodes\n3. InsuranceCheckAvail (optional) → validate price/availability \n4. InsuranceBookingRules (mandatory) → returns BookingCode + InsuranceRequiredFields\n5. InsuranceBooking → returns @Locator\n6. ReadBooking / CancelBooking\n```\n\n---\n\n## 14) Disney products specifics (via Hotel API)\n\nDisney hotels are in the Orlando area (USA). Booking flow uses standard HotelAvail/HotelBookingRules/HotelBooking, but with these critical differences:\n\n### Age ranges (differ per product type):\n**Hotel:** children = 0–17; adults = 18+  \n**Tickets:** babies (no ticket) = 0–3; child ticket = 3–9; adult ticket = 10+\n\n### Search requirements:\n- Must search by explicit HotelCode list (use HotelPortfolio to discover)\n- `ShowBreakdownPrice=true` to see ticket supplement pricing\n- `ShowOnlyBestPriceCombination=true` to get only cheapest option\n\n### Ticket selection at BookingRules step:\n- Default: cheapest ticket pre-selected in availability\n- To change: use `RatePlanCode` from `OptionalElements/HotelSupplements` → send additional `HotelBookingRules` request\n- Each HotelBookingRules with supplement RatePlanCode updates the selected ticket\n\n### Rate identifiers:\n- Rate ID under `HotelRoom/Contracts/Contract/Name`\n- Ticket name under `BrandRating`\n- Dining plans / promotions appear appended to room name text\n\n---\n\n## 15) Export API endpoint groups (ERP integration)\n\n```\nBase (UAT): https://juniper-uat.bookingengine.es/wsExportacion/\n\nEndpoint Groups:\n├── wsCustomers.asmx      ← getCustomerList, addCustomer, modifyCustomer\n├── wsSuppliers.asmx      ← getSupplierList, addSupplier, modifySupplier\n├── wsInvoices.asmx       ← getPurchaseInvoices, getInvoices (needs accounting module)\n├── wsBookings.asmx       ← getBookingList, getBookings\n├── wsProductGroups.asmx  ← product group management\n└── wsGeneric.asmx        ← generic/shared transactions\n```\n\n**Integration flow:**\n1. Synchronize: `getSupplierList` → `getCustomerList` (or push with addSupplier/addCustomer)\n2. Reconcile: `getBookingList` → `getBookings` (cost + sales prices)\n3. Invoice reconcile: `getPurchaseInvoices` (cost) + `getInvoices` (sales) — accounting module required\n4. Payment retrieval: `getSupplierPayments` + `getCustomerPayments`\n\n--- SOURCE: ERROR_WARNING_MATRIX.md ---\n# Juniper API Error & Warning Matrix\n\n> Compiled from /api/faq/exceptions and /api/faq/warnings (live documentation)\n\n---\n\n## PART 1 — ERROR CODES\n\n### 1.1 General / Authentication Errors\n\n| Error Code | Description | Remediation |\n|---|---|---|\n| `UNRECOGNIZED_INTERNAL_ERROR` | Unrecognized internal error | Retry with exponential backoff; escalate to support |\n| `ACCESS_NOT_ALLOWED` | This operation is not allowed | Check permissions/channel with supplier |\n| `COMPRESSION_REQUIRED` | Request compression required (availability only) | Add `Accept-Encoding: gzip,deflate` header |\n| `INVALID_USER_OR_PASSWORD` | Login fails — Invalid user or password | Check credentials; don't retry in a loop |\n| `IP_NOT_REGISTERED` | IP {0} does not have permission | Register IP via Buyer Portal |\n| `CODEBOOK_INCORRECT` | Locator unavailable for credentials | Ensure locator was created with these credentials |\n| `JP_DEVELOPMENT_DEACTIVATED` | Function not available in live environment | Use correct environment endpoint |\n| `PETITION_BLOCKED` | Petition blocked for this user | Contact support |\n| `ADVANCED_OPTION_NOT_ALLOWED` | AdvancedOption not allowed | Contact XML support |\n| `TOO_MANY_REQUEST` | Quota exceeded | Back off, contact supplier for quota increase |\n\n### 1.2 Login / Header Errors\n\n| Error Code | Description |\n|---|---|\n| `JP_HEADER_VERSION` | No version found |\n| `JP_HEADER_LANGUAGE` | No language found |\n| `JP_LOGIN` | Login header missing |\n| `JP_LOGIN_PASSWORD` | Password missing |\n| `JP_LOGIN_EMAIL` | Email missing |\n| `JP_LOGIN_CLIENT` | Client expected |\n\n### 1.3 Availability / Search Errors\n\n| Error Code | Description | Notes |\n|---|---|---|\n| `JP_SEARCH_DESTINATION` | DestinationZone missing | Required for most availability requests |\n| `JP_SEARCH_ORIGIN` | OriginZone missing | Transfer/Transport |\n| `JP_SEARCH_STARTDATE` | StartDate missing | |\n| `JP_SEARCH_ENDDATE` | EndDate missing | |\n| `JP_SEARCH_OCCUPANCY` | Occupancy missing | |\n| `JP_SEARCH_OCCUPANCY_ADULTS` | Each occupancy must have ≥1 adult | |\n| `JP_SEARCH_OCCUPANCY_ERROR` | Inconsistent occupancy | |\n| `JP_SEARCH_BOOKDATE` | Reservation out of date | Past dates or before release config |\n| `JP_SEARCH_ACCOMMODATION` | Accommodation not found or invalid | |\n| `JP_SEARCH_INVALID_DATES` | StartDate cannot be after EndDate | |\n| `JP_SEARCH_NIGHTS` | Nights not found or invalid | |\n| `JP_SEARCH_HOTELCODE` | HotelCode invalid | |\n| `JP_SEARCH_MAXHOTELCODE` | Only 1 HotelCode allowed (in some contexts) | |\n| `JP_SEARCH_LIMIT_DATES` | Maximum dates reached | |\n| `JP_SEARCH_COUNTRYOFRESIDENCE` | CountryOfResidence missing/invalid | Required by PaxCountry best practice |\n| `JP_SEARCH_LIMIT_DIST` | Distribution count exceeds max | Contact supplier for limit |\n| `JP_SEARCH_LIMIT_HOTELCODE` | Exceeds hotel code list limit (max: {0}) | Default max: 500 hotels |\n| `JP_SEARCH_COORDINATES` | Agency has no permission for coordinate search | Contact Juniper |\n| `INVALID_COORDINATE` | Invalid coordinate values | Lat: -90..90, Lon: -180..180 |\n| `NO_COORDINATES_FOUND` | No match for requested coordinates | Report to supplier |\n| `JP_SEARCH_INVALID_LOCATION` | Location code invalid | |\n| `JP_INVALID_AGE` | Age must be 0–150 | |\n| `JP_STATICDATA_ZONE_MISSING` | ZoneCode expected | |\n| `NO_AVAIL_FOUND` | No availability found | |\n| `INVALID_DATES` | Date format incorrect | Use ISO 8601: `yyyy-MM-dd` |\n| `INVALID_ZONE` | Zone invalid | |\n| `NO_AVAILABILITY_SO` | No results due to server reasons | Contact supplier |\n| `JP_HOTELOPTION_NATIONALITY` | Nationality required | Required by PaxCountry best practice |\n| `JP_SUPPLEMENTS_MAX` | Only one supplement allowed | |\n| `JP_BOARDS_MAX` | Only one board type allowed | |\n| `FORBIDDEN_HOTELS` | Hotels disallowed | Check account permissions |\n| `REQ_PRACTICE` | Required practice not complied — parameter: [%PARAMETER%] | See Best Practices section |\n| `NO_HOTELS_FOUND` | No hotel codes found | |\n| `NO_ACCOMMODATIONS_FOUND` | No accommodation codes found | |\n| `INVALID_PAGE_NUMBER` | Invalid page number | |\n| `MAX_RECORDS_PER_PAGE_EXCEEDED` | Max per page exceeded | |\n\n### 1.4 Booking Errors\n\n| Error Code | Description | Notes |\n|---|---|---|\n| `REQUIRED_FIELDS` | Required field missing: {0} | Maps to fields from BookingRules response |\n| `JP_BOOK` | Request header wrong or missing | |\n| `JP_BOOK_ELEMENTS` | Elements missing | |\n| `JP_BOOK_BOOKINGCODE` | BookingCode wrong or missing | |\n| `JP_BOOK_OCCUPANCY_ERROR` | Occupancy inconsistency | |\n| `JP_BOOK_OCCUPANCY_ORDER_ERROR` | IdPax values repeated | Must be unique within elements |\n| `JP_BOOK_EXPIRATION_DATE` | BookingCode has expired | Re-run BookingRules to get fresh BookingCode |\n| `JP_BOOK_ADDITIONALQUESTION_MISSING` | AdditionalQuestion required fields missing | |\n| `JP_ERRORENCODEDDATAINTEGRITY` | Hotel code/dates mismatch with encoded data | |\n| `JP_RULES_SEARCHBOOKINGRULES` | SearchBookingRules missing/invalid | |\n| `JP_RULES_RESULTCODE` | ResultCode missing/invalid | |\n| `JP_DESCRIPTIVEINFO` | Request header expected | |\n| `JP_DESCRIPTIVEINFO_HOTELCODE` | Hotel Code expected | |\n| `JP_PROMOCODES_MAX` | Only one promo code allowed | |\n| `INVALID_DOCUMENTNUMBER` | Invalid document number | |\n| `INVALID_DOCUMENTNUMBER_LENGTH` | Invalid document number length | |\n| `INVALID_DOCUMENTNUMBER_EMPTY` | Empty document number | |\n\n---\n\n## PART 2 — WARNING CODES\n\n### 2.1 Availability / Pricing Warnings (action required)\n\n| Warning Code | Description | Action |\n|---|---|---|\n| `warnPriceChanged` | Price changed; new RatePlanCode returned | **Refresh availability; use new RatePlanCode** |\n| `warnStatusChanged` | Status changed; new RatePlanCode returned | **Refresh availability; use new RatePlanCode** |\n| `warnFlightInfoChanged` | Flight info changed (dates/times); new RatePlanCode | **Refresh availability; use new RatePlanCode** |\n| `warnFlightClassChanged` | Class changed; new RatePlanCode | **Refresh availability; use new RatePlanCode** |\n| `warnCheckNotPossible` | Price review not possible | Proceed with caution; may use stale price |\n| `warnRequestDate` | Dates contain timezone offset | Verify dates; ensure no day-boundary shift |\n\n### 2.2 Cancellation Warnings\n\n| Warning Code | Cancelled? | Costs Available? |\n|---|---|---|\n| `warnCancellationNotCalculated` | No | No |\n| `warnCancellationCostRetrieved` | No | Yes |\n| `warnCancelledAndCancellationNotCalculated` | Yes | No |\n| `warnCancelledAndCancellationCostRetrieved` | Yes | Yes |\n\n### 2.3 Modify Warnings (Hotel)\n\n| Warning Code | Description |\n|---|---|\n| `warnModifyNotNecessary` | No modification needed |\n| `warnNoModifications` | No modifications applied |\n| `warnModifyHolder` / `warnConfirmModifyHolder` | Holder will be / has been modified |\n| `warnModifyReference` / `warnConfirmModifyReference` | External reference modified |\n| `warnModifyBookingComments` / `warnConfirmModifyBookingComments` | Booking comments modified |\n| `warnModifyHotel` / `warnConfirmModifyHotel` | Hotel modified |\n| `warnModifyDates` / `warnConfirmModifyDates` | Dates modified |\n| `warnModifyDistribution` / `warnConfirmModifyDistribution` | Distribution modified |\n| `warnModifyBoard` / `warnConfirmModifyBoard` | Board modified |\n| `warnModifyRoom` / `warnConfirmModifyRoom` | Room modified |\n| `warnDeleteRooms` / `warnConfirmDeleteRooms` | Rooms deleted |\n\n### 2.4 Best Practice / Config Warnings\n\n| Warning Code | Description | Action |\n|---|---|---|\n| `warnReqPractices` | Required practice not complied — param: [%PARAMETER%] | Implement the practice; will become hard error for new integrators |\n| `warnOverwriteParameter` | AdvancedOption overwritten by supplier config | Log the actual used value; contact supplier if unexpected |\n| `warnMaxFutureRates` | Too many results; response trimmed | Narrow search parameters |\n| `warnProcessExcededFutureRates` | Overload detected | Restrict parameters or split requests |\n\n### 2.5 Promo / BIN Warnings\n\n| Warning Code | Description |\n|---|---|\n| `warnPromoNotApply` | Promo code [%PROMOCODE%] cannot be applied |\n| `warnPromoSoldOut` | Promo code exhausted |\n| `warnPromoAlreadyApplied` | Promo code already used |\n| `warnPromoNotExist` | Promo code not found |\n| `warnPromoRelPaxesDist` | Promo doesn't apply to full distribution |\n| `warnBINNotApply` | BIN code not applied |\n\n### 2.6 Content / Mapping Warnings\n\n| Warning Code | Description |\n|---|---|\n| `warnHotelContent` | Hotel {0} does not exist in system |\n| `warnObsoleteJPCode` | Obsolete JPCode — update to unified code |\n| `warnIncorrectHotelCode` | Incorrect hotel code format |\n| `warnMappingVervotech` | Double-verification between JP code and Vervotech code failed |\n| `warnBookingElementIdHotelChange` | Element has suffered manual hotel change — update meeting points/accommodation IDs |\n| `warmPaxAgeChanged` | Pax age mismatch between specified and BornDate-calculated |\n\n### 2.7 Data Management API Warnings\n\n| Warning Code | Description |\n|---|---|\n| `warnSupplierNoContracts` | Provider has no associated contract |\n| `warnSupplierNoBookings` | No bookings for supplier-related hotels |\n| `warnSupplierNotSupported` | Search not allowed for this supplier |\n| `warnItemNotBelongReservation` | Element doesn't belong to specified booking |\n| `warnItemNotExist` | Element doesn't exist |\n| `warnExternalLocatorDuplicated` | External locator value already exists |\n| `warnExternalCancelLocatorDuplicated` | External cancel locator already exists |\n| `warnNewRoomType` | Room type code exists; new type created |\n| `warnIncorrectBooking` | Booking {0} doesn't exist |\n| `warnIncorrectBookingLine` | Booking line {0} not in booking {1} |\n| `warnIncorrectBookingClient` | Different client on booking {0} |\n| `warnContractDoesNotExist` | Contract {0} does not exist |\n| `warnHotelDatesNoAllotmentContracts` | Hotel {0} has no allotment contracts for dates |\n\n---\n\n## PART 3 — Implementation Decision Tree\n\n```\nResponse received\n├── ErrorList present?\n│   ├── COMPRESSION_REQUIRED → add Accept-Encoding header and retry\n│   ├── IP_NOT_REGISTERED → operator action (IP allowlist)\n│   ├── INVALID_USER_OR_PASSWORD → credential check; do NOT retry in loop\n│   ├── JP_BOOK_EXPIRATION_DATE → re-run BookingRules; get fresh BookingCode\n│   ├── TOO_MANY_REQUEST → exponential backoff + contact supplier\n│   ├── JP_SEARCH_LIMIT_HOTELCODE → reduce hotel list to ≤500\n│   ├── REQ_PRACTICE → implement the cited best practice\n│   └── All others → surface to caller as structured error; do not auto-retry\n│\n└── Warnings present? (non-fatal; log always)\n    ├── warnPriceChanged / warnStatusChanged / warnFlightInfoChanged →\n    │   STOP current flow; refresh availability; use new RatePlanCode\n    ├── warnCancellationNotCalculated → poll ReadBooking for final state\n    ├── warnCancelledAndCancellationCostRetrieved → confirmed cancel; store cost\n    ├── warnReqPractices → implement the named practice before next call\n    ├── warnOverwriteParameter → log Requested vs Overwritten; accept overwritten\n    └── warnObsoleteJPCode → update stored hotel code to unified code\n```\n\n--- SOURCE: ENDPOINT_TAXONOMY.md ---\n# Juniper Endpoint Taxonomy (high-signal)\n\n## 1) Structural model\n- **Layer A – Common/process:** `genericworkflow`\n- **Layer B – Product APIs (`/jp/*`):** hotel/car/flight/transfer/ticket/package/insurance/visa/cruise/payment\n- **Layer C – Management APIs:** `export/data-export-api`, `jpdm/*`, legacy `OTA`\n- **Layer D – Operational/onboarding:** `faq/*`, `buyer/*`, `uploads/*`\n\n## 2) Shared transaction set (cross-product)\n- `ReadBooking` / `CancelBooking`\n- `BookingRules` / `CheckAvail` (product-specific families)\n- `Booking` + optional modify/confirm modify\n- `Login` request envelope + `Version`/`Language`\n\n## 3) Product transaction families\n\n### Hotel API\n- **Static data**: `HotelList`, `HotelCatalogueData`, `HotelContent`, `HotelPortfolio`, `AccommodationPortfolio`, `RoomList`\n- **Search/availability**: `HotelAvail`, `HotelAvailCalendar`, `HotelFutureRates`, `HotelCheckAvail`\n- **Pre-booking**: `HotelBookingRules`\n- **Booking lifecycle**: `HotelBooking`, `ReadBooking`, `CancelBooking`\n- **Modify family**: `HotelModify`, `HotelConfirmModify`\n\n### Car / Rentacar API\n- **Static data**: `RentacarLocationList`, `RentacarLocationContent`\n- **Search/availability**: `RentacarAvail`, `RentacarCheckAvail`\n- **Pre-booking**: `RentacarBookingRules`\n- **Lifecycle**: `RentacarBooking`, `ReadBooking`, `CancelBooking`\n\n### Transfer API\n- **Static**: `TransferCatalogueData`, `TransferPortfolio`, `TransferContent`\n- **Search**: `TransferAvail`, `TransferAvailByHotel`, `TransferCheckAvail`\n- **Pre-booking**: `TransferBookingRules`\n- **Lifecycle**: `TransferBooking`, `ReadBooking`, `CancelBooking`\n- **Modify**: `TransferModify`, `TransferConfirmModify`\n\n### Flight API\n- **Search/availability**: `FlightAvail`, `FlightCheckAvail`\n- **Pre-booking**: `FlightBookingRules`\n- **Booking**: `FlightBooking`\n- **Post-booking**: `FlightTicketing`, `ReadBooking`, `CancelBooking`\n\n### Ticket/Service API\n- **Static**: `ServiceCatalogueData`, `ServicePortfolio`, `ServiceContent`\n- **Search/availability**: `ServiceAvail`, `ServiceCheckAvail`\n- **Pre-booking**: `ServiceBookingRules`\n- **Lifecycle**: `ServiceBooking`, `ReadBooking`, `CancelBooking`\n- **Modify**: `ServiceModify`, `ServiceConfirmModify`\n\n### Package API\n- **Static**: `PackageList`, `PackageContent`\n- **Search/pricing**: `PackageSearcher`, `PackageCalendarPrice`\n- **Availability**: `PackageAvail`, `PackageCheckAvail`\n- **Pre-booking**: `PackageBookingRules`\n- **Lifecycle**: `PackageBooking`, `ReadBooking`, `CancelBooking`\n- **Mutation**: `PackageChangeProduct`\n\n### Insurance API\n- **Static**: `ZoneList`\n- **Search/availability**: `InsuranceAvail`, `InsuranceCheckAvail`\n- **Pre-booking**: `InsuranceBookingRules`\n- **Lifecycle**: `InsuranceBooking`, `ReadBooking`, `Cancelbooking`\n\n### Visa API\n- **Static**: `VisaCatalogueData`, `VisaPortfolio`\n- **Search/availability**: `VisaAvail`, `VisaCheckAvail`\n- **Pre-booking**: `VisaBookingRules`\n- **Lifecycle**: `VisaBooking`, `ReadBooking`, `Cancelbooking`\n- **Mutation**: `VisaModify`, `VisaConfirmModify`\n\n### Cruise API\n- **Static**: `CruiseItinerary`, `CruiseShip`, `CruiseDataList`\n- **Search/availability**: `CruisePreAvail`, `CruiseAvail`, `CruiseCheckAvail`\n- **Pre-booking**: `CruiseBookingRules`\n- **Lifecycle**: `CruiseBooking`, `ReadBooking`, `CancelBooking`\n\n### Payment API\n- `CheckPaymentRequiredField`\n- `CheckPayment`\n- `PaymentBooking`\n\n### Direct Payment Taxes\n- Tax/fee attribution guidance split by channel:\n  - `JP Hotel API`\n  - `OTA Hotel API`\n- Useful for destination-pay vs pre-paid policy mapping in booking policy engines.\n\n\n\n### Transport API\n- **Static**: `TransportRoutePortfolio`\n- **Search/availability**: `TransportAvail`, `TransportCheckAvail`\n- **Pre-booking**: `TransportBookingRules`\n- **Booking lifecycle**: `TransportBooking`, `ReadBooking`, `CancelBooking`, `TransportTicketing`\n\n### Hotel PUSH API\n- **Integration**: `PUSH` inbound message set (data synchronization)\n- **Transactions**:\n  - `JP_HotelInvNotifRQ`\n  - `JP_HotelAvailNotifRQ`\n  - `JP_HotelRatePlanNotifRQ`\n- **Use case**: inventory availability/price/constraints push for hotel data propagation.\n\n## 4) Management and platform APIs\n\n### Export API\n- Customer: `getCustomerList`, `addCustomer`, `modifyCustomer`\n- Supplier: `getSupplierList`, `addSupplier`, `modifySupplier`\n- Booking: `getBookingList`, `getBookings`, `setBookingDocuments`\n- Invoice/payment: `getInvoices`, `getPurchaseInvoices`, `getCustomerPayments`, `getFictitiousPayments`, `getSupplierPayments`, `getBankAccounts`\n- ProductGroups: `getProductGroups`\n- Generic: `getCatalogueData`\n\n### JPDM API\n- Generic transactions: `GenericCatalogueData`, booking/customer/finance/accounting operations.\n- Booking transactions: `SearchBooking`, `ReadBooking`, `ModifyBooking`, `HistoryUpdateBooking`, `AddAdjustBooking`, `ChangeBookingStatus`, `SpecialPriceBooking`\n- Hotel transactions: `HotelCatalogueData`, `HotelOccupancyList`, `HotelList`, `HotelDetail`, `HotelCreation`, `HotelUpdate`, `HotelAllotment*`, `HotelRestriction*`, `HotelStopSale*`, `HotelMultimarkup*`\n- Product/service/transfer creation and contract/parameter operations (numerous `Create/Read/Update` forms)\n- User/label/customer transactions: `GetUser*`, `ModifyUser`, `CreateAgencySignature`, `CustomerAuth`\n- Template/contract operations (assignments, supplier template, cancellation policy, tax, external params, external rates)\n\n### Hotel Extranet API\n- `ExtranetHotelList`, `ExtranetHotelRates`, `ExtranetHotelRatesUpdate`\n- `ExtranetReadBooking`, `ExtranetUpdateBooking`\n- `HotelCatalogueData`, `HotelCreation`, `HotelExtranetContract`, `HotelExtranetNotification`\n\n### Legacy OTA Hotel API\n- Static: `JP_CatalogueData`, `JP_RoomTypeList`, `JP_ZoneList`, `JP_HotelList`\n- Booking: `OTA_HotelAvail`, `OTA_HotelBookingRule`, `OTA_HotelRes`, `OTA_Read`, `OTA_Cancel`, `OTA_HotelResModify`\n- OTA certification/process topics maintained separately\n\n## 5) Error/warning taxonomy alignment\n- Keep a structured matrix in `ERROR_WARNING_MATRIX.md` and apply:\n  - request-shape errors as hard validation failures,\n  - warnings as business-state reconciliation signals,\n  - lifecycle exceptions as policy/rules/contract constraints.\n\n### OCTO API (`/api/octo/*` and `/webservice/octo/*`)\n- Authentication: `POST /webservice/octo/authentication` (OAuth client credentials)\n- Product catalog:\n  - `GET /webservice/octo/products`\n  - `GET /webservice/octo/products/{productId}`\n- Availability:\n  - `POST /webservice/octo/availability/calendar`\n  - `POST /webservice/octo/availability`\n- Booking:\n  - `POST /webservice/octo/bookings`\n  - `POST /webservice/octo/bookings/{bookingId}/cancel`\n  - `GET /webservice/octo/bookings/{bookingId}`\n- Host family from examples: `xml-uat.bookingengine.es`\n\n--- SOURCE: AUTH_MODEL.md ---\n# Juniper Auth Model (verified summary)\n\n> Data is extracted from Juniper API docs as schema-level guidance only. Values and hostnames remain external-system dependent.\n\n## 1) Primary authentication mechanics\n- **Per-transaction credentials in XML envelope** under `<Login>` node for JP/legacy APIs.\n  - Mandatory attributes in successful request samples:\n    - `Email`\n    - `Password`\n  - Optional context attribute in some integrations: `Client`\n- **Request-level metadata:** `Language`, `Version` on each `RQ` node.\n\n## 2) Transport model\n- SOAP/XML + `.asmx` endpoint style.\n- WSDL access pattern shown in docs: `.../WebServiceJP.asmx?WSDL`.\n- Examples show separate JP environment host (UAT) under `xml-uat.bookingengine.es` and a similar production family.\n- HTTPS is required; security guidance references HTTPS/TLS constraints and connection-related errors.\n\n## 3) Security/posture behavior from docs\n- **IP-based allowlisting** is explicit (`IP_NOT_REGISTERED`).\n- **Credential state** errors: `INVALID_USER_OR_PASSWORD`, blocked login classes, inactive accounts.\n- **Permission boundaries**: role/channel/interface restrictions (`JP_AUTH_*` patterns in docs).\n- **Transport hardening:** many availability operations can enforce compression (`COMPRESSION_REQUIRED`).\n\n## 4) Recommended production-safe implementation\n- Externalize credentials and endpoint URLs by environment.\n- Enforce TLS-only outbound requests.\n- Set explicit headers:\n  - `Content-Type: text/xml; charset=utf-8`\n  - `SOAPAction` per operation\n  - `Accept-Encoding: gzip,deflate` (for availability transactions when supported)\n- Keep all logs scrubbed: credentials redacted, but keep `ErrorList`/`Warnings` and operation IDs for support.\n\n## 5) IP Management (Buyer Portal)\n- IP allowlisting is managed through the **Buyer Portal** at https://buyers-portal.junipertraveltech.com/\n- Procedure: See `/buyer/ipmanagement` guideline on the portal\n- Error when IP not registered: `IP_NOT_REGISTERED: The IP {0} does not have permission to access this Webservice`\n- **Action required:** Register all outbound IPs (including CI/CD runners) before integration testing\n\n## 6) Account types — critical operational distinction\n\n| Account Type | Payment required? | Booking confirmation flow |\n|---|---|---|\n| Credit/pre-payment account | No | Booking → immediately confirmed (`OK`/`PAG`) |\n| Point-of-sale account | Yes | Booking → `QUO` status → PaymentBooking → `PAG` |\n\n- **Ask your Juniper supplier** which account type applies before developing payment flow\n- Attempting payment transactions on non-POS account = payment endpoints unavailable\n\n## 7) OCTO API authentication (separate system)\n- Uses OAuth-style client credential flow\n- Endpoint: `POST /webservice/octo/authentication`\n- Returns bearer token for subsequent calls\n- Token must be included in headers for all OCTO product/availability/booking calls\n- OCTO products: only Ticket/Activity type products (not hotels/cars/transfers)\n\n## 8) Compression enforcement details\n- Applies to availability transactions specifically\n- Some supplier configs require it; others recommend it\n- Without it: `COMPRESSION_REQUIRED` error stops the request\n- Header: `Accept-Encoding: gzip,deflate`\n- Server response will include `Content-Encoding: gzip` when compressed\n- Client must decompress before parsing — standard HTTP protocol behavior\n- **Benefit:** ~95% size reduction on large availability responses\n\n## 9) Request rate limits\n- Per-supplier configurable quota\n- Exceeded → `TOO_MANY_REQUEST` error\n- **Do not** auto-retry immediately; use exponential backoff\n- Contact supplier for quota increase if limits are too low for use case\n\n## 10) Test environment\n- SOAP/JP: `https://xml-uat.bookingengine.es/WebService/JP/WebServiceJP.asmx`\n- JPDM: `https://juniper-uat.bookingengine.es/WebServiceJPDM/DataManagement.asmx`\n- Export: `https://juniper-uat.bookingengine.es/wsExportacion/`\n- Credentials: request test XML credentials from Juniper supplier (different from prod)\n- Test data differs from production (static data, hotel codes, availability)\n\n--- SOURCE: OCTO_API.md ---\n# OCTO API (Juniper REST Ticket/Tour API — Full Reference)\n\n> Source: `https://api-edocs.ejuniper.com/api/octo/ticket-api`\n\n## Overview\nJuniper's implementation of the OCTO API specification for buyers integrating with suppliers on the Juniper booking engine. Purely REST/JSON — fully separate from JP SOAP/XML stack.\n\n## Base host (UAT docs examples)\n- `https://xml-uat.bookingengine.es`\n\n## Core endpoint table\n\n| Name | Method | Path | Description |\n|------|--------|------|-------------|\n| Authentication | POST | `/webservice/octo/authentication` | Generate Bearer token |\n| Get Products | GET | `/webservice/octo/products` | List all products |\n| Get Product | GET | `/webservice/octo/products/{productId}` | Single product details |\n| Availability Calendar | POST | `/webservice/octo/availability/calendar` | Calendar view (optimized large-range) |\n| Availability Check | POST | `/webservice/octo/availability` | Availability + bookingId generation |\n| Booking Confirmation | POST | `/webservice/octo/bookings` | Confirm reservation |\n| Booking Cancellation | POST | `/webservice/octo/bookings/{bookingId}/cancel` | Cancel booking |\n| Get Booking | GET | `/webservice/octo/bookings/{bookingId}` | Get booking status/details |\n\n## Authentication\n\n### Request\n```http\nPOST /webservice/octo/authentication HTTP/1.1\nHost: xml-uat.bookingengine.es\nContent-Type: application/json\nContent-Length: 103\n\n{\n  \"client_id\": \"username\",\n  \"client_secret\": \"password\",\n  \"grant_type\": \"client_credentials\"\n}\n```\n\n### Response\n```json\n{\n  \"access_token\": \"U2duNDEx...\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600\n}\n```\n\nNotes:\n- Token is valid for 60 minutes (`expires_in: 3600` is fixed)\n- All subsequent requests must include: `Authorization: Bearer {access_token}`\n- Only `grant_type: \"client_credentials\"` is currently supported\n\n## Required HTTP headers\n\n| Header | Required | Description |\n|--------|----------|-------------|\n| Authorization | Required | `Bearer {access_token}` |\n| Content-Type | Required (POST) | `application/json` |\n| Content-Length | Required (POST) | Dynamically calculated |\n| Accept-Language | Optional | Language for response content |\n| Currency | Optional | TBD |\n\n## Products\n\n### GET /webservice/octo/products\n- Optional query params: `destinationId`, `nextToken` (for pagination)\n- Response fields: `nextToken`, `destinationID`, `results[]`\n  - Each result: `id`, `internalName`, `locale`, `availabilityType`, `type`, `label`, `media[]`, `classifications[]`, `options[]`\n  - `availabilityType` values: `START_TIME`\n  - `type` values: `Tickets`, `Tours`, `Regular`\n  - `pricingFrom.pricingPer` values: `UNIT`, `BOOKING`\n  - `media[].type`: `IMAGE`, `VIDEO`, `IMAGE360`\n  - `media[].rel`: `COVER`, `GALLERY`\n\n### Sample product response\n```json\n{\n  \"destinationID\": 15011,\n  \"results\": [\n    {\n      \"id\": \"AKSkrnflyoG4GgB_aJL1X2Y\",\n      \"internalName\": \"Ticket Test Service\",\n      \"locale\": \"en\",\n      \"availabilityType\": \"START_TIME\",\n      \"type\": \"Tickets\",\n      \"classifications\": [{\"id\": 2, \"name\": \"Tickets\"}],\n      \"options\": [{\"id\": \"37\", \"internalName\": \"Prueba Tipo\", \"availabilityLocalStartTimes\": [\"09:30\"]}]\n    }\n  ]\n}\n```\n\n## Availability\n\n### Availability Calendar\n```http\nPOST /webservice/octo/availability/calendar\n```\n- Optimized for large date ranges; returns one object per day\n- Key request fields: `productId`, `localDateStart`, `localDateEnd`\n\n### Availability Check\n```http\nPOST /webservice/octo/availability\n```\n- Returns one object per start time (or day)\n- Key request fields: `productId`, `optionId`, `localDateStart`, `localDateEnd`, `units[]` with `{id, quantity}`\n- Response includes `availabilityId` (required for booking)\n\n## Booking\n\n### Booking Confirmation\n```http\nPOST /webservice/octo/bookings\n```\n- Requires `availabilityId` from Availability Check response\n- Confirms reservation; makes it ready for use\n\n### Booking Cancellation\n```http\nPOST /webservice/octo/bookings/{bookingId}/cancel\n```\n- Only cancellable if `booking.cancellable == true` and within cut-off window\n\n### Get Booking\n```http\nGET /webservice/octo/bookings/{bookingId}\n```\n\n## Error handling\nAll errors return `400 Bad Request`:\n```json\n{\n  \"error\": \"UNAUTHORIZED\",\n  \"errorMessage\": \"Invalid credentials.\"\n}\n```\n\n### Full error code table\n\n| Code | Description |\n|------|-------------|\n| MISSING_ADDITIONAL_FIELDS | Missing additional required fields: {0} |\n| ALLOTMENT_ERROR | Allotment changed |\n| BOOKING_ALREADY_CANCELED | Booking already canceled |\n| BOOKING_HAS_DIFFERENT_AGENCY | The booking was made by a different agency |\n| BOOKING_HAS_DIFFERENT_PRODUCT_TYPES | Booking has different product types |\n| BOOKING_ID_EXPIRED | Booking id has expired |\n| BOOKING_IS_BLOCKED | Booking is blocked |\n| BOOKING_NOT_ALLOWED | Booking not allowed |\n| BOOKING_NOT_FOUND | Booking not found |\n| CALENDAR_NOT_FOUND | Calendar not found |\n| CANCEL_NOT_POSSIBLE | Booking cannot be canceled |\n| CANCEL_NOT_POSSIBLE_PAST_DATE | Booking cannot be canceled after the date |\n| CAN_NOT_BOOK | Booking not allowed |\n| ERROR_QUANTITY_UNIT | Units '{0}' have different quantity and contacts |\n| EXCEEDED_PREPAYMENT_LIMIT | Exceeded prepayment limit |\n| EXTERNAL_CONNECTIONS_ERROR | Error in external connections |\n| FORBIDEN | Access denied by IP |\n| INVALID_DATES | Past dates are not allowed |\n| INVALID_GRANT_TYPE | Invalid value for grant_type: must be 'client_credentials' |\n| INVALID_OPTION_ID | The optionId was invalid or missing |\n| INVALID_PAYMENT_TYPE | Invalid payment type |\n| INVALID_PICKUP | Invalid pickup point: Not found |\n| INVALID_PRODUCT_ID | The productId was invalid or missing |\n| INVALID_UNIT_ID | The unitId was invalid or missing |\n| INVALID_TOKEN | The next token provided is invalid |\n| INVALID_UPDATE | Cannot update a past booking |\n| IP_NOT_REGISTERED | The IP {0} does not have permission to access |\n| MISSING_FIELDS | Missing fields: [{0}] |\n| BOOK_MODIFICATION_NOT_ALLOWED | Booking cannot be modified |\n| NOT_BOOKABLE | Booking not allowed or not available |\n| NO_AVAIL_FOUND | No avail found |\n| MULTIPLE_AVAILABILITY_ID | Only one availabilityId is permitted |\n| TARIFICATION_ERROR | Price or allotment check was not possible |\n| UNAUTHORIZED | Invalid or missing authentication token |\n| BAD_HEADER | Bad header request: \"{0}\" |\n| MISSING_REQUIRED_FIELDS | Missing required fields: {0} |\n| BOOKING_UNKNOWN_ERROR | Unknown booking error |\n| REQUIRED_FIELD_ERROR_MSG | Required field error: {0} |\n| INVALID_START_DATE | Start date must be ≥ end date |\n| INVALID_AVAILABILITY_ID | Missing or invalid availabilityId in request |\n| INVALID_FIELD | Invalid field: {0} |\n| PRODUCT_NOT_FOUND | Product not found |\n\n## Implementation notes\n- OCTO API is REST/JSON — separate auth and transport from JP SOAP/XML stack\n- Production base URL is not confirmed in public docs; UAT base is `xml-uat.bookingengine.es`\n- `/juniper/octo` internal endpoint returns 403 (internal use only)\n- Postman collection available: `https://god.gw.postman.com/run-collection/19143470-052bfe4f-7c22-4cd7-bca2-f2eae5720204`\n\n--- SOURCE: elearning/FULL_EXTRACTION.md ---\n# Juniper eLearning Complete Extraction\n## Course: JBE-C-PER-Imperatore Travel World (ID: 634)\n## Extraction Date: 2026-02-23\n## Status: COMPLETE (all accessible lessons extracted)\n\n---\n\n## Section 2: Tourism Business\n\n### Tourism Definition\nAccording to the World Tourism Organization (UNWTO, 1994): \"Tourism comprises the activities of persons traveling to and staying in places outside their usual environment for not more than one consecutive year for leisure, business and other purpose.\"\n\n### Tourism Product\nA tourism product is the output that appears throughout the tourism business production. It includes tangible and intangible elements: physical assets and services that characterize a specific destination.\n\n---\n\n## Section 3: Getting to Know Your Juniper Booking Engine\n\n### Booking Engine Overview\nThe Juniper Booking Engine maximizes online selling power with a 24/7 booking channel. Key features:\n- Online selling of products and services\n- Online bookings, or booking on request when there is no allotment\n- Payment gateway with your bank or via your Office's P.O.S.\n- Online management of rates, seasonal offers, discounts and supplements\n- Management of discounts for children and additional adult occupancies\n- Multilingual\n- A single database for multiple sales portals\n- Possibility to include dynamic packages\n- Online management of the allotment\n- Customized design\n- Customer access with user ID and password, obtaining discounted rates\n- Connection with external suppliers\n- Automatic sending of the voucher and pro-forma invoice (for professionals)\n- Payment method configuration for professionals: prepayment, credit and virtual P.O.S.\n- Customer databases for emailing campaign purposes\n- Visitor statistics and analysis of the customer's demands\n\n### Login\nTechnical requirement: Internet connection. Access the Intranet with user ID and password provided by Juniper, then select the language.\n\n### Main Menu Structure\n- **Accommodation / Packages / Cruises / Flights / Destination Services**: product management sections\n- **Customers**: agency database (B2B), final customers database (B2C)\n- **Bookings**: booking management with filters. Default view shows booking list\n- **Reports**: sales tracking, rates report, review utilities\n- **Tools**: e-mailing design assistant and website statistics\n- **Master Tables**: general parameters (content, messages, destinations, suppliers, currencies, users, website config)\n- **Accounting**: module to manage client's and supplier's accounts\n- **User**: Intranet configuration settings\n- **Call Center**: help desk module to create, modify, manage, and cancel bookings\n- **Ground handling**: daily booking management of excursions and transfers\n\n---\n\n## Section 4: First Settings - Master Tables\n\n### Destination Management\nThe Master Tables include Destination management with 3 levels:\n1. **Zone**: geographical region (e.g., Europe)\n2. **Country**: nation within a zone\n3. **Area**: specific locality/region within a country (e.g., Mallorca, London)\n\nAreas must be assigned to a zone and country. They can contain sub-areas for more granular classification.\n\n### Currency Management\nManage currencies used throughout the system. Each currency has:\n- Code (ISO)\n- Name\n- Symbol\n- Exchange rate (auto-updated or manual)\n- Decimal positions\n\n### Supplier Management\nSuppliers are organized by:\n- Supplier code and name\n- Contact information\n- Payment conditions\n- Currency\n- Type classification\n\n### Language Configuration\nThe system supports multiple languages. Content can be managed per language for:\n- Product descriptions\n- Website content\n- Communication templates\n- Booking confirmations\n\n### Content Management\nMaster Tables > Content includes:\n- **Messages**: email templates for confirmations, cancellations, reminders\n- **Destinations content**: descriptions and images per area\n- **Website configuration**: general settings for the public-facing site\n\n### Website Configuration\nKey settings include:\n- Sales channels (B2B, B2C)\n- Payment methods per channel\n- Booking expiry rules\n- Display settings\n- SEO parameters\n\n### Users Management\nIntranet users are managed through Master Tables > Users:\n- Username and password\n- Permission levels\n- Department assignment\n- Access restrictions\n\n---\n\n## Section 5: Business Structure - Customers\n\n### Customer Types\nThree main customer categories:\n1. **Agencies (B2B)**: travel agencies, tour operators, corporate accounts\n2. **Final Customers (B2C)**: individual travelers\n3. **Corporate**: business accounts\n\n### Agency Management\nAgency records include:\n- General data (name, address, fiscal data)\n- Contact information\n- Commercial conditions (payment terms, credit limits)\n- Commission structure\n- Channel access permissions\n- Branch office management\n\n### Agency Commercial Conditions\n- **Payment types**: prepayment, credit, mixed\n- **Markup/commission**: percentage or fixed amount\n- **Credit limits**: maximum outstanding balance\n- **Expiry rules**: days to pay before travel date\n- **Currency**: billing currency\n\n### Customer Segmentation\n- Product groups for differentiated pricing\n- Agency categories for tiered access\n- Channel-specific rules (web, call center, XML)\n\n---\n\n## Section 6: Destination Services\n\n### Service Types\nDestination services include:\n- Excursions and tours\n- Tickets and entrance fees\n- Transfers (airport, hotel, point-to-point)\n- Car rentals\n- Insurance\n- Other ancillary services\n\n### Service Configuration\nEach service requires:\n- General data (name, description, images)\n- Destination/area assignment\n- Supplier assignment\n- Rate structure (per person, per unit, per booking)\n- Availability rules\n- Booking conditions\n\n### Transfer Management\nTransfers are configured with:\n- Origin and destination points\n- Vehicle types\n- Capacity (pax count)\n- Routes and zones\n- Meeting points\n- Time schedules\n- Rate structures (per vehicle or per person)\n\n### Service Rates\nRate configuration includes:\n- Season dates\n- Occupancy rules\n- Child discounts\n- Supplement management\n- Currency\n- Allotment (available units)\n\n---\n\n## Section 7: Predefined Packages\n\n### Package Structure\nPredefined packages combine multiple products into a single bookable item:\n- Hotels\n- Flights\n- Services/excursions\n- Transfers\n- Car rental\n- Insurance\n\n### Package Creation Workflow\n1. **General tab**: basic data, name, description, destinations, duration, images, business rules, sales channels, access conditions\n2. **Departure Dates tab**: frequency (daily, weekly, random), date ranges\n3. **Hotels tab**: assign accommodations per stay day\n4. **Rooms tab**: room type combinations\n5. **Rates and Allotments tab**: pricing per person per room type per departure date\n6. **Flights tab**: charter or external supplier flights\n7. **Services tab**: excursions, activities per day\n8. **Transfers tab**: transfers per segment\n9. **Supplements tab**: optional or mandatory add-ons (per unit/person/booking/night)\n10. **Cancellation Policy tab**: rules and conditions\n11. **Taxes tab**: fixed or percentage taxes\n\n### Package Pricing\n- Rates entered per person per room combination per departure date\n- Supplements can be mandatory or optional\n- Child discounts configurable\n- Currency management\n- Markup/commission rules apply\n\n---\n\n## Section 8: Dynamic Packages\n\n### What is a Dynamic Package?\nDynamic packages allow combination of assorted products (own or external) with high customization. More flexible than predefined packages.\n\n### Dynamic Package Types\n1. **Custom Dynamic Packages**: created by Juniper clients\n2. **Master Packages**: automatic combinations created by Juniper team upon request, not destination/origin/duration specific\n\n### Available Products for Dynamic Packages\nMost product types can be combined:\n- Accommodation (own and external)\n- Flights (charter and external)\n- Services/excursions\n- Transfers\n- Car rental\n- Insurance\n- Predefined packages within dynamic packages\n- Supplements\n\n**Not available**: Cruises module, external supplier cruises and predefined packages connections.\n\n### Dynamic Package Creation Tabs\n1. **General**: name, description, destinations, duration, images, business rules, channels, languages, product group for commissions\n2. **Departure Days**: daily, weekly, or random-frequency departures\n3. **Config**: product types per day and destination, mandatory vs optional products\n4. **Hotels**: accommodation selection per stay day (all, own only, external only, specific)\n5. **Flights**: flight selection (charter/external, public/negotiated rates, flight number/duration filters)\n6. **Services**: service selection per stay day and supplier\n7. **Transfers**: transfer selection per stay day and segment\n8. **Rentacar**: car rental supplier selection per stay day\n9. **Insurance**: insurance supplier selection per stay day\n10. **Supplements**: mandatory or optional, charged per unit/person/booking/night\n11. **Predefined Package**: include own predefined packages in dynamic packages\n12. **Cancellation Policy**: backup policy if product has none; can overwrite product-level policies\n13. **Simulator**: test availability search to verify configuration\n\n### Unique Hotel\nUnique Hotel unifies the same accommodation from different suppliers under a single JP code:\n- Juniper handles mapping, identification, and maintenance\n- Priority order can be defined by supplier per hotel\n- Configuration per channel and client\n- Blocking/unblocking of hotels and suppliers\n- Accommodation type classification (Apartment, Beach, Luxury, etc.)\n\n---\n\n## Section 9-10: Own Accommodation\n\n### Hotel Management\nOwn accommodation is managed through the Intranet with:\n- Hotel general data (name, category, address, contact)\n- Descriptions per language\n- Images and galleries\n- Room types and configurations\n- Facilities and services\n- Location maps\n\n### Rate Management\n- **Cost rates**: supplier/purchase prices\n- **Sales rates**: customer-facing prices\n- **Seasons**: date ranges with different pricing\n- **Occupancy rules**: adult, child age ranges, supplements\n- **Board types**: room only, B&B, half board, full board, all inclusive\n- **Allotment**: available rooms per date\n- **Stop sales**: block availability for specific dates\n- **Release days**: minimum advance booking requirement\n- **Minimum stay**: minimum nights required\n\n### Contract Management\nContracts define the commercial relationship between the hotel and the booking engine:\n- Contract dates and validity\n- Rate structure\n- Payment terms\n- Cancellation policies\n- Special conditions\n\n---\n\n## Section 11: Flights\n\n### Flight Management\nThe system supports:\n- Charter flights (own product)\n- External supplier flights (GDS/NDC connections)\n- Amadeus integration for regular flights\n\n### Charter Flight Configuration\n- Route management (origin-destination pairs)\n- Schedule management\n- Seat inventory/allotment\n- Fare classes and pricing\n- Baggage rules\n- Booking rules\n\n### Amadeus Integration\n- Last Ticket Date management\n- PNR synchronization\n- Fare rules and conditions\n- Ticketing automation\n\n---\n\n## Section 12: Destination Services Extranet\n\n### Extranet Purpose\nThe Destination Services Extranet allows external suppliers to:\n- Upload and manage their services directly\n- Update rates and availability\n- View bookings\n- Communicate with the platform operator\n\n---\n\n## Section 13: Predefined Packages Extranet\n\n### Extranet Features\nSuppliers can directly upload predefined packages to the platform:\n- User management: create extranet users per supplier and product group\n- Package creation with all standard tabs (General, Departure Dates, Hotels, Rooms, Rates, etc.)\n- Accommodation creation for packages\n- Room type management\n- Review workflow: Not Reviewed → Reviewed → Modified\n\n### Extranet User Management\n- Created from Intranet: Master Tables > Predefined package extranet user\n- Each user linked to specific supplier and product group\n- Optional permission: \"Allowing editing sales\" (modify sales prices and currency)\n- Password management\n\n### Intranet Control\nFrom the intranet, operators can:\n- View all packages loaded by all extranet users\n- Activate/deactivate packages\n- Review and approve supplier-uploaded packages\n- Filter by review status (Not Reviewed, Reviewed, Modified)\n\n---\n\n## Section 15-16: Call Center\n\n### Call Center Module\nThe help desk module for creating, modifying, managing, and canceling bookings:\n- Search and availability checking\n- Booking creation (accommodation, services, transfers, packages)\n- Booking modification\n- Cancellation management\n- Customer communication\n\n### Booking Flow in Call Center\n1. **Search**: select product type, dates, destination, occupancy\n2. **Results**: view available options with prices\n3. **Selection**: choose specific product/room/service\n4. **Guest Details**: enter traveler information\n5. **Confirmation**: review and confirm booking\n6. **Payment**: process payment if required\n7. **Voucher**: generate and send booking confirmation\n\n### Booking Statuses\n- **INI**: Initial/draft\n- **QUO**: Quote\n- **PRE**: Pre-booking (on request)\n- **CON**: Confirmed\n- **CAN**: Cancelled\n- **OK**: Verified/completed\n\n---\n\n## Section 16: Booking Management\n\n### Booking List\nDefault view shows all bookings with filters:\n- Date range\n- Status\n- Agency/customer\n- Product type\n- Booking reference\n\n### Booking Maintenance\nEach booking record contains:\n- General data (reference, dates, status)\n- Customer/agency details\n- Product elements (rooms, services, transfers)\n- Pricing breakdown (cost, sales, profit)\n- Payment status\n- Communications log\n- Observations/notes\n\n### Booking Modifications\n- Date changes\n- Occupancy changes\n- Room/service upgrades\n- Name changes\n- Agency transfer\n- Cost/price adjustments\n\n### Cancellation Management\n- Apply cancellation policies\n- Calculate cancellation charges\n- Process refunds\n- Notify suppliers and customers\n\n---\n\n## Section 17: Ground Handling\n\n### Ground Handling Module\nDaily management of excursions and transfers:\n\n### Service Assignment\n- Daily booking overview per service type\n- Driver/guide assignment\n- Vehicle assignment\n- Route management\n- Pickup point management\n- Time management\n\n### Transfer Operations\n- Airport transfers organization\n- Hotel transfers scheduling\n- Group consolidation\n- Vehicle capacity optimization\n- Driver communication\n\n### Operations Dashboard\n- Daily view of all services\n- Status tracking (pending, assigned, completed)\n- Exception handling\n- Supplier communication\n\n---\n\n## Section 18: Accounting\n\n### Accounting Module Overview\nManages client and supplier accounts:\n\n### Customer Invoicing\n- Invoice generation (manual or automatic)\n- Invoice series management\n- Fiscal year configuration\n- Tax management (general tax, special tax)\n- Multi-currency support\n\n### Fiscal Year\n- Must open fiscal year before creating invoices\n- Only one fiscal year open at a time\n- Each invoicing company has its own fiscal year and series (Holding module)\n\n### Invoice Rules\n- Automated invoice on OK status (optional)\n- Automated invoice on 100% payment (optional)\n- Future date invoice restriction (optional)\n- Negative profit rules per product type\n\n### Supplier Cost Management\n- Cost verification\n- Supplier invoice reconciliation\n- Payment tracking\n- Adjustment management\n\n### Payment Methods\n- Prepayment agencies\n- Credit agencies\n- Virtual Credit Cards (VCC) for supplier payments\n- POS configurations (Gateway JP)\n- Payment gateway with anti-fraud module\n\n---\n\n## Section 19: Reports\n\n### Available Reports\n- Sales reports\n- Cost reports\n- Profit reports\n- Rate reports\n- Availability reports\n- Booking statistics\n- Customer analytics\n- Supplier performance\n\n### Report Types\n- Standard reports with filters\n- Exportable to Excel\n- Scheduled automated reports\n- Custom query capabilities\n\n---\n\n## Section 20: Web\n\n### Website Configuration\nThe Web module manages the public-facing booking website:\n- Design customization\n- Content management\n- SEO settings\n- Sales channel rules\n- Payment gateway integration\n- Customer access and authentication\n- Multi-language support\n\n---\n\n## Section 21: User Settings\n\n### Support System\nRedirects to Juniper support system for ticket management. Separate credentials from intranet.\n\n### Documentation\nLinks to documentation platform with user manuals and monthly newsletters.\n\n### Password Management\nChange password: enter old password, then new password twice.\n\n### Email Settings\nChange email data associated with user and password.\n\n### Intranet Configuration\nExtensive settings organized by sections:\n\n#### General Settings\n- Intranet language (English/Spanish)\n- Default page redirect\n- Decimal separator\n- Language order of appearance\n- Document type configuration\n- Booking deadline for prepayment agencies (hours)\n- Google Maps API key per channel\n- Default search agency in call center\n\n#### Services Settings\n- Contract configuration (show/hide contract types)\n- Meeting point visibility\n- Ground Handling parameters\n\n#### Bookings Settings\n- Bookings per page (25/50/100)\n- Supplier notification on adjustments\n- Allow agency change\n- Auto-OK at payment percentage threshold\n- Cancellation email notifications\n- Cancellation charge date handling\n- Cancellation policy margin (hours)\n- Expiry date margin (hours)\n- Negative profit rules per product type\n- Required fields for external supplier bookings\n- Dynamic package promotion enabling\n\n#### Accounting Settings\n- Spanish General Tax toggle\n- Automated invoice on OK status\n- Automated invoice on 100% payment\n- Accounting number length\n- Fiscal year configuration\n- Customer general settings\n- Invoice rules configuration\n- Invoice series configuration\n\n#### Automatic Processes\n- **Mailing**: CC settings, pre/post stay emails\n- **Currency update**: XE.com default (Sabre/Citibank optional)\n- **Booking expiry checking**: reminder timing and cancellation rules\n- **Sales/cost reports**: automated daily reminders for invoiced bookings\n- **Supplier invoice modification reports**\n- **KPI App notifications**\n- **Accommodation**: minimum allotment threshold notifications, excluded agencies\n- **Flights**: Amadeus Last Ticket Date updater, automatic PNR synchronization\n- **Services**: automated reports to service suppliers\n\n#### Supplier General Settings\n- Supplier booking rejection/confirmation email addressee\n- Supplier type customization\n\n#### Collection & Payment Platforms\n- Virtual Credit Card (VCC) configuration\n- POS configurations (Gateway JP)\n- Payment gateway with anti-fraud module\n\n#### App KPI Configuration\n- Subscription management (Active/Inactive/Demo)\n- Device management (max 3 devices)\n- Session management (close session/delete device)\n\n#### Package Settings\n- Price variation margin for dynamic packages\n- Check on cost or sales prices\n- Percentage or fixed amount tolerance\n- Apply margin per package vs per product\n\n#### Accommodation Settings\nExtensive sub-menus:\n- **Intranet**: hotel creation display options, Unique Hotel blocking rules\n- **Extranet**: password security/expiry management\n- **Rates Report**: personalization options, header/footer for printing\n- **Call Center**: advanced options (SS as RQ, modification blocking)\n- **Own hotel search**: optional configurations\n- **Own hotel parameters**: NRF rate management, auto-create cancellation policies\n- **Supplier messages**: additional notes per product type/area\n- **External suppliers**: fallback cancellation policies, NRF replacement\n- **Price changes**: tolerance margins\n- **Permissions force search parameters**: per-agency search rules for Web/WebService\n- **Accommodations maintenance**: contract types, default supplier contracts\n- **Block hotel**: BI-driven blocking on price/availability changes\n- **Force same sale/cost currency**: per-channel currency rules\n- **Bookings**: supplier notification defaults\n- **WSPush configuration**: OTA/JP/Amajo file generation error notifications\n- **Rates**: editing controls when bookings exist\n- **Images**: minimum dimension requirements\n- **Combination's minimum price**: discard low-price room combinations\n- **Contract review**: mandatory review elements\n- **Website**: web-specific settings\n\n#### Flights Settings\n- Disable Last Ticket Number Charter V1\n\n#### Security and Privacy\n- **Login and Security**: password strengthening for intranet/agency/agent access\n- **Double Authentication Factor**: second layer of security, requires SSL\n- **Access Warnings**: alerts for suspected fraudulent access\n- **Activity Registry**: user access log\n- **CDN Configuration**\n\n#### Other User Options\n- Change language (Spanish/English)\n- Save page\n- Exit application\n\n---\n\n## Section 22: Business Intelligence\n\n### BI Module\nBusiness Intelligence provides analytics and reporting:\n- Performance dashboards\n- Revenue analytics\n- Occupancy tracking\n- Customer behavior analysis\n- Supplier performance metrics\n- Price and availability change monitoring\n- Hotel blocking based on detected changes\n\n---\n\n## Training Resources\nThe course includes:\n- Training Recordings folder (ALL TRAINING RECORDINGS)\n- Training Examples\n- BI recordings\n- Phase-based training structure\n\n---\n\n## Extraction Statistics\n- Sections covered: 22/25 (remaining are intro/questionnaire sections)\n- Lessons extracted: 24\n- Total lesson pages processed: ~150+\n- Content types: lesson pages, configuration guides, workflow instructions, module overviews\n\n--- SOURCE: elearning/KEY_WORKFLOWS.md ---\n# Juniper Key Workflows — eLearning Operational Reference\n\n**Cross-reference:** `/juniper-knowledge/BOOKING_FLOWS.md` for full API-level detail  \n**Cross-reference:** `/juniper-knowledge/REQUEST_RESPONSE_SCHEMAS.md` for schemas\n\n---\n\n## 1. Universal Booking Workflow (All Product Types)\n\n```\nSTATIC HYDRATE → AVAILABILITY SEARCH → BOOKING RULES → BOOK → READ/CONFIRM → (MODIFY/CANCEL)\n```\n\n| Step | Operation | Key Input | Key Output |\n|---|---|---|---|\n| 1. Static Data | `*CatalogueData`, `ZoneList`, `*Portfolio` | — | Product catalog, zones, destinations |\n| 2. Availability | `*Avail` | Destination, dates, PAX count/ages | Option codes + prices (time-limited) |\n| 3. Booking Rules | `*BookingRules` | Option code from step 2 | BookingCode, cancellation policy, final price |\n| 4. Book | `*Booking` | BookingCode, passenger holder details | Locator |\n| 5. Read | `ReadBooking` | Locator | Full booking details, status |\n| 6. Cancel | `CancelBooking` | Locator | Cancellation confirmation, charges |\n| 7. Modify (optional) | `*Modify` + `*ConfirmModify` | Locator | Modified booking |\n\n**Critical rule:** BookingRules step is MANDATORY before Booking. Option codes expire; must re-run Availability + BookingRules if stale.\n\n---\n\n## 2. Hotel/Accommodation Workflow (Hosted Contracts)\n\n**Back-office setup (Intranet):**\n1. Enter property details (name, category, rooms, content)\n2. Set up cost prices and sale prices per room type/season\n3. Configure allotments and releases\n4. Add supplements (single supplement, meal plan upgrades, etc.)\n5. Define cancellation policies\n6. Activate on sales channels\n\n**Customer-facing booking flow:**\n1. Customer searches: destination + dates + occupancy\n2. System returns available properties (parallel search if enabled)\n3. Customer selects hotel/room/board type\n4. BookingRules: confirm price and cancellation policy\n5. Customer confirms booking → Locator assigned\n6. Accounting module: invoice generated\n\n**Extranet flow (suppliers self-managing):**\n- Supplier logs into Hotel Extranet\n- Updates availability, rates, inventory (ARI) directly\n- Or via API: Channels API (PUSH) or JPDM Extranet API\n\n---\n\n## 3. Flight Booking Workflow\n\n**Charter flights:**\n1. Load charter schedule and contracts in intranet\n2. Configure seat inventory and pricing\n3. Customer searches route + dates\n4. FlightAvail → FlightBookingRules → FlightBooking → FlightTicketing\n\n**Scheduled flights (via Lleego/GDS):**\n1. Real-time search via GDS/NDC connections\n2. Same flow: FlightAvail → FlightBookingRules → FlightBooking → FlightTicketing\n3. Note: Ticketing is a separate mandatory step for scheduled flights\n\n---\n\n## 4. Ground Services / Destination Services Workflow\n\n**Setup (Intranet):**\n1. Enter service catalogue (excursions, transfers, tickets, insurance)\n2. Set prices per service/PAX category/season\n3. Configure availability (session times, capacities)\n4. Connect with external service sellers if needed\n\n**Booking flow:**\n1. `ServiceCatalogueData` → `ServicePortfolio` (paged) → `ServiceContent` (static data)\n2. `ServiceAvail` (requires destination/service code + dates + ages)\n3. `ServiceBookingRules` (MANDATORY — returns BookingCode)\n4. Optional: `ServiceCheckAvail` (revalidate before booking with some suppliers)\n5. `ServiceBooking` → Locator\n\n---\n\n## 5. Package Booking Workflow\n\n**Predefined Package booking:**\n1. Package configured in intranet (hotel + optional services + fixed dates/pricing)\n2. Customer searches package by destination/duration\n3. `PackageSearcher` → select package\n4. `PackageBookingRules` → confirm price/policy\n5. `PackageBooking` → Locator\n\n**Dynamic Package booking:**\n1. Customer selects components step-by-step (or via Trip Step by Step add-on)\n2. System runs availability on each component\n3. Combined rules check\n4. Customer confirms full package → Booking created with all component locators\n\n---\n\n## 6. Accounting/Invoicing Workflow\n\n```\nBooking confirmed → Accounting module ingests booking → Invoice generated (Automatic Invoicing optional)\n    ↓\nCustomer receipt management (payment gateway / Wallet)\n    ↓\nSeller payment management (payables)\n    ↓\nReconciliation (bookings ↔ invoices ↔ receipts/payments)\n    ↓\nOptional: Export to ERP (Account Export Interface / Voxel)\n```\n\n**Wallet sub-flow (B2B cancellation):**\n1. Agency cancels booking\n2. Amount automatically refunded to agency's Wallet balance\n3. Agency uses Wallet balance on next booking (no bank transfer needed)\n\n---\n\n## 7. Multicurrency Pricing Workflow\n\n**Seller Currency mode (typical for Webservice/API):**\n- No exchange rate applied\n- Each availability result returned in seller's base currency\n- Same hotel may appear with prices in different currencies\n- Customer pays in the currency of the specific offer\n\n**Customer Currency mode:**\n1. Customer selects preferred currency\n2. Exchange rate fetched/applied\n3. All results converted to customer's selected currency\n4. Single currency presentation regardless of seller's base currency\n\n---\n\n## 8. Affiliate Tracking Workflow\n\n1. Affiliate places banner/link on their website\n2. Visitor clicks → redirected to your site with affiliate code cookie (365-day attribution)\n3. Visitor searches and books\n4. System tags booking with affiliate code\n5. Commission calculated per booking (even on future visits within 365 days)\n6. Reports generated for affiliate performance review\n\n---\n\n## 9. Branch Office / GSA Commission Workflow\n\n1. GSA (parent agency) creates branches in intranet\n2. Assigns credit limits per branch\n3. Configures commissions (fixed GSA commission from front office)\n4. Agents define their own margin per search OR save in profile\n5. Branch makes booking → system applies hierarchy: GSA commission + agent margin\n6. Invoices issued per billing hierarchy (head office → branch)\n\n---\n\n## 10. Promotional Code Workflow\n\n**Early Bird setup:**\n1. Create discount (fixed or %) in intranet\n2. Set conditions: booking date, travel date, days in advance, sales channel\n3. Set as cumulative (optional)\n4. System applies automatically when search conditions match\n\n**Promotion code:**\n1. Create promotion → system generates unique single-use code\n2. Distribute via email campaigns or cards\n3. Customer enters code at booking\n4. System validates + applies discount (single use; tracked to booking)\n\n**Campaign code:**\n1. Create alphanumeric code with usage limit (or unlimited with no code input)\n2. Distribute in mass marketing\n3. Customer enters code at booking\n4. System validates usage count and applies discount\n\n---\n\n## 11. Business Cache Flow (Performance)\n\n```\nCustomer searches → Check Business Cache → \n    If CACHED: Return cached results (0.05s) → Customer sees results\n    If NOT CACHED: Forward to seller in real-time → Cache response → Return results\n```\n\n**For Sellers:**\n- Fewer direct requests = lower server load\n- System batches and caches before delivering to buyers\n\n---\n\n## 12. Smart Booking Engine Auto-Optimization Loop\n\n```\nBI module collects performance data\n    ↓\nSmart BE analyzes: traffic patterns, buyer behavior, seller performance\n    ↓\nApplies rules based on selected mode (Attack / Standard / Defensive)\n    ↓\nPortfolio expanded, traffic throttled, or sellers deprioritized automatically\n    ↓\nDaily suggestions generated for human review\n```\n\n---\n\n## 13. Call Center Booking Workflow\n\n1. Customer calls\n2. Agent logs into Call Center module (back-office interface)\n3. Agent searches product on behalf of customer (same availability flow)\n4. Agent creates booking and takes payment (via payment gateway or Wallet)\n5. Booking tagged with call center sales channel\n6. Reports track call center performance vs other channels\n\n---\n\n## 14. Hotel Extranet (Supplier Self-Service) Workflow\n\n**Via web interface:**\n1. Hotel logs into Hotel Extranet (JPDM web interface)\n2. Updates rooms, rates, availability, allotments\n3. Changes propagate to JBE inventory\n\n**Via API (channel managers):**\n1. Channel manager authenticates via JPDM Extranet API (SOAP/PUSH)\n2. Sends ARI updates (availability, rate, inventory) to JBE\n3. JBE stores and serves updated data to buyers\n\n**Note:** If using Business Cache, cached data may have up to [cache TTL] delay in reflecting new rates.\n\n--- SOURCE: elearning/OPERATIONAL_RULES.md ---\n# Juniper Operational Rules & Configuration Reference\n\n**Source:** ejuniper.com module pages + `/juniper-knowledge/JUNIPER_API_KNOWLEDGE.md`\n\n---\n\n## Authentication & Access\n\n| Rule | Detail |\n|---|---|\n| IP Registration Required | Buyer IPs must be registered in the Juniper portal before API access works. Unregistered IPs return `IP_NOT_REGISTERED` hard-stop error. |\n| Credential Required | Every SOAP/API request requires valid `Login` / `AgencyCode` in request header. Invalid credentials → `INVALID_USER_OR_PASSWORD`. |\n| OCTO Token Lifetime | OCTO REST API tokens expire after 3600 seconds (60 minutes). Re-authenticate on `UNAUTHORIZED` response. |\n| MFA Support | Portal login supports Microsoft Azure AD SSO in addition to username/password. |\n| Role-based Access | Users have roles/channels controlling which operations they can perform. Permission errors are hard stops. |\n\n---\n\n## Booking Rules\n\n| Rule | Detail |\n|---|---|\n| BookingRules is Mandatory | Must call `*BookingRules` (e.g., `HotelBookingRules`, `ServiceBookingRules`) before booking. Cannot skip this step. |\n| Option Code Expiry | Option codes returned from Availability are time-limited. If expired before BookingRules, re-run Availability. |\n| BookingCode Expiry | `JP_BOOK_EXPIRATION_DATE` warning means the booking window has passed. Must re-run Availability + BookingRules to get fresh option. |\n| Price Continuity | Prices returned in BookingRules must be sent back unchanged in Booking request. Price tampering causes booking failure. |\n| Holder Information | Booking requires valid passenger/holder information matching supplier requirements (name, nationality, etc.). |\n\n---\n\n## Accommodation Module Rules\n\n| Rule | Detail |\n|---|---|\n| Release Deadlines | Allotments have release dates. After release, inventory returns to supplier control. Check before booking. |\n| Supplement Types | Some supplements are optional (customer selects); some are mandatory (applied automatically). |\n| Direct Payment Supplements | Supplements marked `@DirectPayment=true` are paid directly to supplier at property. Must be surfaced to customer as NOT included in total price. |\n| Contract Validity | Hosted contracts have start/end dates. Bookings outside contract period return no availability. |\n| Extranet-Updated Rates | If rates are updated via Hotel Extranet or Channels API, Business Cache may serve slightly stale rates. |\n\n---\n\n## Flight Module Rules\n\n| Rule | Detail |\n|---|---|\n| Charter Flights | Inventory is fixed/seasonal; must load schedule and manage allotments in intranet. |\n| Scheduled Flights | Real-time GDS/NDC prices; not cached by default. |\n| Ticketing Required | For scheduled flights, `FlightTicketing` must be called after booking. Missing ticketing step leaves booking un-issued. |\n| GDS via Lleego | Amadeus, Sabre, Galileo, Worldspan connected via Lleego. NDC also available. |\n\n---\n\n## Packages Module Rules\n\n| Rule | Detail |\n|---|---|\n| Predefined Package Price Lock | Predefined packages have fixed closed prices; cannot be modified on-the-fly by customer. |\n| Dynamic Package Flexibility | Customers CAN change selections at any point during Dynamic Package assembly (Trip Step by Step). |\n| Optional Products | Optional services (car hire, transfers, etc.) can be added to packages but must be contracted. |\n\n---\n\n## Accounting Module Rules\n\n| Rule | Detail |\n|---|---|\n| Invoice Generation Timing | Invoices generated per booking entry into Accounting module (automatic if Automatic Invoicing add-on active). |\n| Reconciliation | Bookings must be matched to invoices, then to receipts/payments. Any unmapped transactions flagged. |\n| Voxel Integration | Voxel imports/exports invoices automatically. Requires Voxel add-on activation. |\n| Financing Instalment | Instalment management requires Financing add-on. Not default. |\n| Wallet Refunds | Cancellation refunds to Wallet are automatic if Wallet module is active for the agency. No manual intervention required. |\n\n---\n\n## Multicurrency Rules\n\n| Rule | Detail |\n|---|---|\n| Mode Selection | Either Seller Currency mode OR Customer Currency mode — not mixed per channel. |\n| Seller Currency Mode | No exchange rate applied. Multiple currencies may appear in same search results. Customer pays in offer currency. |\n| Customer Currency Mode | Exchange rate is mandatory. Customer selects currency; all results converted. |\n| Exchange Rate Updates | Exchange rates must be maintained in the system. Stale rates may cause pricing discrepancies. |\n\n---\n\n## Promotional Codes Rules\n\n| Rule | Detail |\n|---|---|\n| Early Bird Cumulative | Early bird discounts CAN be set as cumulative with each other. Promotions and Campaigns CANNOT be cumulative. |\n| Single-Use Enforcement | Promotion codes are strictly single-use. System tracks usage to booking. |\n| Campaign Activation Without Code | Campaigns can be configured to activate without requiring code entry (unlimited use), if all conditions are met. |\n| Max Attribution Window | No maximum booking date limit is specified for early bird; conditions define the window. |\n\n---\n\n## Affiliates Rules\n\n| Rule | Detail |\n|---|---|\n| Cookie Duration | Affiliate attribution cookie lasts up to 365 days. Bookings made within 365 days of referred visit are credited. |\n| Commission Model | Commission can be applied per visit AND/OR per reservation. Both are configurable. |\n| Report Availability | Affiliate performance reports available in back-office at any time. |\n\n---\n\n## Business Cache Rules\n\n| Rule | Detail |\n|---|---|\n| Cache Response Time | Cached queries returned in 0.05 seconds. |\n| Cache Staleness | Cached data may not reflect real-time seller updates immediately. Trade-off: speed vs. freshness. |\n| Seller Benefit | Sellers receive fewer direct requests — reduces their server load automatically. |\n| Timeout Handling | Clients with short timeouts benefit from cache; seller timeout does not affect cached results. |\n\n---\n\n## Smart Booking Engine Rules\n\n| Rule | Detail |\n|---|---|\n| Requires BI Module | Smart Booking Engine is dependent on Business Intelligence module for data input. Cannot function without BI. |\n| Mode Selection is Manual | Operator selects Attack, Standard, or Defensive mode. System then automates within that mode. |\n| Daily Suggestions | System generates daily recommendations based on buyer demand patterns — human review recommended. |\n| Automation Scope | Automatically adjusts portfolio exposure, traffic rules, and seller prioritization. Does NOT override manual booking rules without explicit configuration. |\n\n---\n\n## Branch Offices / GSA Rules\n\n| Rule | Detail |\n|---|---|\n| Hierarchy Structure | Head Office (GSA) → Branches → Agents. Billing flows up the hierarchy. |\n| Credit Limit Enforcement | Branch cannot exceed allocated credit limit. Overspend blocked at system level. |\n| Commission Layers | GSA commission is fixed from front office. Agent margin is per-search or profile-level. Both can coexist. |\n| Permission Management | Branches/agents have configurable permissions controlling product access and booking rights. |\n\n---\n\n## eLearning Platform Rules\n\n| Rule | Detail |\n|---|---|\n| Course Access Per Contract | Courses are only accessible for modules contracted by the client. No access to uncontracted modules. |\n| Access Duration | Access period defined in contractual agreement. Not open-ended by default. |\n| Language Selection | Portal available in Spanish, English, and Portuguese. |\n| Self-Paced 24/7 | All content available 24/7 without scheduling. |\n| Sign-Up Process | Must be arranged through training manager, project manager, or Juniper consultant. Cannot self-register. |\n\n--- SOURCE: elearning/FAQs.md ---\n# Juniper eLearning — Frequently Asked Questions\n\n**Sources:** ejuniper.com module FAQ sections + archived e-learning landing page\n\n---\n\n## Platform / Access FAQs\n\n**Q: What is the Juniper eLearning portal?**  \nA: A Moodle-based web portal for training on the Juniper Booking Engine. It provides theory, quizzes, satisfaction questionnaires, forum, chat, downloadable PDFs, and multimedia resources per contracted module. Launched as new platform in early 2025.\n\n**Q: Who can access the eLearning portal?**  \nA: Organizations and personnel who have contracted Juniper Booking Engine modules. Access must be arranged through a training manager, project manager, or Juniper consultant.\n\n**Q: How do I sign up for eLearning?**  \nA: Contact your training manager, project manager, or your Juniper consultant. You cannot self-register directly.\n\n**Q: What languages are available?**  \nA: Spanish, English, and Portuguese.\n\n**Q: Is training available 24/7?**  \nA: Yes. The platform is self-paced and accessible 24 hours a day, 7 days a week.\n\n**Q: How long do I have access to the portal?**  \nA: Access duration varies according to your contractual agreement conditions.\n\n**Q: Can I access courses for modules I haven't contracted?**  \nA: No. Courses are tailor-made to match your contracted modules only.\n\n**Q: How do I log into the eLearning portal?**  \nA: Via https://elearning.ejuniper.com — login with username/password or via Microsoft Azure AD SSO.\n\n---\n\n## Product / Module FAQs\n\n### Advanced Shopping Basket\n\n**Q: What is Juniper's Advanced Shopping Basket?**  \nA: An evolution of Juniper Booking Engine's traditional Shopping Basket, designed to turn the quotation process into a strategic sales tool.\n\n**Q: What benefits does Advanced Shopping Basket offer to travel companies?**  \nA: It helps increase conversion and revenue through cross-selling features, dynamic quoting, and a clearer product visualization before booking.\n\n**Q: How does cross-selling work within Advanced Shopping Basket?**  \nA: The module suggests complementary products based on the client's selection. For example, if a user books a flight and hotel, the system can recommend transfers or excursions to complete the experience.\n\n**Q: What differentiates Advanced Shopping Basket from the traditional Shopping Basket?**  \nA: Beyond grouping products, it allows users to add, modify, or remove services within the same quote, visualize the complete itinerary, and book directly from the quotation.\n\n**Q: For what type of websites is Advanced Shopping Basket available?**  \nA: Available for both B2B and B2C websites using Juniper Booking Engine Website.\n\n**Q: How does Advanced Shopping Basket help improve conversion rates?**  \nA: Thanks to its visual and dynamic design, users can easily review their itinerary, increasing confidence and booking closure rates.\n\n**Q: Is it possible to send or download created quotations?**  \nA: Yes. Clients can download or receive personalized quotes, facilitating sales in B2C and strengthening business relationships in B2B.\n\n---\n\n### Wallet\n\n**Q: What is Juniper Wallet?**  \nA: A digital solution that allows B2B agencies to manage funds within their suppliers' platform, facilitating automatic refunds and immediate payments on future bookings.\n\n**Q: What benefits does it bring to travel agencies?**  \nA: Greater control over funds, immediate access to available balances, and reduced administrative and banking management time.\n\n**Q: How does Wallet help Juniper's customers?**  \nA: Improves agency loyalty, speeds up payment processes, and reduces costs associated with manual transfers or refunds.\n\n**Q: Can Wallet be combined with other payment methods?**  \nA: Yes. The balance available in Wallet can be used alongside other traditional payment methods, offering greater flexibility.\n\n**Q: Is it possible to set up different currencies or accounts per agency?**  \nA: Yes. Each agency can have its own Wallet set up by currency, adapting to international operations.\n\n**Q: How does Wallet improve payment security?**  \nA: By eliminating intermediaries and centralising transactions within the platform, the risk of error, fraud or delay is reduced.\n\n---\n\n### Smart Booking Engine\n\n**Q: What is Smart Booking Engine?**  \nA: An advanced module of the Juniper Booking Engine that automates business rules, applying intelligent, data-driven decisions to maximize system performance.\n\n**Q: What benefits does Smart Booking Engine offer travel businesses?**  \nA: Optimizes resources by automating portfolio management, reducing manual tasks, and improving booking engine efficiency through a more agile and profitable operation.\n\n**Q: How does Smart Booking Engine work?**  \nA: It analyzes performance data and automatically applies rules based on the selected operating mode (Attack, Standard, or Defensive), adapting to each company's commercial strategy.\n\n**Q: Does Smart Booking Engine use artificial intelligence?**  \nA: Yes. It incorporates an intelligent automation approach that leverages data analysis to make optimized decisions, without relying solely on generative AI.\n\n**Q: How is Smart Booking Engine connected to the Business Intelligence module?**  \nA: Smart Booking Engine integrates with BI, which provides analytical insights needed to detect opportunities, execute automatic rules, and maximize results.\n\n**Q: How does Smart Booking Engine improve booking engine profitability?**  \nA: It automates product management, reacts quickly to market changes, and maintains an efficient decision-making strategy that enhances performance of each search and request.\n\n---\n\n### API / Web Services\n\n**Q: What is a Web Service?**  \nA: Juniper's Web Service is an API designed to enable seamless integration between third-party systems and the Juniper Booking Engine. It automates availability searches, booking management, and real-time data synchronization.\n\n**Q: What APIs are available?**  \nA: Hotels API (PUSH/PULL/hybrid), Flights API (multi-supplier), Tickets & Transfers API, Cars API, Vacation Packages API, Cruises API. Also: Data Management API, Export API, Channels API.\n\n**Q: What volume does the API handle?**  \nA: +10M accommodation bookings, +11M activities & transfers, +550K vacation packages, +65K rent-a-car, +75K cruise, +4M flight bookings per year.\n\n---\n\n### Business Cache\n\n**Q: What is Business Cache?**  \nA: A caching layer that stores seller availability responses, returning cached results in 0.05 seconds to reduce load and improve speed.\n\n**Q: Who benefits from Business Cache?**  \nA: Buyers get faster results and fewer timeout errors. Sellers receive fewer direct requests and reduced server load. End-users get a faster booking experience.\n\n**Q: How does Business Cache affect Look-to-Book ratio?**  \nA: Minimizes hotel requests to Sellers, optimising resources and speeding up response times, which can improve the ratio.\n\n---\n\n### Multicurrency\n\n**Q: What are the two Multicurrency flow modes?**  \nA: Seller Currency mode (no exchange rate; results in seller's base currency) and Customer Currency mode (exchange rate applied; customer chooses currency and all results are converted).\n\n**Q: Can I mix Seller Currency and Customer Currency mode in the same channel?**  \nA: No. Mode is configured per sales channel.\n\n---\n\n## General Business FAQs\n\n**Q: What types of companies use the Juniper Booking Engine?**  \nA: Tour Operators, Travel Agencies, DMCs (Destination Management Companies), Bedbanks, and Airlines (via Juniper Airline Vacations division).\n\n**Q: What is the difference between a Buyer and a Seller in Juniper?**  \nA: A Buyer is a company consuming/distributing travel products via the Juniper Booking Engine. A Seller is a company providing inventory (hotels, services, flights) to Buyers through the platform.\n\n**Q: What is the difference between Hosted Contracts and XML Sellers?**  \nA: Hosted Contracts are directly-loaded supplier content managed in the JBE intranet. XML Sellers connect via real-time API to provide live inventory without hosting it in JBE.\n\n**Q: What is JuliA?**  \nA: Juniper's AI assistant embedded in the intranet. Provides real-time contextual answers about the Juniper ecosystem without needing to switch tabs or search documentation. Free version (Juniper Help by JuliA) available now; Business version coming soon.\n\n--- SOURCE: elearning/EDGE_CASES.md ---\n# Juniper Edge Cases & Known Constraints\n\n**Source:** `/juniper-knowledge/ERROR_WARNING_MATRIX.md`, API docs, module pages  \n**Cross-reference:** `/juniper-knowledge/BOOKING_FLOWS.md` for flow-level context\n\n---\n\n## Booking/Availability Edge Cases\n\n### 1. Stale Option Code\n**Scenario:** Customer takes too long between Availability search and Booking Rules call  \n**Symptom:** `JP_BOOK_EXPIRATION_DATE` warning, or BookingRules returns no valid option  \n**Resolution:** Re-run `*Avail` to get fresh options, then call `*BookingRules` again  \n**Impact:** Customer must re-search; previously selected option may no longer be available or price may have changed\n\n### 2. Availability Compression Required\n**Scenario:** Large availability result set sent without compression  \n**Symptom:** `COMPRESSION_REQUIRED` error from API  \n**Resolution:** Enable GZIP/deflate compression on API requests  \n**Impact:** Hard stop; booking cannot proceed without compression\n\n### 3. Multicurrency Same-Hotel Multiple Prices (Seller Currency Mode)\n**Scenario:** Search returns same hotel multiple times with different prices in different currencies  \n**Cause:** Multiple sellers, each with different base currency; no exchange rate applied  \n**Expected behavior:** This is by design in Seller Currency mode  \n**Resolution:** If single-currency results needed, switch to Customer Currency mode\n\n### 4. Direct Payment Supplement Confusion\n**Scenario:** Customer books service; total price shown excludes a supplement  \n**Cause:** Supplement has `@DirectPayment=true` — paid to supplier directly at property  \n**Rule:** MUST display this supplement clearly to customer as NOT included in total  \n**Risk if not handled:** Customer expects to pay the system-quoted price but arrives at venue to find additional charges\n\n### 5. Allotment Released Before Booking\n**Scenario:** Customer starts booking process; allotment release deadline passes during session  \n**Symptom:** No availability returned, or `ALLOTMENT_EXHAUSTED` error  \n**Resolution:** Re-run availability check; product may no longer be available\n\n### 6. Package Component Availability Mismatch\n**Scenario:** Dynamic Package shows available flight + hotel, but one component is no longer available at booking time  \n**Symptom:** Booking fails for one component  \n**Resolution:** Re-run availability for all components; rebuild package from scratch if needed\n\n---\n\n## Financial/Accounting Edge Cases\n\n### 7. Wallet Refund on Partial Cancellation\n**Scenario:** Agency partially cancels multi-service booking; one service is non-refundable  \n**Behavior:** Refundable portions credited to Wallet; non-refundable portions not credited  \n**Edge:** System must correctly separate refundable vs. non-refundable amounts in same Wallet credit\n\n### 8. Credit Limit Breach\n**Scenario:** Branch agency attempts booking that would exceed assigned credit limit  \n**Behavior:** System blocks booking  \n**Resolution:** Head office (GSA) must increase branch credit limit, or branch must clear outstanding balance  \n**Impact:** Cannot override at branch level; GSA intervention required\n\n### 9. Exchange Rate Staleness (Multicurrency)\n**Scenario:** Exchange rates not updated; customer books using outdated rate  \n**Risk:** Revenue impact if rate has moved significantly  \n**Mitigation:** Set up regular exchange rate refresh schedule in Accounting/Multicurrency settings\n\n### 10. Voxel Invoice Import Conflict\n**Scenario:** Voxel imports a supplier invoice that doesn't match a JBE booking (different booking reference or amounts)  \n**Behavior:** Unmatched invoice flagged for manual review  \n**Resolution:** Manual reconciliation in Accounting back-office\n\n---\n\n## Module-Specific Edge Cases\n\n### 11. Room Mapping Deduplication Missing\n**Scenario:** Room Mapping enabled but a room type combination doesn't deduplicate correctly  \n**Cause:** New room type or board type not yet in mapping database  \n**Symptom:** Duplicate room options visible to customer  \n**Resolution:** Report to Juniper support for mapping database update; Vervotech Add-on raises accuracy to 99.9% but not 100%\n\n### 12. Parallel Search Predefined List Mismatch\n**Scenario:** Predefined hotel list is outdated; hotels no longer available in destination  \n**Symptom:** Empty results in predefined search portion; only second search (seller search) returns results  \n**Resolution:** Update predefined hotel list in Parallel Search configuration\n\n### 13. Promotional Code Already Used\n**Scenario:** Customer tries to enter a single-use Promotion code that was already used  \n**Behavior:** Code rejected; error message shown  \n**Resolution:** Customer must use a different code; cannot reuse single-use codes\n\n### 14. Campaign Code Unlimited Use Edge Case\n**Scenario:** Campaign configured without code entry requirement (conditions-based auto-apply) + unlimited use  \n**Risk:** If conditions are too broadly defined, discount applies to many unintended bookings  \n**Mitigation:** Test conditions carefully before activating; prefer limited-use codes for mass campaigns\n\n### 15. Affiliates Cookie Overwriting\n**Scenario:** Customer visits via Affiliate A, then revisits via Affiliate B later  \n**Behavior:** Most recent affiliate cookie overwrites earlier one; Affiliate B gets credit  \n**Design intent:** Last-click attribution model\n\n### 16. Branch Agent Margin Override\n**Scenario:** Agent saves a high margin in their profile; booking is made at that margin  \n**Risk:** Uncompetitive pricing if agent margin is too high  \n**Mitigation:** GSA can audit agent profiles and override saved margins\n\n---\n\n## Performance Edge Cases\n\n### 17. Business Cache Staleness Window\n**Scenario:** Seller updates rates/availability; cached data in Business Cache is served to buyers for [TTL duration]  \n**Risk:** Buyer sees stale price; if price has risen, booking may fail at seller confirmation  \n**Mitigation:** Configure appropriate cache TTL; real-time bookings should validate at BookingRules step\n\n### 18. Smart Booking Engine Mode Conflict\n**Scenario:** Defensive mode is active during high-demand period; some products are deprioritized  \n**Risk:** Legitimate demand for a specific product is missed  \n**Mitigation:** Monitor daily suggestions from Smart BE; manually review if important products are being suppressed\n\n### 19. Parallel Search Timeout\n**Scenario:** One of the two parallel searches (predefined list vs. seller) times out  \n**Behavior:** Results from the completed search are returned; timed-out results not included  \n**Impact:** Customer sees partial results; faster experience but potentially missing products\n\n---\n\n## Authentication/Access Edge Cases\n\n### 20. OCTO Token Not Refreshed\n**Scenario:** OCTO REST API token used after 3600 seconds  \n**Symptom:** `UNAUTHORIZED` (401) response  \n**Resolution:** Re-authenticate at `/webservice/octo/authentication` to get new token  \n**Edge:** If authentication service is unreachable, all OCTO operations fail; design retry logic with backoff\n\n### 21. IP Address Change Mid-Integration\n**Scenario:** Buyer changes server/cloud provider; new IP not registered in Juniper portal  \n**Symptom:** `IP_NOT_REGISTERED` error on all API calls  \n**Resolution:** Buyer must add new IP(s) via buyer portal (https://api-edocs.ejuniper.com/buyer/ipmanagement)  \n**Impact:** All API calls blocked until new IP is registered; critical for cloud autoscaling scenarios\n\n### 22. Azure AD SSO Timeout (eLearning Portal)\n**Scenario:** Long session on eLearning portal; Azure AD session expires  \n**Behavior:** Moodle session invalidated; user redirected to login page  \n**Resolution:** Re-authenticate via Microsoft Azure AD SSO\n\n---\n\n## API Permanently Unavailable Endpoints (Do Not Retry)\n\n| Endpoint | Status | Notes |\n|---|---|---|\n| `/api/jp/transportbooking` | 404 Permanent | Legacy transport booking — unavailable |\n| `/api/jp/transportticketing` | 404 Permanent | Legacy transport ticketing — unavailable |\n| `/api/jp/activities-api` | 404 Permanent | Use `/api/jp/ticket-api` instead |\n| `/api/jp-webservice/faq` | 404 Permanent | Use `/api/faq/*` path |\n| `/api/jp/hotel-inventory-api` | 403 Permanent | Internal use only |\n| `/juniper/octo` | 403 Permanent | Internal use only |\n\n--- SOURCE: elearning/MODULE_SUMMARIES.md ---\n# Juniper Booking Engine — Module Summaries\n\n**Source:** ejuniper.com public module pages (fetched 2026-02-23)  \n**Cross-reference:** `/juniper-knowledge/JUNIPER_API_KNOWLEDGE.md` for API-layer details\n\n---\n\n## HOSTED CONTRACT PRODUCTS\n\n### 1. Accommodation\n**Purpose:** Manage and sell directly-contracted hotel properties  \n**Users:** Tour Operators, Travel Agencies, DMCs, Bedbanks  \n**Key capabilities:**\n- Input directly-contracted property details into the Booking Engine\n- Manage cost/sale prices, hotel content, offers, releases, supplements\n- Distribute contracts through multiple sales channels\n- Reports: price lists, sales follow-up, occupancy forecasts, rooming lists\n**API cross-reference:** `HotelAvail` → `HotelBookingRules` → `HotelBooking` (jp/hotel-api)\n\n### 2. Flights\n**Sub-categories:**\n- **Charter flights:** Manage charter company contracts, inventory, ticketing; supports simple tasks to full season scheduling\n- **Scheduled flights (regular):** Negotiate fares and connections\n- **GDS flights via Lleego:** Integration with Amadeus, Sabre, Galileo, Worldspan + NDC distributions\n- **Low-cost carrier (LCC) flights:** Integration with low-cost airlines for flexible/economical options  \n**API cross-reference:** `FlightAvail` → `FlightBookingRules` → `FlightBooking` → `FlightTicketing` (jp/flight-api)\n\n### 3. Car Hire\n**Purpose:** Vehicle rental booking and management  \n**API cross-reference:** `CarAvail` → `CarBookingRules` → `CarBooking` (jp/car-api)\n\n### 4. Ground Services\n**Purpose:** Enter purchase contracts for destination services  \n**Included services:** Transfers, tours, excursions, tickets (amusement parks, shows), travel insurance, other destination services  \n**Integration:** Connect with service sellers  \n**Distribution:** Available through all sales channels  \n**API cross-reference:** `ServiceAvail`/`TransferAvail` → BookingRules → Booking (jp/ticket-api, jp/transfer-api)\n\n### 5. Vacation Packages\n**Two types:**\n\n**Predefined Packages:**\n- Fixed packages with: specific duration, departure dates, hotels, allotment, room types, closed prices\n- Optional supplements or taxes can be added\n- Fixed price per PAX (sales and/or total cost)\n- Sub-types: Master Package, Multiple Destination Package, City Packs, Optional Products\n\n**Dynamic Packages:**\n- Combine own products and external products flexibly\n- Create unique/customized offers per customer needs\n- Add-on: **Trip Step by Step** — guided step-by-step web navigation UX\n  - Multiple navigation flows adapt to customer preferences\n  - All details + final price shown from step 1\n  - Customers can change selections at any point  \n**API cross-reference:** `PackageSearcher` → `PackageBookingRules` → `PackageBooking` (jp/package-api)\n\n### 6. Cruises\n**Purpose:** Cruise product distribution  \n**Technology:** FIBOS content via Juniper Cruises by IST division  \n**Connectivity:** 30+ connected cruise line companies  \n**Flow:** Search → choose → personalize cruise vacations  \n**API cross-reference:** `CruiseAvail` → `CruiseBookingRules` → `CruiseBooking` (jp/cruise-api)\n\n---\n\n## ADMINISTRATIVE MODULES\n\n### 7. Accounting\n**Purpose:** Full invoicing, collection, and payment management  \n**Flow:**\n1. Customer makes booking\n2. Booking enters Accounting module\n3. Module manages sales invoicing: Customers (receipts) + Sellers (payments)\n\n**Add-ons:**\n- **Account Export Interface:** Export bookings/invoices/customers/sellers to ERPs\n- **Automatic Invoicing:** Auto-generate customer invoices\n- **Generic Import Payments:** Auto-record customer receipts via file import\n- **Financing:** Instalment payment management\n- **Voxel:** Auto import/export of invoices\n\n**Key benefits:**\n- Integrated accounting + booking system (single tool)\n- Bulk invoice issuance and review of outstanding invoices\n- Reconciles bookings/invoices with receipts/payments\n\n### 8. Multicurrency\n**Purpose:** Multi-currency exchange rate management  \n**Flow modes:**\n- **Forcing Seller Currency:** No exchange rate applied; results returned in seller's base currency; useful for Webservice channels; same hotel may appear in different currencies\n- **Forcing Customer Currency:** Exchange rate applied; customer selects preferred currency; system converts all seller prices\n\n### 9. Payment Methods\n**Purpose:** Configure payment gateway integrations  \n*(Contact-only module — details require Juniper engagement)*\n\n---\n\n## PRODUCT ENHANCEMENT MODULES\n\n### 10. Unique Hotel\n**Purpose:** Eliminate duplicate hotel results  \n**Technology:** AI-powered double verification via Juniper + Vervotech algorithms  \n**Accuracy:** Raises hotel mapping accuracy from 98% to 99.9%  \n**Mechanism:** Prevents display of incorrectly mapped hotel offers  \n\n### 11. Room Mapping\n**Purpose:** Deduplicate room types in B2B XML search results  \n**Problem solved:** Multiple sellers distributing same product → same rooms with different names/prices  \n**Solution:** Combines room type + conditions + board types per hotel without duplicates, prioritized by price  \n**Result:** Increased conversion ratio\n\n### 12. Parallel Search\n**Purpose:** Deliver hotel search results in <3 seconds  \n**How it works:**\n1. Edit a predefined list of hotels by destination\n2. System performs 2 parallel searches simultaneously:\n   - Search 1: Predefined hotel list\n   - Search 2: All destination-connected sellers  \n**Result:** Much faster results vs sequential search\n\n### 13. Comparison Tool\n**Purpose:** Side-by-side product comparison for customers  \n\n### 14. Ground Handling\n**Purpose:** Receptive agency management  \n**Key capabilities:** Manage/organize transfer and excursion reservations; assign to vehicles and guides efficiently\n\n### 15. Rating & Reviews\n**Purpose:** Customer review collection and display for products\n\n---\n\n## BUSINESS RULE MODULES\n\n### 16. Loyalty Program\n**Purpose:** Customer retention via points-based rewards  \n**How it works:**\n- Customers earn points when booking on your website\n- Can be used to reward most loyal clients with exclusive/personalized offers\n- Increases repeat visits and sales\n\n### 17. Branch Offices\n**Purpose:** Manage GSA agency network and billing hierarchy  \n**Key capabilities:**\n- Create billing hierarchies (head office → branches)\n- Allocate credit limits between head office and branches\n- Configure commissions per branch (fixed from GSA/front office, or per agent)\n- Manage agents, permissions, financial transactions via web interfaces\n- Agents define their own margin per search or saved in profile\n\n### 18. Promotional Codes\n**Three discount types:**\n\n**Early Bird:**\n- Fixed amount or percentage discount\n- Applied by: booking date, travel date, days in advance, amount, sales channel, product type, supplier, agency group\n- Can be cumulative with other early bird discounts\n- Configurable name, description, image, URL\n\n**Promotions (single-use code):**\n- Fixed, percentage, or \"gift\" amount\n- NOT cumulative\n- Auto-generates random single-use codes\n- Tracks which booking code used it and when\n\n**Campaigns (limited-use code):**\n- Fixed, percentage, or \"gift\" amount\n- NOT cumulative\n- Free-text alphanumeric code with limited use\n- Can also activate without code input (unlimited use) if conditions met\n\n### 19. Affiliates\n**Purpose:** Commission-based referral tracking via external websites  \n**How it works:**\n- Affiliates place banner/link on their website\n- Clicks redirect to your site\n- Visit + reservation tagged with affiliate code (via cookie)\n- Cookie tracks attribution up to 365 days\n- Reports: visits, conversions, commissions per affiliate\n\n### 20. Advanced Shopping Basket (Shopping Basket Evolution)\n**Purpose:** Transform shopping cart into strategic sales tool  \n**Available for:** B2B and B2C websites using Juniper Booking Engine Website  \n**Key features:**\n- **Structured visualization:** Itineraries organized by date and area\n- **Quotation management:** Create, modify, send personalized quotes (print/email)\n- **Direct conversion:** Quote → confirmed booking seamlessly\n- **Automated cross-selling:** Recommends complementary products automatically\n- **Visual experience:** Map or list view, chronological order\n\n**FAQ highlights:**\n- Q: How does cross-selling work? A: Suggests complementary products (e.g., flight + hotel → recommends transfers/excursions)\n- Q: Difference from traditional Shopping Basket? A: Add/modify/remove services within same quote; visualize full itinerary; book directly from quotation\n\n### 21. Wallet\n**Purpose:** B2B digital wallet for payment and refund management  \n**Add-on to:** Accounting module  \n**Key capabilities:**\n- Automatic refunds to wallet when agency cancels booking\n- Reusable balance for future bookings (customer retention)\n- Direct debit: agencies manually top up wallet\n- Configurable per agency, per currency\n\n**FAQ highlights:**\n- Q: Can Wallet combine with other payment methods? A: Yes — combine wallet balance with traditional payment methods\n- Q: Multi-currency support? A: Yes — each agency can have Wallet per currency\n- Q: Security benefit? A: Eliminates intermediaries; centralizes transactions; reduces fraud/delay risk\n\n---\n\n## ANALYTICS & INTELLIGENCE MODULES\n\n### 22. Business Intelligence (BI)\n**Purpose:** Transform raw data into actionable business insights  \n**Report blocks:**\n1. **Business reports** — sales performance, market analysis\n2. **Performance reports** — operational efficiency metrics  \n**Key value:** BI Technologies process large quantities of non-structured data; competitive market advantage\n\n### 23. Juniper KPI\n**Purpose:** Mobile KPI dashboard for real-time business monitoring  \n**Access:** Intranet user credentials; mobile app  \n**Key KPIs monitored:**\n- Revenues, profits, bookings, cancellations (real-time)\n- Bookings vs. Cancellations comparison\n- Top 5 Customers and Top 5 Suppliers (by revenue)\n**Filter capabilities:** Day, week, month, year; compare with previous period  \n**Coming soon:** Push notifications for trend anomalies per user configuration\n\n### 24. Business Cache\n**Purpose:** Cache seller availability to speed up responses and reduce load  \n**Key metrics:**\n- Cached queries processed in 0.05 seconds\n- Reduces direct requests to sellers significantly\n\n**Benefits for Buyers:**\n- Faster results for clients with short timeouts\n- Wider product range from slow-responding sellers\n- Fewer Too-Many-Requests and Timeout errors\n- Increased request capacity\n\n**Benefits for Sellers:**\n- Fewer direct requests hitting their servers\n- Lower resource load\n- Improved Look-to-Book ratio\n\n**Benefits for End-Users:**\n- Faster, more satisfying booking experience\n\n---\n\n## AI & AUTOMATION MODULES\n\n### 25. JuliA (AI Assistant)\n**Purpose:** Contextual AI chatbot embedded in the Juniper intranet  \n\n**Free Version — Juniper Help by JuliA:**\n- Contextual chatbot assistant within the intranet\n- Real-time answers about the Juniper ecosystem\n- Supports navigation without switching tabs\n\n**Coming Soon — Juniper Help by JuliA Business:**\n- Advanced version with deeper workflow integration\n- Additional AI-powered tools announced\n\n**Also available:** WhatsApp assistant integration (mentioned on product page)\n\n### 26. Smart Booking Engine\n**Purpose:** Automated business rule optimization for booking engine performance  \n**Requires:** Business Intelligence module (data input)  \n**Integration:** BI data → Smart BE detects patterns → applies automatic rules\n\n**Three Operation Modes:**\n| Mode | Focus | Behavior |\n|---|---|---|\n| **Attack Mode** | Growth | Enable dynamic traffic control + portfolio expansion; more product, greater competitiveness |\n| **Standard Mode** | Balance | Automatically manage portfolio + buyer/seller performance; balance volume and system capacity |\n| **Defensive Mode** | Stability | Prioritize stability during demand spikes; automatic traffic control rules |\n\n**Key automations:**\n- Automatic Optimization: adjusts business rules to balance load and product volume\n- Operational Efficiency: reduces manual configuration time\n- Data-Driven Decisions: BI analytical insights drive actions\n- Business Suggestions: daily recommendations based on buyer needs\n\n**FAQs:**\n- Q: Uses AI? A: Yes — intelligent automation with data analysis, not solely generative AI\n- Q: How to activate? A: Requires Business Intelligence module; then select operation mode\n\n---\n\n## DISTRIBUTION CHANNELS\n\n### 27. Website\n**Purpose:** B2C/B2B web storefront powered by Juniper Booking Engine  \n**Add-on:** Advanced Shopping Basket available for Website clients\n\n### 28. White Label\n**Purpose:** Brandable booking UI for partners/resellers\n\n### 29. Trip Planner\n**Purpose:** Customer-facing trip planning interface\n\n### 30. Web Services (API)\n**Purpose:** Third-party system integration via API  \n**API types:**\n- **Hotels API:** PUSH, PULL, or hybrid; >10M accommodation bookings/year\n- **Flights API:** >4M flight bookings/year; unified multi-supplier\n- **Tickets & Transfers API:** >11M activities & transfers/year; >2M services, 60K+ transfers\n- **Cars API:** >65K rent-a-car bookings/year\n- **Vacation Packages API:** >550K packages/year\n- **Cruises API:** >75K cruise bookings/year\n\n**Additional APIs:**\n- **Data Management API:** Automate back-office (contracts, bookings, clients, users, inventory)\n- **Export API:** Sync internal data to management tools/ERP\n- **Channels API:** Channel manager / push integration for hotel ARI (availability, rates, inventory)\n\n---\n\n## SERVICE MODULES\n\n### 31. E-Learning (Training Services)\n**Purpose:** Training on contracted modules  \n**Format:** Moodle-based portal at https://elearning.ejuniper.com  \n**Access:** Via training manager, project manager, or Juniper consultant\n\n### 32. Contact Mailing\n**Purpose:** Email marketing and campaign management  \n*(Contact-only module — details require Juniper engagement)*\n\n### 33. Traffic Capturer\n**Purpose:** Web traffic analysis and capture  \n*(Contact-only module)*\n\n---\n\n## SPECIALIZED DIVISIONS (separate products)\n\n| Division | Product | Key Technology |\n|---|---|---|\n| Juniper Airline Vacations | Airline vacation packages | Dedicated airline product tech |\n| Juniper Cruises by IST | Online cruise sales | FIBOS technology, 30+ cruise lines |\n| Juniper Experiences by NexusTours | DMC experiences & mobility | Experiences Go mobile POS |\n| Juniper Flights by Lleego | Airline ticket management | GDS, NDC, LCC in single API + UI |\n| Juniper Vervotech | Hotel room data & mapping | AI-powered, room data management |\n\n--- SOURCE: elearning/GLOSSARY.md ---\n# Juniper eLearning Glossary\n\n**Normalized with:** `/juniper-knowledge/JUNIPER_API_KNOWLEDGE.md` and API docs  \n**Convention:** API-layer terms in `monospace`, business terms in **bold**\n\n---\n\n## Core Platform Terms\n\n| Term | Definition | API Alias |\n|---|---|---|\n| **Juniper Booking Engine (JBE)** | Juniper's central travel product distribution platform; modular SaaS for Tour Operators, TAs, DMCs, Bedbanks | — |\n| **Intranet** | Back-office management interface of the Juniper Booking Engine | — |\n| **Front Office** | Customer-facing booking interface (B2C/B2B website, White Label) | — |\n| **Buyer** | Client consuming Juniper products via API or front-end | `Login/AgencyCode` in SOAP headers |\n| **Seller** | Supplier providing inventory to the Booking Engine | `Provider` in API responses |\n| **Hosted Contract** | Directly-contracted supplier content loaded into JBE | vs. XML Seller (live API feed) |\n| **XML Seller** | Supplier connected via Host-to-Host XML API | External/PULL connectivity |\n| **Distribution Channel** | Sales outlet: Website, White Label, Webservice (API), Call Center | `SalesChannel` in pricing rules |\n| **Sales Channel** | Synonym for Distribution Channel; used in pricing and discount configuration | — |\n\n## Product Terms\n\n| Term | Definition | API Operation |\n|---|---|---|\n| **Accommodation** | Directly contracted hotel/property in JBE | `HotelAvail`, `HotelBooking` |\n| **Service** | Destination service: excursion, ticket, tour, insurance, other | `ServiceAvail`, `ServiceBooking` |\n| **Transfer** | Point-to-point transport service | `TransferAvail`, `TransferBooking` |\n| **Ground Services** | Collective term for Services + Transfers | jp/ticket-api + jp/transfer-api |\n| **Ground Handling** | Receptive agency management of transfers/excursions (vehicle/guide assignment) | — |\n| **Charter Flight** | Flight contracted directly with charter company; fixed inventory | `FlightAvail` (charter type) |\n| **Scheduled Flight** | Regular airline flights via GDS or NDC | `FlightAvail` (scheduled type) |\n| **LCC** | Low-Cost Carrier flights | `FlightAvail` (LCC type) |\n| **GDS** | Global Distribution System (Amadeus, Sabre, Galileo, Worldspan) | Via Lleego integration |\n| **NDC** | New Distribution Capability — IATA airline content standard | Via Lleego integration |\n| **Predefined Package** | Pre-built holiday package with fixed prices, duration, and departure dates | `PackageSearcher` |\n| **Dynamic Package** | Customer-assembled package combining multiple products flexibly | `PackageSearcher` |\n| **FIBOS** | IST cruise technology platform; content for 30+ cruise lines | `CruiseAvail`, `CruiseBooking` |\n| **Allotment** | Pre-allocated block of rooms/seats/spaces with contracted availability | Used in Accommodation, Flights |\n| **Release** | Deadline by which unsold allotment is released back to supplier | Affects `HotelAvail` availability |\n| **Supplement** | Additional charge added to base product price (e.g., single supplement) | `Supplement` nodes in pricing |\n| **Direct Payment** | Supplement paid directly to supplier, NOT included in total API price | `@DirectPayment=true` flag |\n| **Board Type** | Meal plan: RO, BB, HB, FB, AI etc. | Board attribute in hotel results |\n\n## Booking Lifecycle Terms\n\n| Term | Definition | API Operation |\n|---|---|---|\n| **Availability** | Real-time or cached product options matching search criteria | `*Avail` operations |\n| **Option Code** | Temporary code identifying a specific availability result; time-limited | Used in BookingRules |\n| **Booking Rules** | Pricing, cancellation policy, and conditions for a specific option | `*BookingRules` (mandatory step) |\n| **Booking Code** | Code returned by BookingRules confirming option validity for booking | Must be used immediately |\n| **Locator** | Unique booking reference returned after successful booking | `Locator` in SOAP response |\n| **Pre-Confirmation** | Status where booking is created but not yet confirmed by supplier | `PRE` status |\n| **Confirmed Booking** | Booking confirmed by supplier; full locator available | `CON` status |\n| **Cancelled Booking** | Booking cancelled; cancellation charges may apply | `CNX` / `CAX` status |\n| **Cancellation Policy** | Rules governing refund/penalty for cancellation | From `*BookingRules` |\n| **Ticketing** | Final step for flights: issuing the actual airline ticket | `FlightTicketing` operation |\n| **Modify** | Change booking details post-confirmation | `*Modify` + `*ConfirmModify` |\n| **Read Booking** | Retrieve full booking details | `ReadBooking` |\n| **HCN** | Hotel Confirmation Number — supplier-side confirmation number | — |\n\n## Pricing Terms\n\n| Term | Definition |\n|---|---|\n| **Cost Price** | Price paid to supplier (net/purchase price) |\n| **Sale Price** | Price charged to end customer |\n| **Commission** | Margin between cost and sale price; or affiliate/agent fee |\n| **Early Bird** | Time-sensitive discount for advance bookings |\n| **Promotion** | Single-use discount code for personalized campaigns |\n| **Campaign** | Limited-use discount code for mass campaigns |\n| **Wallet** | B2B digital payment balance; auto-refunded on cancellation |\n| **Credit Limit** | Maximum credit allocated to a branch/agency |\n| **Exchange Rate** | Currency conversion rate applied in Multicurrency module |\n\n## Technical/API Terms\n\n| Term | Definition | Notes |\n|---|---|---|\n| `Version` | SOAP request version attribute | Required in all JP requests |\n| `Language` | SOAP request language attribute | ISO language code |\n| `Login` / `AgencyCode` | API authentication fields | In SOAP envelope |\n| `COMPRESSION_REQUIRED` | Server error: client must compress availability response | Implement GZIP/deflate |\n| `JP_BOOK_EXPIRATION_DATE` | Warning: booking option has expired; must re-run availability | Re-run `*Avail` + `*BookingRules` |\n| `INVALID_USER_OR_PASSWORD` | Hard-stop auth failure | Check credentials and IP |\n| `IP_NOT_REGISTERED` | Hard-stop: IP not in IP allowlist | Add IP via buyer portal |\n| `PUSH` | Supplier sends ARI updates proactively to JBE | Via Channels API / JPDM Extranet API |\n| `PULL` | JBE requests availability from supplier in real-time | Via standard Avail operations |\n| `JPDM` | Juniper Partner Data Management — extranet API for channel managers | `jpdm/dm-api`, `jpdm/extranet-api` |\n| `OCTO` | Open Connectivity for Tours and Activities — REST API standard | `api/octo/ticket-api` |\n| `ARI` | Availability, Rates, and Inventory — key sync data for channel managers | Via Channels API |\n\n## Business Intelligence Terms\n\n| Term | Definition |\n|---|---|\n| **BI** | Business Intelligence — structured analytics from raw data |\n| **KPI** | Key Performance Indicator — metric for business health |\n| **Look-to-Book Ratio** | Ratio of availability searches to confirmed bookings; efficiency metric |\n| **Conversion Rate** | Percentage of searches/quotes that result in bookings |\n\n## Platform/Operations Terms\n\n| Term | Definition |\n|---|---|\n| **GSA** | General Sales Agent — parent agency managing sub-branches |\n| **Branch** | Sub-agency within a GSA hierarchy |\n| **Agent** | Individual user under an agency or branch |\n| **Affiliate** | External website that refers traffic in exchange for commissions |\n| **Cookie Attribution** | Affiliate tracking mechanism; valid up to 365 days |\n| **DMC** | Destination Management Company |\n| **Bedbank** | Wholesale accommodation aggregator/distributor |\n| **Tour Operator** | Company packaging travel products for distribution |\n| **Travel Agency (TA)** | Retail travel seller |\n| **B2B** | Business-to-Business — selling to agencies/partners |\n| **B2C** | Business-to-Consumer — selling directly to end customers |\n| **White Label** | Branded Booking Engine UI for partners/resellers |\n| **Moodle** | Open-source LMS platform used by Juniper eLearning |\n| **JuliA** | Juniper's AI assistant — contextual chatbot in intranet |\n| **FIBOS** | IST's cruise distribution technology (content + booking) |\n| **Vervotech** | AI hotel room data management partner (room mapping) |\n| **Lleego** | Juniper's flight technology division (GDS, NDC, LCC unified) |\n\n--- SOURCE: elearning/SCREENSHOT_REFERENCE.md ---\n# Juniper eLearning Screenshot Reference\n\nThis document catalogs 28 key screenshots extracted from the Juniper Booking Engine eLearning course (JBE-C-PER-Imperatore Travel World). When answering questions, reference these screenshots to indicate that visual documentation exists for specific features.\n\n## Master Tables (Lesson 40098)\n\n### User Interface Overview\n- **Screenshot**: USUARIO.png — Shows the main user interface / login screen of the Juniper Booking Engine intranet.\n\n### Geographic Configuration\n- **Screenshot**: Search_polygon_Barcelona.png — Demonstrates the polygon-based geographic search feature for Barcelona, showing how to define custom geographic zones on a map.\n- **Screenshot**: Barcelona_2_screens.png — Shows the save/modification workflow for polygon geographic configurations with dual-screen view.\n- **Screenshot**: own_areas.png — Displays the \"Own Areas\" configuration panel where agencies define their custom geographic zones and area groupings.\n\n### Summary View\n- **Screenshot**: Summary.png — Shows the Master Tables summary screen with an overview of configured data entities.\n\n## Business Structure (Lesson 40107)\n\n### Organization Setup\n- **Screenshot**: business_structure_1.png — Shows the initial business structure configuration screen with organization hierarchy.\n- **Screenshot**: business_structure_2.png — Displays the detailed business structure settings and entity relationships.\n\n### Payment & Invoicing\n- **Screenshot**: pre-payment.png — Shows the pre-payment configuration panel with deposit rules, payment schedules, and cancellation fee settings.\n- **Screenshot**: payment_type.png — Displays the payment type configuration options (credit card, bank transfer, cash, virtual credit card, etc.).\n- **Screenshot**: calculate_from_start.png — Shows payment calculation configured from the booking start date (deposit timeline calculation).\n- **Screenshot**: calculate_from_end.png — Shows payment calculation configured from the booking end date (reverse timeline).\n- **Screenshot**: Booking_breakdown.png — Displays a booking breakdown view showing cost components, markup, taxes, and final price.\n- **Screenshot**: create_invoice.png — Shows the invoice creation screen with line items, taxes, and total.\n- **Screenshot**: proceed_invoice.png — Shows the invoice processing/finalization workflow with confirmation steps.\n\n### Booking Details\n- **Screenshot**: remarks.png — Displays the booking remarks section where agents add internal notes, special requests, and supplier communications.\n\n### Pricing & Commissions\n- **Screenshot**: final_price_structure.png — Shows the final price structure breakdown including base price, commission, markup, and net price.\n- **Screenshot**: Second_commission.png — Displays the second commission configuration panel for multi-tier commission structures (agency → sub-agency).\n- **Screenshot**: Handling_fee.png — Shows the handling fee per booking configuration screen.\n- **Screenshot**: commissions.png — Displays the main commissions configuration panel with percentage/fixed commission rules per product type.\n\n## General Data & Pre-Configuration (Lesson 40114)\n\n### Reference Data\n- **Screenshot**: abbreviation.png — Shows the abbreviation/code configuration screen for standardized short codes used across the system.\n- **Screenshot**: services.png — Displays the services catalog registered in the Intranet, showing available service types and their configurations.\n\n## Unique Hotel (Lesson 40125)\n\n### Hotel Schema\n- **Screenshot**: esquema.png — Shows the Unique Hotel data schema/entity relationship diagram explaining how hotel data is structured in Juniper (rooms, rates, boards, contracts, allotments).\n\n## Dynamic Packages (Lesson 40146)\n\n### Package Configuration\n- **Screenshot**: dynamic_packages.png — Shows the dynamic packages product configuration screen where operators define flight+hotel or multi-service package rules.\n\n## Predefined Packages Extranet (Lesson 40156)\n\n### Package Management\n- **Screenshot**: Extranet_paquetes.png — Shows the complete predefined packages extranet overview with all package listings, status indicators, and management actions.\n- **Screenshot**: main_screen.png — Displays the packages extranet main screen with search filters, date ranges, and destination selectors.\n\n## Booking Management (Lesson 40164)\n\n### Booking Workflow\n- **Screenshot**: booking_status_diagram.png — Shows the complete booking status flow diagram illustrating all possible booking states (Confirmed, On Request, Cancelled, etc.) and transitions between them. Key reference for understanding the booking lifecycle.\n\n## Accounting (Lesson 40172)\n\n### Administration\n- **Screenshot**: Administracion.png — Shows the accounting administration main screen with financial management options, balance views, payment tracking, and reconciliation tools. This is the largest/most detailed screenshot.\n\n## User & Configuration (Lesson 40182)\n\n### User Management\n- **Screenshot**: email_settings.png — Shows the user email notification settings and account manager copy activation configuration, including which system events trigger email notifications.";
